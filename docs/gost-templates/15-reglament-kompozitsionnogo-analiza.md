# Регламент композиционного анализа

| | |
|---|---|
| **Продукт** | [ЗАПОЛНИТЬ: наименование СЗИ] |
| **Версия документа** | 1.0 |
| **Дата** | [ЗАПОЛНИТЬ: дата утверждения] |
| **Статус** | Проект |
| **Утверждено** | [ЗАПОЛНИТЬ: должность, ФИО руководителя] |
| **Процесс ГОСТ Р 56939-2024** | 5.16 — Использование инструментов композиционного анализа |

---

## Содержание

1. [Общие сведения](#1-общие-сведения)
2. [Область применения](#2-область-применения)
3. [Инструменты композиционного анализа](#3-инструменты-композиционного-анализа)
4. [Формирование SBOM](#4-формирование-sbom)
5. [Порядок проведения композиционного анализа](#5-порядок-проведения-композиционного-анализа)
6. [Управление уязвимостями в зависимостях](#6-управление-уязвимостями-в-зависимостях)
7. [Лицензионный анализ](#7-лицензионный-анализ)
8. [Интеграция в CI/CD](#8-интеграция-в-cicd)
9. [Политика обновления зависимостей](#9-политика-обновления-зависимостей)
10. [Метрики и отчётность](#10-метрики-и-отчётность)
11. [Реестр результатов анализа](#11-реестр-результатов-анализа)
12. [История изменений](#12-история-изменений)

---

## 1. Общие сведения

### 1.1. Назначение документа

Настоящий Регламент определяет порядок:

- Выбора и использования инструментов композиционного анализа (Software Composition Analysis, SCA) для продукта [ЗАПОЛНИТЬ: наименование СЗИ].
- Формирования и поддержания перечня зависимостей ПО (Software Bill of Materials, SBOM).
- Проведения регулярного анализа зависимостей на предмет известных уязвимостей.
- Управления уязвимостями, обнаруженными в сторонних компонентах и зависимостях.
- Лицензионного анализа используемых компонентов.
- Интеграции композиционного анализа в CI/CD pipeline.
- Определения политики обновления зависимостей.

Регламент разработан в соответствии с требованиями ГОСТ Р 56939-2024, п. 5.16 (использование инструментов композиционного анализа) и п. 5.16.2, которые устанавливают необходимость:

- Формировать и поддерживать перечень зависимостей ПО (SBOM).
- Контролировать и актуализировать перечень зависимостей на предмет известных уязвимостей.
- Разработать регламент композиционного анализа.
- Использовать инструменты SCA.

### 1.2. Нормативные ссылки

| Документ | Описание |
|----------|----------|
| ГОСТ Р 56939-2024, п. 5.16 | Использование инструментов композиционного анализа — основной процесс |
| ГОСТ Р 56939-2024, п. 5.16.2 | Требования к реализации процесса композиционного анализа |
| ГОСТ Р 56939-2024, п. 5.17 | Проверка цепочки поставок компонентов ПО |
| ГОСТ Р 56939-2024, п. 5.5 | Управление недостатками и запросами на изменение ПО |
| ГОСТ Р 56939-2024, п. 5.12 | Использование безопасной системы сборки ПО |
| ГОСТ Р 56939-2024, п. 5.10 | Статический анализ исходного кода |
| ГОСТ Р 56939-2024, п. 5.11 | Динамический анализ программного обеспечения |
| CVE (Common Vulnerabilities and Exposures) | Идентификация известных уязвимостей |
| CVSS v3.1/v4.0 | Система оценки критичности уязвимостей |
| CWE (Common Weakness Enumeration) | Классификация программных недостатков |
| NVD (National Vulnerability Database) | База данных уязвимостей NIST |
| OSV (Open Source Vulnerabilities) | Распределённая база уязвимостей open source |
| CycloneDX | Стандарт OWASP для формирования SBOM |
| SPDX (Software Package Data Exchange) | Стандарт Linux Foundation для формирования SBOM |
| NTIA SBOM Minimum Elements | Минимальные элементы SBOM (рекомендации NTIA) |

### 1.3. Связь с другими документами комплекта РБПО

| Документ РБПО | Связь |
|----------------|-------|
| 04 — Регламент управления недостатками | Уязвимости в зависимостях, обнаруженные при SCA, регистрируются как недостатки и обрабатываются в соответствии с Регламентом управления недостатками (процесс 5.5) |
| 09 — Регламент статического анализа | SCA дополняет SAST: статический анализ выявляет дефекты в собственном коде, композиционный анализ — уязвимости в сторонних зависимостях; оба инструмента работают в CI/CD pipeline (процесс 5.10) |
| 10 — Регламент динамического анализа | SCA + DAST обеспечивают полное покрытие: SCA анализирует зависимости и их известные уязвимости, DAST — поведение приложения в runtime, включая уязвимости, привнесённые зависимостями (процесс 5.11) |
| 11 — Регламент безопасной сборки | SBOM генерируется на этапе сборки как артефакт сборочного процесса; lock-файлы зависимостей являются частью конфигурации сборки и фиксируются в VCS (процесс 5.12) |
| 16 — Регламент проверки цепочки поставок | SCA обнаруживает уязвимые зависимости; проверка цепочки поставок дополнительно верифицирует целостность и подлинность компонентов, выявляя вредоносные пакеты, typosquatting и supply chain атаки (процесс 5.17) |

---

## 2. Область применения

### 2.1. Объекты анализа

> Требование ГОСТ Р 56939-2024, п. 5.16.2 — формировать и поддерживать перечень зависимостей ПО.

Композиционный анализ проводится для следующих категорий зависимостей продукта [ЗАПОЛНИТЬ: наименование СЗИ]:

| Категория | Описание | Примеры |
|-----------|----------|---------|
| **Прямые зависимости** | Компоненты, явно указанные в манифестах проекта | Библиотеки из package.json, requirements.txt, go.mod, Cargo.toml |
| **Транзитивные зависимости** | Зависимости зависимостей, не указанные явно в манифестах | Библиотеки, подтягиваемые автоматически через менеджер пакетов |
| **Системные зависимости** | Пакеты ОС, установленные в контейнерных образах и сборочной среде | apt/apk-пакеты в Docker-образах |
| **Контейнерные образы** | Базовые и промежуточные образы, используемые при сборке и в runtime | `FROM node:20-alpine`, `FROM python:3.12-slim` |
| **IaC-модули** | Модули инфраструктуры как кода, используемые для развёртывания | Terraform modules, Ansible roles, Helm charts |
| **Вендорированные компоненты** | Сторонний код, включённый в репозиторий (vendor directory) | Скопированные библиотеки, подмодули Git |

### 2.2. Языки программирования и экосистемы

| Язык / Экосистема | Менеджер пакетов | Манифест | Lock-файл | Реестр пакетов |
|-------------------|-----------------|----------|-----------|----------------|
| [ЗАПОЛНИТЬ: JavaScript / TypeScript] | npm / yarn / pnpm | package.json | package-lock.json / yarn.lock / pnpm-lock.yaml | npmjs.com |
| [ЗАПОЛНИТЬ: Python] | pip / uv / poetry | requirements.txt / pyproject.toml | requirements.txt (pinned) / uv.lock / poetry.lock | pypi.org |
| [ЗАПОЛНИТЬ: Go] | go modules | go.mod | go.sum | proxy.golang.org |
| [ЗАПОЛНИТЬ: Java / Kotlin] | Maven / Gradle | pom.xml / build.gradle | [ЗАПОЛНИТЬ: maven dependency tree / gradle.lockfile] | Maven Central |
| [ЗАПОЛНИТЬ: C/C++] | [ЗАПОЛНИТЬ: Conan / vcpkg / system] | [ЗАПОЛНИТЬ: conanfile.txt / vcpkg.json] | [ЗАПОЛНИТЬ: conan.lock] | [ЗАПОЛНИТЬ] |
| [ЗАПОЛНИТЬ: дополнительные] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

### 2.3. Исключения

| Категория | Обоснование | Условие исключения |
|-----------|-------------|-------------------|
| Компоненты собственной разработки | Анализируются средствами SAST (п. 5.10) и DAST (п. 5.11) | Если не опубликованы как отдельный пакет |
| Тестовые зависимости (devDependencies) | Не включаются в production-артефакт | Анализируются, но с пониженным приоритетом |
| Зависимости, используемые только при сборке | Не включаются в runtime-артефакт | Включаются в SBOM сборочной среды, но не в SBOM продукта |

---

## 3. Инструменты композиционного анализа

### 3.1. Реестр SCA-инструментов

> Требование ГОСТ Р 56939-2024, п. 5.16.2 — использовать инструменты SCA (OWASP Dependency-Check, Snyk, Trivy, Dependency-Track).

| Инструмент | Версия | Назначение | Поддерживаемые экосистемы | Лицензия | Статус |
|------------|--------|------------|--------------------------|----------|--------|
| [ЗАПОЛНИТЬ: OWASP Dependency-Track] | [ЗАПОЛНИТЬ: ≥ 4.x] | Централизованное управление SBOM и уязвимостями; непрерывный мониторинг | Все (через импорт SBOM) | Apache 2.0 | [ЗАПОЛНИТЬ: Основной / Планируется] |
| [ЗАПОЛНИТЬ: Trivy] | [ЗАПОЛНИТЬ: ≥ 0.50] | Сканирование зависимостей, контейнерных образов, IaC | npm, pip, Go, Maven, Gradle, Cargo, Alpine, Debian, RHEL | Apache 2.0 | [ЗАПОЛНИТЬ: Основной / Дополнительный] |
| [ЗАПОЛНИТЬ: OWASP Dependency-Check] | [ЗАПОЛНИТЬ: ≥ 9.x] | Обнаружение известных уязвимостей (CVE) в зависимостях | Java, .NET, npm, Python, Ruby, Go | Apache 2.0 | [ЗАПОЛНИТЬ: Основной / Дополнительный] |
| [ЗАПОЛНИТЬ: Snyk] | [ЗАПОЛНИТЬ] | SCA + лицензионный анализ + рекомендации по исправлению | npm, pip, Go, Maven, Gradle, .NET, Ruby, и др. | [ЗАПОЛНИТЬ: коммерческая / Free tier] | [ЗАПОЛНИТЬ] |
| [ЗАПОЛНИТЬ: Grype] | [ЗАПОЛНИТЬ: ≥ 0.70] | Быстрое сканирование SBOM и образов на уязвимости | Через SBOM (CycloneDX / SPDX) | Apache 2.0 | [ЗАПОЛНИТЬ] |
| [ЗАПОЛНИТЬ: npm audit / pip-audit] | Встроенный | Встроенный аудит зависимостей экосистемы | npm / Python | MIT / Apache 2.0 | [ЗАПОЛНИТЬ: Дополнительный] |

### 3.2. Критерии выбора инструмента

| Критерий | Описание | Вес |
|----------|----------|-----|
| Покрытие экосистем | Поддержка всех языков и менеджеров пакетов, используемых в проекте | Высокий |
| Качество базы уязвимостей | Источники данных: NVD, OSV, GitHub Advisory, вендорские advisory; полнота и скорость обновления | Высокий |
| Генерация SBOM | Возможность формирования SBOM в формате CycloneDX / SPDX | Высокий |
| Интеграция с CI/CD | Наличие CLI, плагинов, API для автоматизации в CI/CD pipeline | Высокий |
| Транзитивные зависимости | Анализ полного дерева зависимостей, включая транзитивные | Высокий |
| Лицензионный анализ | Определение и контроль лицензий используемых компонентов | Средний |
| Рекомендации по исправлению | Предоставление рекомендаций: обновление версии, альтернативная библиотека, workaround | Средний |
| Уровень ложноположительных | Процент ложных срабатываний при стандартной конфигурации | Средний |
| Centralized dashboard | Возможность централизованного мониторинга (Dependency-Track и аналоги) | Средний |
| Сканирование контейнеров | Анализ уязвимостей в системных пакетах контейнерных образов | Средний |
| Стоимость | Стоимость лицензии относительно функциональности | Низкий |

### 3.3. Совместное использование инструментов

Стратегия совместного использования:

1. **Централизованная платформа** — [ЗАПОЛНИТЬ: OWASP Dependency-Track] агрегирует SBOM и результаты анализа из всех источников, обеспечивает непрерывный мониторинг.
2. **Сканер в CI/CD** — [ЗАПОЛНИТЬ: Trivy / Grype] выполняет быстрое сканирование при каждом PR/merge.
3. **Экосистемные инструменты** — [ЗАПОЛНИТЬ: npm audit / pip-audit] дополняют основной сканер специфичной информацией экосистемы.
4. **Устранение дублирования** — при обнаружении одной и той же уязвимости несколькими инструментами регистрируется один тикет со ссылками на все источники.

---

## 4. Формирование SBOM

### 4.1. Формат SBOM

> Требование ГОСТ Р 56939-2024, п. 5.16.2 — формировать и поддерживать перечень зависимостей ПО.

| Параметр | Значение |
|----------|----------|
| Основной формат | [ЗАПОЛНИТЬ: CycloneDX JSON (рекомендуемый) / SPDX JSON] |
| Версия спецификации | [ЗАПОЛНИТЬ: CycloneDX 1.5+ / SPDX 2.3+] |
| Инструмент генерации | [ЗАПОЛНИТЬ: syft / trivy / cdxgen / cyclonedx-cli] |
| Именование файла | `sbom-<component>-<version>.cdx.json` или `sbom-<component>-<version>.spdx.json` |

### 4.2. Содержание SBOM

SBOM должен содержать минимальные элементы в соответствии с рекомендациями NTIA:

| Поле | Описание | Обязательность |
|------|----------|----------------|
| Supplier Name | Наименование поставщика компонента | Обязательно |
| Component Name | Наименование компонента (пакета, библиотеки) | Обязательно |
| Version | Версия компонента | Обязательно |
| Unique Identifier | Уникальный идентификатор (PURL — Package URL) | Обязательно |
| Dependency Relationship | Связь «зависит от» между компонентами | Обязательно |
| Author of SBOM Data | Автор / инструмент, создавший SBOM | Обязательно |
| Timestamp | Дата и время создания SBOM | Обязательно |
| Hash / Checksum | Хеш-сумма компонента (SHA-256) | Рекомендуется |
| License | Лицензия компонента (SPDX License ID) | Рекомендуется |
| External Reference | Ссылка на VCS-репозиторий компонента | Рекомендуется |
| CPE / PURL | Идентификатор для сопоставления с базами уязвимостей | Рекомендуется |

### 4.3. Генерация SBOM

| Событие | Тип SBOM | Инструмент | Хранение |
|---------|----------|------------|----------|
| Сборка release-артефакта | SBOM продукта (production-зависимости) | [ЗАПОЛНИТЬ: syft / trivy / cdxgen] | Рядом с артефактом в registry + Dependency-Track |
| Сборка контейнерного образа | SBOM образа (системные + application зависимости) | [ЗАПОЛНИТЬ: syft / trivy] | Container registry (attestation) + Dependency-Track |
| Ежедневный мониторинг | Обновлённый SBOM из текущей ветки development | [ЗАПОЛНИТЬ: CI/CD scheduled pipeline] | Dependency-Track |
| Подготовка к релизу | Финальный верифицированный SBOM | [ЗАПОЛНИТЬ: ручная генерация + проверка] | Архив релиза + Dependency-Track |

### 4.4. Хранение и актуализация SBOM

> Требование ГОСТ Р 56939-2024, п. 5.16.2 — контролировать и актуализировать перечень зависимостей.

| Параметр | Значение |
|----------|----------|
| Централизованное хранилище SBOM | [ЗАПОЛНИТЬ: OWASP Dependency-Track / внутренний артефактный сервер] |
| Срок хранения | [ЗАПОЛНИТЬ: не менее 5 лет / срок действия сертификата + 1 год] |
| Актуализация | При каждом изменении зависимостей (CI/CD); не реже [ЗАПОЛНИТЬ: 1 раза в неделю] для мониторинга новых уязвимостей |
| Формат экспорта | CycloneDX JSON, SPDX JSON, CSV (для отчётности) |
| Подписание SBOM | [ЗАПОЛНИТЬ: cosign / GPG — тем же ключом, что и основной артефакт] |
| Доступ | [ЗАПОЛНИТЬ: команда разработки, инженеры по безопасности, аудиторы] |

---

## 5. Порядок проведения композиционного анализа

### 5.1. Этапы анализа

> Требование ГОСТ Р 56939-2024, п. 5.16.2 — контролировать и актуализировать перечень зависимостей на предмет известных уязвимостей.

```
1. Сканирование зависимостей
   │  ├── Генерация / обновление SBOM
   │  ├── Сканирование на известные уязвимости (CVE)
   │  ├── Лицензионный анализ
   │  └── Проверка на deprecated / unmaintained компоненты
   │
2. Триаж результатов
   │  ├── Автоматическая классификация по severity (CVSS)
   │  ├── Оценка применимости (exploitability, reachability)
   │  ├── Проверка наличия fix-версии
   │  └── Определение приоритета устранения
   │
3. Устранение
   │  ├── Обновление зависимости до безопасной версии
   │  ├── Применение workaround (при отсутствии fix-версии)
   │  ├── Замена компонента на альтернативный
   │  └── Принятие риска (waiver) с документированием
   │
4. Верификация
   │  ├── Повторное сканирование после устранения
   │  ├── Регрессионное тестирование
   │  └── Обновление SBOM
   │
5. Мониторинг
      ├── Непрерывный мониторинг SBOM в Dependency-Track
      ├── Уведомления при обнаружении новых CVE
      └── Периодический полный ресканирование
```

### 5.2. Триггеры запуска анализа

| Событие | Вид анализа | Инструменты | Quality Gate |
|---------|-------------|-------------|--------------|
| Создание / обновление PR | Инкрементальный (новые / изменённые зависимости) | [ЗАПОЛНИТЬ: Trivy / Grype] | QG для PR (раздел 8) |
| Merge в `development` | Полный анализ всех зависимостей | [ЗАПОЛНИТЬ: Trivy / Grype + Dependency-Track] | QG для PR |
| Merge в `main` | Полный анализ + обновление SBOM в Dependency-Track | Все инструменты | QG для релиза |
| Ежедневный мониторинг (scheduled) | Мониторинг SBOM на новые CVE (без пересборки) | [ЗАПОЛНИТЬ: Dependency-Track] | Уведомление |
| Добавление новой зависимости | Полный анализ новой зависимости и её транзитивных | [ЗАПОЛНИТЬ: Trivy / Snyk] | QG для PR |
| Подготовка релиза | Полный аудит всех зависимостей | Все инструменты | QG для релиза |
| Инцидент безопасности (zero-day в зависимости) | Экстренное сканирование | [ЗАПОЛНИТЬ: Trivy / Grype] | Немедленное уведомление |

### 5.3. Классификация результатов

| Тип результата | Описание | Источник |
|----------------|----------|----------|
| **Уязвимость (CVE)** | Известная уязвимость в зависимости, зарегистрированная в NVD / OSV / Advisory | SCA-сканер |
| **Устаревший компонент (Outdated)** | Компонент значительно отстаёт от последней стабильной версии | SCA-сканер, Dependency-Track |
| **End-of-Life компонент** | Компонент более не поддерживается (нет security updates) | SCA-сканер, ручной анализ |
| **Лицензионное нарушение** | Лицензия компонента несовместима с лицензией продукта | Лицензионный анализ |
| **Вредоносный пакет** | Пакет идентифицирован как вредоносный (malware, typosquatting) | SCA-сканер, проверка цепочки поставок (документ 16) |

### 5.4. Триаж уязвимостей

Процедура триажа обнаруженных уязвимостей:

| Шаг | Действие | Ответственный |
|-----|----------|---------------|
| 1 | Получение уведомления о новой уязвимости (автоматическое из Dependency-Track / CI/CD) | Автоматически |
| 2 | Оценка CVSS severity (Critical / High / Medium / Low) | [ЗАПОЛНИТЬ: инженер по безопасности / DevSecOps] |
| 3 | Оценка применимости: используется ли уязвимый функционал в проекте? | [ЗАПОЛНИТЬ: разработчик + инженер по безопасности] |
| 4 | Проверка наличия fix-версии или workaround | [ЗАПОЛНИТЬ: разработчик] |
| 5 | Назначение приоритета и исполнителя (регистрация тикета по документу 04) | [ЗАПОЛНИТЬ: тимлид / инженер по безопасности] |
| 6 | Контроль устранения в соответствии с SLA (раздел 6) | [ЗАПОЛНИТЬ: тимлид] |

---

## 6. Управление уязвимостями в зависимостях

### 6.1. SLA по устранению уязвимостей

> Требование ГОСТ Р 56939-2024, п. 5.16.2 — контролировать и актуализировать перечень зависимостей на предмет известных уязвимостей.

Сроки устранения определяются на основе CVSS-оценки уязвимости и применимости к продукту:

| Severity (CVSS) | Балл CVSS | Срок устранения (применимо) | Срок устранения (не применимо / нет exploit) | Действие |
|------------------|-----------|---------------------------|----------------------------------------------|----------|
| **Critical** | 9.0–10.0 | [ЗАПОЛНИТЬ: ≤ 48 часов] | [ЗАПОЛНИТЬ: ≤ 7 дней] | Немедленная эскалация; блокировка релиза |
| **High** | 7.0–8.9 | [ЗАПОЛНИТЬ: ≤ 7 дней] | [ЗАПОЛНИТЬ: ≤ 14 дней] | Исправление в текущем спринте |
| **Medium** | 4.0–6.9 | [ЗАПОЛНИТЬ: ≤ 30 дней] | [ЗАПОЛНИТЬ: ≤ 60 дней] | Запланировать исправление |
| **Low** | 0.1–3.9 | [ЗАПОЛНИТЬ: ≤ 90 дней] | [ЗАПОЛНИТЬ: при следующем обновлении] | Исправить при возможности |

### 6.2. Процедура обновления зависимости

| Шаг | Действие | Ответственный |
|-----|----------|---------------|
| 1 | Определить целевую версию (fix-версия, рекомендация SCA-инструмента) | [ЗАПОЛНИТЬ: разработчик] |
| 2 | Оценить влияние обновления (breaking changes, changelog, совместимость) | [ЗАПОЛНИТЬ: разработчик] |
| 3 | Обновить зависимость в feature-ветке | [ЗАПОЛНИТЬ: разработчик] |
| 4 | Запустить полный набор тестов (unit, integration, e2e) | CI/CD автоматически |
| 5 | Запустить SCA-сканирование (проверить отсутствие новых уязвимостей) | CI/CD автоматически |
| 6 | Code review изменений (lock-файлы, package manifest) | [ЗАПОЛНИТЬ: рецензент / тимлид] |
| 7 | Merge и верификация в development | [ЗАПОЛНИТЬ: разработчик] |
| 8 | Обновить SBOM в Dependency-Track | Автоматически (CI/CD) |

### 6.3. Исключения и принятие рисков (Waivers)

Исключение (waiver) допускается, когда обновление зависимости невозможно или нецелесообразно:

| Условие | Описание |
|---------|----------|
| Нет fix-версии | Уязвимость обнаружена, но исправление ещё не выпущено |
| Breaking changes | Обновление требует значительной переработки кода |
| Неприменимость | Уязвимый функционал не используется в проекте |
| Альтернативные меры | Применены компенсирующие меры (WAF, сетевая изоляция) |

Формат документирования waiver:

| Поле | Описание | Обязательность |
|------|----------|----------------|
| CVE ID | Идентификатор уязвимости | Обязательно |
| Зависимость и версия | Имя и версия затронутого компонента | Обязательно |
| CVSS Score | Оценка критичности | Обязательно |
| Обоснование | Почему уязвимость не устраняется | Обязательно |
| Компенсирующие меры | Какие меры снижают риск | Обязательно |
| Дата пересмотра | Когда решение будет пересмотрено | Обязательно |
| Утвердил | ФИО и должность (для Critical/High — [ЗАПОЛНИТЬ: руководитель РБПО]) | Обязательно |

### 6.4. Утверждение исключений

| Severity уязвимости | Кто может запросить waiver | Кто утверждает |
|---------------------|--------------------------|----------------|
| Critical | [ЗАПОЛНИТЬ: инженер по безопасности] | [ЗАПОЛНИТЬ: руководитель РБПО + тимлид] |
| High | [ЗАПОЛНИТЬ: инженер по безопасности] | [ЗАПОЛНИТЬ: тимлид + инженер по безопасности] |
| Medium | Разработчик | [ЗАПОЛНИТЬ: тимлид] |
| Low | Разработчик | Не требуется (только документирование) |

---

## 7. Лицензионный анализ

### 7.1. Допустимые лицензии (Whitelist)

| Категория | Лицензии | Статус |
|-----------|----------|--------|
| **Разрешительные (permissive)** | MIT, Apache 2.0, BSD-2-Clause, BSD-3-Clause, ISC, Unlicense, CC0-1.0 | Допустимы без ограничений |
| **Слабый копилефт** | LGPL-2.1, LGPL-3.0, MPL-2.0 | Допустимы при соблюдении условий (динамическая линковка) |
| **Коммерческие** | Лицензии с приобретённой лицензией | Допустимы при наличии действующей лицензии |
| [ЗАПОЛНИТЬ: дополнительные] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

### 7.2. Запрещённые лицензии (Blacklist)

| Категория | Лицензии | Причина запрета |
|-----------|----------|----------------|
| **Сильный копилефт** | GPL-2.0, GPL-3.0, AGPL-3.0 | Требуют раскрытия исходного кода производного продукта |
| **Ограничительные** | SSPL, BSL, Commons Clause | Ограничения на коммерческое использование |
| **Неизвестные** | Unlicensed, NOASSERTION, Custom | Невозможно определить условия использования |
| [ЗАПОЛНИТЬ: дополнительные] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

### 7.3. Процедура согласования новых лицензий

| Шаг | Действие | Ответственный |
|-----|----------|---------------|
| 1 | Обнаружение зависимости с лицензией, не входящей в whitelist или blacklist | SCA-инструмент / разработчик |
| 2 | Анализ условий лицензии | [ЗАПОЛНИТЬ: юрист / инженер по безопасности] |
| 3 | Оценка совместимости с лицензией продукта | [ЗАПОЛНИТЬ: юрист] |
| 4 | Определение способа использования (статическая/динамическая линковка, SaaS) | [ЗАПОЛНИТЬ: разработчик + юрист] |
| 5 | Решение: добавить в whitelist / blacklist / одобрить с условиями | [ЗАПОЛНИТЬ: руководитель РБПО + юрист] |
| 6 | Обновление whitelist/blacklist в конфигурации SCA-инструмента | [ЗАПОЛНИТЬ: DevSecOps-инженер] |

### 7.4. Контроль лицензий в CI/CD

| Правило | Действие при нарушении |
|---------|----------------------|
| Зависимость с лицензией из blacklist | Блокировка merge |
| Зависимость с неизвестной лицензией (NOASSERTION, Unlicensed) | Блокировка merge до согласования |
| Зависимость с лицензией из whitelist | Допуск без ограничений |
| Зависимость со слабым копилефтом (LGPL, MPL) | Предупреждение; допуск при соблюдении условий |

---

## 8. Интеграция в CI/CD

### 8.1. Quality Gates

> Требование ГОСТ Р 56939-2024, п. 5.16.2 — разработать регламент композиционного анализа.

#### Quality Gate для pull request

| Критерий | Пороговое значение | Действие при нарушении |
|----------|-------------------|----------------------|
| Новые уязвимости Critical severity | 0 | Блокировка merge |
| Новые уязвимости High severity | 0 | Блокировка merge |
| Новые уязвимости Medium severity | [ЗАПОЛНИТЬ: 0 / ≤ 3] | [ЗАПОЛНИТЬ: Блокировка merge / Предупреждение] |
| Новые уязвимости Low severity | [ЗАПОЛНИТЬ: ≤ 5] | Предупреждение |
| Запрещённая лицензия | 0 | Блокировка merge |
| Неизвестная лицензия | 0 | Блокировка merge до согласования |
| Deprecated / unmaintained зависимость | [ЗАПОЛНИТЬ: ≤ 1] | Предупреждение |

#### Quality Gate для релиза

| Критерий | Пороговое значение | Действие при нарушении |
|----------|-------------------|----------------------|
| Открытые уязвимости Critical severity | 0 | Блокировка релиза |
| Открытые уязвимости High severity | 0 (или все имеют waiver) | Блокировка релиза |
| Открытые уязвимости Medium severity | [ЗАПОЛНИТЬ: ≤ 10 / все имеют waiver] | Требуется обоснование |
| SBOM сгенерирован и актуален | Да | Блокировка релиза без SBOM |
| Все лицензии в whitelist | Да | Блокировка релиза |
| Все waivers актуальны (дата пересмотра не просрочена) | Да | Требуется пересмотр |

### 8.2. Автоматическое сканирование

| Событие | Команда / инструмент | Артефакт | Время выполнения |
|---------|---------------------|----------|------------------|
| PR создан / обновлён | [ЗАПОЛНИТЬ: `trivy fs --scanners vuln,license .`] | Отчёт SCA (JSON / SARIF) | [ЗАПОЛНИТЬ: ≤ 5 мин] |
| Merge в `development` | [ЗАПОЛНИТЬ: `trivy fs . && trivy image <image>`] | Отчёт SCA + обновление Dependency-Track | [ЗАПОЛНИТЬ: ≤ 10 мин] |
| Merge в `main` / тег релиза | Все инструменты + генерация SBOM | SBOM + отчёт SCA + загрузка в Dependency-Track | [ЗАПОЛНИТЬ: ≤ 15 мин] |
| Nightly (по расписанию) | [ЗАПОЛНИТЬ: Dependency-Track policy evaluation] | Уведомления о новых CVE | — |

Конфигурация CI/CD пайплайна:

```
[ЗАПОЛНИТЬ: пример конфигурации CI/CD для вашей системы, например:]

# .gitlab-ci.yml / .github/workflows/sca.yml
sca:
  stage: test
  script:
    - trivy fs --scanners vuln,license --format json --output sca-report.json .
    - trivy fs --scanners vuln --exit-code 1 --severity CRITICAL,HIGH .
  rules:
    - if: $CI_PIPELINE_SOURCE == "merge_request_event"
    - if: $CI_COMMIT_BRANCH == "development"
    - if: $CI_COMMIT_BRANCH == "main"
  artifacts:
    reports:
      sca: sca-report.json

sbom:
  stage: build
  script:
    - syft . -o cyclonedx-json > sbom.cdx.json
    - cyclonedx-cli validate --input-file sbom.cdx.json
  artifacts:
    paths:
      - sbom.cdx.json
  rules:
    - if: $CI_COMMIT_TAG
```

### 8.3. Break-build политика

| Уровень строгости | Описание | Когда применяется |
|--------------------|----------|-------------------|
| **Strict** | Сборка падает при любой уязвимости Critical/High | Production-ветки (main), release-теги |
| **Standard** | Сборка падает при новых уязвимостях Critical/High; предупреждение для Medium | Development-ветки, PR |
| **Permissive** | Только предупреждения (не блокирует) | Feature-ветки, экспериментальные PR |

---

## 9. Политика обновления зависимостей

### 9.1. Регулярные обновления

| Тип обновления | Описание | Периодичность | Ответственный |
|----------------|----------|---------------|---------------|
| **Security updates** | Обновления, устраняющие известные уязвимости (CVE) | В соответствии с SLA (раздел 6.1) | [ЗАПОЛНИТЬ: разработчик / DevSecOps] |
| **Patch updates** | Минорные обновления (bug fixes) в пределах текущей мажорной/минорной версии | [ЗАПОЛНИТЬ: еженедельно / раз в 2 недели] | [ЗАПОЛНИТЬ: разработчик] |
| **Minor updates** | Обновления с новой функциональностью (без breaking changes) | [ЗАПОЛНИТЬ: ежемесячно] | [ЗАПОЛНИТЬ: разработчик] |
| **Major updates** | Обновления с breaking changes | [ЗАПОЛНИТЬ: ежеквартально / по необходимости] | [ЗАПОЛНИТЬ: тимлид + разработчик] |

### 9.2. Процедура регулярного обновления

| Шаг | Действие | Ответственный |
|-----|----------|---------------|
| 1 | Автоматическое обнаружение доступных обновлений ([ЗАПОЛНИТЬ: Dependabot / Renovate / ручная проверка]) | Автоматически / [ЗАПОЛНИТЬ] |
| 2 | Оценка: security fix, bug fix, new feature, breaking change | [ЗАПОЛНИТЬ: разработчик] |
| 3 | Создание PR с обновлением зависимости | Автоматически (Dependabot / Renovate) или [ЗАПОЛНИТЬ: разработчик] |
| 4 | CI/CD: тесты, SAST, SCA-сканирование | Автоматически |
| 5 | Code review: проверка changelog, breaking changes, новых зависимостей | [ЗАПОЛНИТЬ: рецензент] |
| 6 | Merge после прохождения всех проверок | [ЗАПОЛНИТЬ: рецензент / тимлид] |

### 9.3. Ограничения на обновления

| Правило | Описание |
|---------|----------|
| **Lock-файлы обязательны** | Все зависимости зафиксированы в lock-файлах; обновление — только через явное изменение lock-файла |
| **Одно обновление за раз** | Major-обновления выполняются по одной зависимости за PR для изоляции проблем |
| **Запрет wildcard-версий** | Запрещены `*`, `latest`, `>=` без верхней границы в манифестах зависимостей |
| **Проверка транзитивных зависимостей** | При обновлении прямой зависимости проверять изменения в транзитивных |
| **Тестирование обязательно** | Любое обновление зависимости проходит полный набор тестов |

### 9.4. End-of-Life зависимости

| Шаг | Действие | Срок |
|-----|----------|------|
| 1 | Мониторинг EOL-дат используемых компонентов | Непрерывно ([ЗАПОЛНИТЬ: endoflife.date / вручную]) |
| 2 | Уведомление команды при приближении EOL (≤ 6 месяцев) | [ЗАПОЛНИТЬ: автоматически / на ретро] |
| 3 | Планирование миграции на поддерживаемую версию | [ЗАПОЛНИТЬ: ≤ 3 месяцев до EOL] |
| 4 | Выполнение миграции до наступления EOL | До даты EOL |
| 5 | Если миграция невозможна — оформление waiver (раздел 6.3) | [ЗАПОЛНИТЬ: с обоснованием и компенсирующими мерами] |

---

## 10. Метрики и отчётность

### 10.1. Метрики композиционного анализа

| Метрика | Описание | Целевое значение |
|---------|----------|------------------|
| **Total Vulnerabilities** | Общее количество открытых уязвимостей в зависимостях | Тренд к снижению |
| **Critical/High Open** | Количество открытых уязвимостей Critical + High severity | [ЗАПОЛНИТЬ: 0 Critical, ≤ 3 High] |
| **Mean Time to Remediate (MTTR)** | Среднее время от обнаружения до устранения уязвимости | Critical: [ЗАПОЛНИТЬ: ≤ 48ч], High: [ЗАПОЛНИТЬ: ≤ 7 дн] |
| **SLA Compliance** | Процент уязвимостей, устранённых в пределах SLA | [ЗАПОЛНИТЬ: ≥ 90%] |
| **Dependency Freshness** | Процент зависимостей, обновлённых до последней minor/patch-версии | [ЗАПОЛНИТЬ: ≥ 70%] |
| **SBOM Completeness** | Процент компонентов в SBOM с заполненными PURL, лицензией и хешом | [ЗАПОЛНИТЬ: ≥ 95%] |
| **License Compliance** | Процент зависимостей с лицензиями из whitelist | [ЗАПОЛНИТЬ: 100%] |
| **EOL Components** | Количество зависимостей, достигших End-of-Life | [ЗАПОЛНИТЬ: 0] |
| **Waiver Count** | Количество действующих waivers | Тренд к снижению |
| **Quality Gate Pass Rate** | Процент PR, прошедших SCA Quality Gate с первого раза | [ЗАПОЛНИТЬ: ≥ 85%] |
| **Transitive Vulnerability Ratio** | Доля уязвимостей в транзитивных зависимостях от общего числа | Информационная |
| **New Dependency Approval Time** | Среднее время согласования новой зависимости (лицензия + безопасность) | [ЗАПОЛНИТЬ: ≤ 2 рабочих дней] |

### 10.2. Периодичность отчётности

#### Отчёт по каждому сканированию в CI/CD

Формируется автоматически. Содержит:

- Дата и время сканирования, ветка, коммит.
- Инструменты и версии, источники данных (NVD, OSV, Advisory).
- Количество обнаруженных уязвимостей по severity.
- Список новых уязвимостей (CVE ID, зависимость, severity, fix-версия).
- Лицензионные нарушения (при наличии).
- Статус Quality Gate (Pass / Fail).

#### Сводный отчёт (ежемесячный)

Формируется [ЗАПОЛНИТЬ: DevSecOps-инженером / инженером по безопасности]. Содержит:

- Динамика метрик за период (тренды).
- Топ-10 наиболее критичных уязвимостей.
- Топ-10 зависимостей с наибольшим количеством уязвимостей.
- Статистика по типам уязвимостей (CWE).
- Статистика обновлений зависимостей.
- Статистика waivers (новые, просроченные, закрытые).
- Лицензионная статистика.
- Рекомендации по улучшению.

#### Отчёт перед релизом

Формируется перед каждым релизом. Содержит:

- Результаты полного SCA-анализа.
- Перечень всех зависимостей (SBOM) с версиями и лицензиями.
- Перечень открытых уязвимостей с обоснованием (waivers).
- Статус Quality Gate для релиза.
- Заключение о допустимости релиза с точки зрения безопасности зависимостей.

### 10.3. Отслеживание трендов

| Показатель | Период | Визуализация |
|------------|--------|-------------|
| Открытые уязвимости по severity | Понедельно | Stacked bar chart |
| Новые vs. исправленные уязвимости | Понедельно | Линейный график |
| MTTR по severity | Помесячно | Линейный график |
| SLA compliance rate | Помесячно | Линейный график |
| Dependency freshness | Помесячно | Процентный график |
| License compliance | Помесячно | Pie chart |
| Топ уязвимых зависимостей | Поквартально | Горизонтальная гистограмма |

---

## 11. Реестр результатов анализа

### 11.1. Формат реестра

Реестр результатов ведётся в системе [ЗАПОЛНИТЬ: OWASP Dependency-Track / Jira / GitLab] и дополнительно фиксируется в сводной таблице:

| ID | Дата обнаружения | CVE ID | Зависимость | Версия | Severity (CVSS) | CWE | Описание | Fix-версия | Статус | Исполнитель | Дата устранения | Версия продукта | Waiver | Примечание |
|----|------------------|--------|-------------|--------|-----------------|-----|----------|------------|--------|-------------|-----------------|-----------------|--------|------------|
| SCA-001 | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |
| SCA-002 | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |
| SCA-003 | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

### 11.2. Статусы записей

| Статус | Описание |
|--------|----------|
| Open | Уязвимость обнаружена, ожидает триажа или исправления |
| In Progress | Уязвимость в работе у исполнителя (обновление зависимости / workaround) |
| Fixed | Зависимость обновлена, уязвимость устранена и подтверждена повторным сканированием |
| Waiver | Принято решение о принятии риска (с обоснованием и утверждением) |
| Not Affected | Уязвимый функционал не используется в проекте (VEX status: not_affected) |
| False Positive | Ложноположительное срабатывание SCA-инструмента |

### 11.3. Хранение отчётов

| Параметр | Значение |
|----------|----------|
| Место хранения отчётов | [ЗАПОЛНИТЬ: Dependency-Track / артефакты CI/CD / файловый архив] |
| Срок хранения | [ЗАПОЛНИТЬ: не менее 5 лет / срок действия сертификата + 1 год] |
| Резервное копирование | [ЗАПОЛНИТЬ: периодичность и способ] |
| Доступ | [ЗАПОЛНИТЬ: ограниченный круг лиц — команда разработки, ИБ, аудиторы] |
| Формат экспорта | CycloneDX VEX JSON, SARIF, CSV, PDF |

---

## 12. История изменений

| Версия | Дата | Описание изменений | Автор |
|--------|------|--------------------|-------|
| 1.0 | [ЗАПОЛНИТЬ: дата] | Первая версия документа | [ЗАПОЛНИТЬ: ФИО] |
