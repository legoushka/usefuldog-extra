# Регламент безопасной доставки ПО

| | |
|---|---|
| **Продукт** | [ЗАПОЛНИТЬ: наименование СЗИ] |
| **Версия документа** | 1.0 |
| **Дата** | [ЗАПОЛНИТЬ: дата утверждения] |
| **Статус** | Проект |
| **Утверждено** | [ЗАПОЛНИТЬ: должность, ФИО руководителя] |
| **Процесс ГОСТ Р 56939-2024** | 5.21 — Безопасная доставка ПО пользователям |

---

## Содержание

1. [Общие сведения](#1-общие-сведения)
2. [Область применения](#2-область-применения)
3. [Методы доставки ПО](#3-методы-доставки-по)
4. [Обеспечение целостности при доставке](#4-обеспечение-целостности-при-доставке)
5. [Верификация артефактов получателем](#5-верификация-артефактов-получателем)
6. [Каналы доставки и их защита](#6-каналы-доставки-и-их-защита)
7. [Доставка обновлений безопасности](#7-доставка-обновлений-безопасности)
8. [Документация для получателя](#8-документация-для-получателя)
9. [Мониторинг целостности доставленного ПО](#9-мониторинг-целостности-доставленного-по)
10. [Реестр доставок](#10-реестр-доставок)
11. [История изменений](#11-история-изменений)

---

## 1. Общие сведения

### 1.1. Назначение документа

Настоящий Регламент определяет порядок:

- Фиксации версий поставляемого ПО и обеспечения однозначной идентификации дистрибутивов.
- Обеспечения целостности артефактов ПО при доставке от разработчика к получателю.
- Подписания дистрибутивов и предоставления получателям средств верификации подлинности.
- Организации защищённых каналов доставки (container registry, package registry, CDN, физические носители).
- Предоставления ПО вместе с сопроводительной документацией (release notes, SBOM, verification instructions).
- Доставки обновлений безопасности в ускоренном режиме с уведомлением получателей.
- Мониторинга целостности доставленного ПО после развёртывания.

Регламент разработан в соответствии с требованиями ГОСТ Р 56939-2024, п. 5.21 (безопасная доставка ПО пользователям) и п. 5.21.2, которые устанавливают необходимость:

- Фиксировать версии поставляемого ПО.
- Обеспечить целостность дистрибутивов при доставке.
- Предоставлять ПО вместе с документацией.

### 1.2. Нормативные ссылки

| Документ | Описание |
|----------|----------|
| ГОСТ Р 56939-2024, п. 5.21 | Безопасная доставка ПО пользователям — основной процесс |
| ГОСТ Р 56939-2024, п. 5.21.2 | Требования к процессу безопасной доставки ПО |
| ГОСТ Р 56939-2024, п. 5.20 | Обеспечение безопасности выпуска готовой версии ПО — предшествующий процесс |
| ГОСТ Р 56939-2024, п. 5.12 | Использование безопасной системы сборки ПО — артефакты сборки |
| ГОСТ Р 56939-2024, п. 5.15 | Управление секретами — ключи подписания и доступ к registry |
| ГОСТ Р 56939-2024, п. 5.17 | Проверка кода на внедрение вредоносного ПО через цепочки поставок — целостность цепочки |
| ГОСТ Р 56939-2024, п. 5.4 | Управление конфигурациями ПО — конфигурация дистрибутивов |
| Sigstore (cosign, Rekor, Fulcio) | Инструменты подписания, верификации и прозрачного логирования артефактов |
| TUF (The Update Framework) | Фреймворк безопасного распространения обновлений ПО; защита от rollback, freeze, mix-and-match атак |
| SLSA (Supply-chain Levels for Software Artifacts) | Фреймворк уровней безопасности цепочки поставок ПО |

### 1.3. Связь с другими документами комплекта РБПО

| Документ РБПО | Связь |
|----------------|-------|
| 03 — Регламент управления конфигурациями | Конфигурация дистрибутивов (версии, состав артефактов, checksums) является элементом конфигурации и управляется в соответствии с процессом 5.4 |
| 11 — Регламент безопасной сборки | Артефакты сборки (контейнерные образы, бинарные файлы, пакеты) являются входными данными для процесса доставки; целостность артефактов обеспечивается при сборке (процесс 5.12) |
| 14 — Политика управления секретами | Ключи подписания дистрибутивов, credentials для доступа к registry, API-токены каналов доставки управляются как секреты (процесс 5.15) |
| 16 — Регламент проверки цепочки поставок | Целостность цепочки поставок сохраняется на этапе доставки: подписи, provenance, checksums обеспечивают непрерывность цепочки от сборки до получателя (процесс 5.17) |
| 19 — Регламент приёмки и выпуска версии | Выпущенная версия (с пройденными security gates и sign-off) является входными данными для процесса доставки; доставка начинается только после завершения выпуска (процесс 5.20) |

---

## 2. Область применения

### 2.1. Каналы доставки

Настоящий Регламент распространяется на следующие каналы доставки ПО:

| Канал | Описание | Типы артефактов | Получатели |
|-------|----------|-----------------|-----------|
| **Container registry** | Публикация контейнерных образов в OCI-совместимый registry | Docker images (OCI) | DevOps-инженеры, CI/CD системы получателей |
| **Package registry** | Публикация пакетов в языковые registry (npm, PyPI, Maven и др.) | npm packages, Python wheels, Maven artifacts | Разработчики, пакетные менеджеры |
| **Binary distribution** | Публикация бинарных артефактов и архивов | tar.gz, zip, .deb, .rpm, .msi, .dmg | Системные администраторы, конечные пользователи |
| **SaaS / Cloud** | Развёртывание обновлений в облачной среде | Контейнеры, serverless functions | Конечные пользователи (автоматически) |
| **Физические носители** | Передача ПО на физических носителях (для air-gapped сред) | ISO-образы, USB-накопители, DVD | Заказчики с изолированными средами |
| [ЗАПОЛНИТЬ: дополнительные каналы] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

### 2.2. Типы артефактов доставки

| Тип артефакта | Формат | Метод обеспечения целостности | Сопроводительные файлы |
|---------------|--------|------------------------------|----------------------|
| **Контейнерный образ** | OCI image | cosign signature + image digest (SHA-256) | SBOM (CycloneDX), SLSA provenance |
| **npm-пакет** | .tgz | npm provenance + integrity hash (SHA-512) | SBOM, package.json |
| **Python-пакет** | .whl / .tar.gz | PyPI Trusted Publisher + GPG signature | SBOM, metadata |
| **Бинарный архив** | .tar.gz / .zip | SHA-256 checksums + GPG detached signature | SHA256SUMS, SHA256SUMS.sig, release notes |
| **Системный пакет** | .deb / .rpm | Пакетная подпись (dpkg-sig / rpm --sign) | Changelog, package metadata |
| **ISO-образ** | .iso | SHA-256 checksum + GPG signature | SHA256SUMS, SHA256SUMS.sig, verification guide |
| **Helm chart** | .tgz | Helm provenance file (.prov) | Chart.yaml, values.yaml, SBOM |

### 2.3. Получатели

| Категория получателя | Описание | Канал доставки | Специфические требования |
|---------------------|----------|---------------|------------------------|
| [ЗАПОЛНИТЬ: внутренние команды] | [ЗАПОЛНИТЬ: описание] | [ЗАПОЛНИТЬ: container registry / package registry] | [ЗАПОЛНИТЬ] |
| [ЗАПОЛНИТЬ: заказчики (on-premise)] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: binary / physical] | [ЗАПОЛНИТЬ: verification guide, installation guide] |
| [ЗАПОЛНИТЬ: SaaS-пользователи] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: SaaS / Cloud] | [ЗАПОЛНИТЬ: release notes, downtime notification] |
| [ЗАПОЛНИТЬ: open-source community] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: GitHub Releases / package registry] | [ЗАПОЛНИТЬ: public verification keys] |

---

## 3. Методы доставки ПО

### 3.1. Контейнерные образы

> Требование ГОСТ Р 56939-2024, п. 5.21.2 — фиксировать версии поставляемого ПО.

| Параметр | Значение |
|----------|----------|
| Container registry | [ЗАПОЛНИТЬ: Docker Hub / GitHub Container Registry / private registry URL] |
| Naming convention | [ЗАПОЛНИТЬ: `registry.example.com/product/component:vX.Y.Z`] |
| Tag strategy | Immutable version tags (`vX.Y.Z`); mutable `latest` tag указывает на последний стабильный релиз |
| Digest pinning | Все образы идентифицируются по digest (SHA-256) в дополнение к тегу |
| Multi-arch support | [ЗАПОЛНИТЬ: amd64, arm64 / single-arch] |
| Подписание | cosign sign с записью в Rekor transparency log |
| SBOM attachment | SBOM прикрепляется к образу как OCI artifact (cosign attach sbom) |

**Процедура публикации контейнерного образа:**

| Шаг | Действие | Инструмент |
|-----|----------|-----------|
| 1 | Build образа из tagged commit (по документу 11) | Docker / BuildKit |
| 2 | Генерация SBOM для образа | [ЗАПОЛНИТЬ: syft / trivy / cdxgen] |
| 3 | Push образа в registry | docker push / crane push |
| 4 | Подписание образа | cosign sign |
| 5 | Прикрепление SBOM к образу | cosign attach sbom |
| 6 | Прикрепление SLSA provenance (при наличии) | cosign attach attestation |
| 7 | Верификация опубликованного образа | cosign verify |
| 8 | Запись в реестр доставок (раздел 10) | Ручная / автоматическая |

### 3.2. Пакеты и бинарные артефакты

| Параметр | Значение |
|----------|----------|
| npm registry | [ЗАПОЛНИТЬ: npmjs.com / private registry] |
| PyPI registry | [ЗАПОЛНИТЬ: pypi.org / private registry] |
| Binary hosting | [ЗАПОЛНИТЬ: GitHub Releases / S3 / CDN / internal storage] |
| Naming convention | [ЗАПОЛНИТЬ: `@scope/package@vX.Y.Z` / `package==X.Y.Z`] |
| Подписание npm | npm provenance (Trusted Publisher) |
| Подписание PyPI | PyPI Trusted Publisher + GPG signature |
| Подписание binary | GPG detached signature (.sig) + SHA256SUMS |

**Процедура публикации пакета / бинарного артефакта:**

| Шаг | Действие | Инструмент |
|-----|----------|-----------|
| 1 | Build артефакта из tagged commit (по документу 11) | [ЗАПОЛНИТЬ: npm pack / python -m build / make release] |
| 2 | Генерация контрольных сумм | `sha256sum <artifact> >> SHA256SUMS` |
| 3 | Подписание артефакта и SHA256SUMS | gpg --detach-sign |
| 4 | Публикация в registry / hosting | npm publish / twine upload / gh release upload |
| 5 | Верификация опубликованного артефакта | Download + verify checksum + verify signature |
| 6 | Запись в реестр доставок (раздел 10) | Ручная / автоматическая |

### 3.3. SaaS-доставка

| Параметр | Значение |
|----------|----------|
| Метод обновления | [ЗАПОЛНИТЬ: blue-green deployment / rolling update / canary release] |
| Уведомление пользователей | [ЗАПОЛНИТЬ: status page / email / in-app notification] |
| Downtime window | [ЗАПОЛНИТЬ: zero-downtime / maintenance window] |
| Rollback mechanism | [ЗАПОЛНИТЬ: instant rollback / previous container version] |
| Verification | [ЗАПОЛНИТЬ: health checks / smoke tests / synthetic monitoring] |

### 3.4. Физические носители

| Параметр | Значение |
|----------|----------|
| Типы носителей | [ЗАПОЛНИТЬ: USB-накопители / DVD / защищённые flash-накопители] |
| Подготовка носителя | Запись ISO-образа; запись SHA256SUMS и подписей; запись документации |
| Маркировка | [ЗАПОЛНИТЬ: наклейка с версией, датой, серийным номером] |
| Защита от подмены | [ЗАПОЛНИТЬ: tamper-evident упаковка / пломбирование / серийный номер] |
| Передача | [ЗАПОЛНИТЬ: курьерская доставка / личная передача / защищённая почта] |
| Акт приёма-передачи | [ЗАПОЛНИТЬ: формализованный акт с серийными номерами и checksums] |
| Уничтожение предыдущих носителей | [ЗАПОЛНИТЬ: процедура безопасного уничтожения] |

---

## 4. Обеспечение целостности при доставке

### 4.1. Подписание артефактов

> Требование ГОСТ Р 56939-2024, п. 5.21.2 — обеспечить целостность дистрибутивов при доставке.

| Метод подписания | Описание | Применимость | Инструмент |
|-----------------|----------|-------------|-----------|
| **Keyless signing (Sigstore)** | Подписание с использованием OIDC-идентификации (без долгоживущих ключей); подпись записывается в Rekor transparency log | Контейнерные образы, OCI artifacts | cosign sign (keyless mode) |
| **Key-based signing (cosign)** | Подписание с использованием предварительно сгенерированной ключевой пары | Контейнерные образы (private registry без OIDC) | cosign sign --key |
| **GPG signing** | Подписание с использованием GPG-ключа; создание detached signature (.sig) | Бинарные артефакты, tar.gz, ISO-образы, SHA256SUMS | gpg --detach-sign |
| **Package manager signing** | Встроенные механизмы подписания пакетных менеджеров | npm (provenance), PyPI (Trusted Publisher), RPM, DEB | npm publish --provenance, twine upload, rpmsign |
| **Helm provenance** | Подписание Helm charts с генерацией .prov файла | Helm charts | helm package --sign |

### 4.2. Контрольные суммы (checksums)

| Алгоритм | Применение | Формат файла |
|----------|-----------|--------------|
| **SHA-256** | Основной алгоритм для контрольных сумм всех артефактов | `SHA256SUMS` (формат `sha256sum`) |
| **SHA-512** | Integrity hash в npm lock-файлах и некоторых registry | Встроен в lock-файлы |
| **Image digest** | Идентификация контейнерных образов | `sha256:<hex>` (OCI digest) |

**Процедура генерации и публикации checksums:**

| Шаг | Действие | Команда / инструмент |
|-----|----------|---------------------|
| 1 | Генерация SHA-256 для каждого артефакта | `sha256sum <artifact1> <artifact2> ... > SHA256SUMS` |
| 2 | Подпись файла контрольных сумм | `gpg --armor --detach-sign SHA256SUMS` → `SHA256SUMS.asc` |
| 3 | Публикация SHA256SUMS и SHA256SUMS.asc вместе с артефактами | gh release upload / copy to CDN |
| 4 | Публикация fingerprint GPG-ключа подписания | [ЗАПОЛНИТЬ: website / KEYS file / keyserver] |

### 4.3. TLS и защита транспортного уровня

| Канал | Требование | Реализация |
|-------|-----------|-----------|
| Container registry | HTTPS обязателен | TLS 1.2+ для всех обращений к registry |
| Package registry | HTTPS обязателен | TLS 1.2+ для npm, PyPI и всех registry |
| CDN / file hosting | HTTPS обязателен | TLS 1.2+ для скачивания артефактов |
| Зеркала | HTTPS обязателен | TLS 1.2+; проверка подлинности зеркала |
| Физическая передача | N/A | Целостность обеспечивается подписями и checksums |

### 4.4. Notarization (для специфических платформ)

| Платформа | Метод | Инструмент | Статус |
|-----------|-------|-----------|--------|
| macOS | Apple Notarization | `notarytool submit` / `xcrun altool` | [ЗАПОЛНИТЬ: используется / не применимо] |
| Windows | Microsoft SmartScreen / Authenticode | `signtool sign` | [ЗАПОЛНИТЬ: используется / не применимо] |
| Linux | GPG signing + package manager signatures | gpg, dpkg-sig, rpmsign | [ЗАПОЛНИТЬ: используется] |

---

## 5. Верификация артефактов получателем

### 5.1. Инструкции по проверке подписей

> Требование ГОСТ Р 56939-2024, п. 5.21.2 — предоставлять ПО вместе с документацией.

**Верификация контейнерного образа (cosign):**

```
# Keyless verification (Sigstore)
cosign verify \
  --certificate-identity [ЗАПОЛНИТЬ: workflow identity URL] \
  --certificate-oidc-issuer [ЗАПОЛНИТЬ: OIDC issuer URL] \
  [ЗАПОЛНИТЬ: registry.example.com/product/component:vX.Y.Z]

# Key-based verification
cosign verify --key [ЗАПОЛНИТЬ: cosign.pub URL] \
  [ЗАПОЛНИТЬ: registry.example.com/product/component:vX.Y.Z]
```

**Верификация GPG-подписи бинарного артефакта:**

```
# Import public key
gpg --import [ЗАПОЛНИТЬ: product-release-key.asc]
# или
gpg --keyserver [ЗАПОЛНИТЬ: keyserver URL] --recv-keys [ЗАПОЛНИТЬ: KEY_ID]

# Verify signature
gpg --verify SHA256SUMS.asc SHA256SUMS

# Verify checksum
sha256sum -c SHA256SUMS
```

**Верификация npm provenance:**

```
npm audit signatures
```

### 5.2. Инструкции по проверке контрольных сумм

| Платформа | Команда |
|-----------|---------|
| Linux / macOS | `sha256sum -c SHA256SUMS` |
| Windows (PowerShell) | `Get-FileHash <artifact> -Algorithm SHA256` и сравнить с SHA256SUMS |
| Container digest | `docker inspect --format='{{index .RepoDigests 0}}' <image>` и сравнить с опубликованным digest |

### 5.3. Verification scripts

| Скрипт | Описание | Расположение |
|--------|----------|-------------|
| `verify.sh` | Bash-скрипт: загрузка GPG-ключа, проверка подписи SHA256SUMS, проверка checksums артефактов | [ЗАПОЛНИТЬ: включён в release artifacts / опубликован на сайте] |
| `verify.ps1` | PowerShell-скрипт: аналогичная верификация для Windows | [ЗАПОЛНИТЬ: включён в release artifacts] |
| `cosign-verify.sh` | Bash-скрипт: верификация подписи контейнерного образа через cosign | [ЗАПОЛНИТЬ: включён в документацию] |

**Пример содержания verify.sh:**

```bash
#!/usr/bin/env bash
set -euo pipefail

# [ЗАПОЛНИТЬ: URL публичного GPG-ключа]
GPG_KEY_URL="[ЗАПОЛНИТЬ]"
GPG_KEY_FINGERPRINT="[ЗАПОЛНИТЬ]"

echo "Importing release signing key..."
curl -sSL "$GPG_KEY_URL" | gpg --import

echo "Verifying GPG signature of checksums..."
gpg --verify SHA256SUMS.asc SHA256SUMS

echo "Verifying file checksums..."
sha256sum -c SHA256SUMS

echo "All verifications passed."
```

### 5.4. Публикация ключей верификации

| Ключ | Формат | Место публикации | Обновление |
|------|--------|-----------------|-----------|
| GPG public key (release signing) | ASCII-armored (.asc) | [ЗАПОЛНИТЬ: KEYS file в репозитории / website / keyserver] | При ротации ключа |
| cosign public key | PEM (.pub) | [ЗАПОЛНИТЬ: репозиторий / website] | При ротации ключа |
| Sigstore OIDC identity | Certificate identity + OIDC issuer | [ЗАПОЛНИТЬ: документация / SECURITY.md] | При изменении CI/CD workflow |
| GPG key fingerprint | Hex string | [ЗАПОЛНИТЬ: website / SECURITY.md / release notes] | При ротации ключа |

---

## 6. Каналы доставки и их защита

### 6.1. Container registry

| Параметр | Значение |
|----------|----------|
| Primary registry | [ЗАПОЛНИТЬ: Docker Hub / GHCR / private registry URL] |
| Mirror / backup registry | [ЗАПОЛНИТЬ: отсутствует / URL зеркала] |
| Аутентификация | [ЗАПОЛНИТЬ: token-based / OIDC / basic auth] |
| Авторизация (push) | [ЗАПОЛНИТЬ: только CI/CD service account / Release Manager] |
| Авторизация (pull) | [ЗАПОЛНИТЬ: public / authenticated users] |
| Content trust | [ЗАПОЛНИТЬ: Docker Content Trust / cosign / Notary v2] |
| Vulnerability scanning | [ЗАПОЛНИТЬ: Trivy / Grype / Docker Scout / registry-native scanning] |
| Image retention policy | [ЗАПОЛНИТЬ: хранить все release-теги; удалять dev-теги старше N дней] |
| Мониторинг | [ЗАПОЛНИТЬ: alert на unauthorized push / image deletion / tag mutation] |

### 6.2. Package registry

| Параметр | Значение |
|----------|----------|
| npm registry | [ЗАПОЛНИТЬ: npmjs.com / private Verdaccio / Artifactory] |
| PyPI registry | [ЗАПОЛНИТЬ: pypi.org / private Devpi / Artifactory] |
| Аутентификация (publish) | [ЗАПОЛНИТЬ: npm token / PyPI Trusted Publisher / API token] |
| 2FA | [ЗАПОЛНИТЬ: обязательно для publish / настроено] |
| Scoped packages | [ЗАПОЛНИТЬ: @scope/package для предотвращения dependency confusion] |
| Мониторинг | [ЗАПОЛНИТЬ: alert на новые публикации / unauthorized publish] |

### 6.3. CDN и зеркала

| Параметр | Значение |
|----------|----------|
| CDN provider | [ЗАПОЛНИТЬ: CloudFlare / AWS CloudFront / не используется] |
| Зеркала | [ЗАПОЛНИТЬ: список зеркал / не используются] |
| Cache invalidation | [ЗАПОЛНИТЬ: автоматическая при публикации / ручная] |
| Origin protection | [ЗАПОЛНИТЬ: WAF / rate limiting / DDoS protection] |
| Integrity verification | Получатель проверяет checksum после скачивания с CDN / зеркала |
| Мониторинг | [ЗАПОЛНИТЬ: alert на подмену файлов / аномальный трафик] |

### 6.4. Мониторинг каналов доставки

| Событие | Действие | Инструмент |
|---------|----------|-----------|
| **Unauthorized push** в registry | Блокировка; расследование; ротация credentials | [ЗАПОЛНИТЬ: registry audit log / alerting] |
| **Tag mutation** (перезапись тега) | Блокировка; сравнение digest; расследование | [ЗАПОЛНИТЬ: immutable tags policy / registry webhook] |
| **Image deletion** из registry | Расследование; восстановление из backup | [ЗАПОЛНИТЬ: registry audit log] |
| **CDN cache poisoning** | Инвалидация кеша; проверка origin; расследование | [ЗАПОЛНИТЬ: CDN audit log / integrity monitoring] |
| **Registry downtime** | Переключение на зеркало; уведомление пользователей | [ЗАПОЛНИТЬ: status page / monitoring] |
| **Аномальный трафик** | Анализ; возможная DDoS-атака; активация защиты | [ЗАПОЛНИТЬ: CDN analytics / WAF] |

---

## 7. Доставка обновлений безопасности

### 7.1. Ускоренный процесс доставки

| Шаг | Действие | Срок | Ответственный |
|-----|----------|------|---------------|
| 1 | Получение выпущенного hotfix-артефакта от процесса выпуска (документ 19, раздел 8) | По готовности | Release Manager |
| 2 | Публикация артефакта во все каналы доставки (раздел 3) | [ЗАПОЛНИТЬ: ≤ 1 час после выпуска] | DevOps |
| 3 | Верификация опубликованного артефакта (checksum + signature) | [ЗАПОЛНИТЬ: ≤ 30 минут] | DevOps |
| 4 | Уведомление получателей (раздел 7.2) | Одновременно с публикацией | Release Manager |
| 5 | Публикация security advisory (раздел 7.3) | [ЗАПОЛНИТЬ: одновременно / после embargo period] | Security |
| 6 | Мониторинг adoption rate (раздел 7.4) | Непрерывно после публикации | DevOps |

### 7.2. Уведомление получателей

| Канал уведомления | Аудитория | Содержание | Срок |
|-------------------|-----------|-----------|------|
| [ЗАПОЛНИТЬ: email рассылка] | Все зарегистрированные получатели | Версия, severity, рекомендация к обновлению, ссылки на артефакты | Одновременно с публикацией |
| [ЗАПОЛНИТЬ: status page] | Публично | Факт выпуска обновления безопасности, severity | Одновременно с публикацией |
| [ЗАПОЛНИТЬ: in-app notification] | SaaS-пользователи | Информация об автоматическом обновлении / необходимости ручного обновления | [ЗАПОЛНИТЬ: при следующем входе] |
| [ЗАПОЛНИТЬ: RSS / Atom feed] | Подписчики | Structured release notification | Автоматически |
| [ЗАПОЛНИТЬ: security mailing list] | Security-контакты получателей | Детальная информация: CVE, affected versions, mitigation | [ЗАПОЛНИТЬ: по security disclosure policy] |

### 7.3. Security advisory

| Поле | Описание |
|------|----------|
| **Advisory ID** | [ЗАПОЛНИТЬ: формат ID, например PRODUCT-SA-2024-001] |
| **CVE ID** | Идентификатор CVE (при наличии) |
| **Severity** | CVSS score + текстовый уровень (Critical / High / Medium / Low) |
| **Affected versions** | Перечень затронутых версий |
| **Fixed version** | Версия с исправлением |
| **Description** | Описание уязвимости (без технических деталей, достаточных для эксплуатации) |
| **Mitigation** | Рекомендуемые действия для получателя (обновление, workaround) |
| **Timeline** | Даты: обнаружение, исправление, публикация advisory |
| **Credits** | Благодарности обнаружившему (при согласии) |

### 7.4. Автоматические vs ручные обновления

| Сценарий | Тип обновления | Описание | Применимость |
|----------|---------------|----------|-------------|
| **SaaS (managed)** | Автоматическое | Обновление развёртывается автоматически; пользователь получает уведомление | SaaS-продукты |
| **Container (managed)** | Полуавтоматическое | Новый образ публикуется; получатель обновляет deployment | On-premise / managed Kubernetes |
| **Package update** | Ручное | Получатель обновляет зависимость в своём проекте | Библиотеки / пакеты |
| **Binary update** | Ручное | Получатель скачивает новую версию, проверяет и устанавливает | On-premise / air-gapped |
| **Auto-update agent** | Автоматическое | Встроенный механизм проверки и установки обновлений (TUF-based) | [ЗАПОЛНИТЬ: desktop apps / agents] |

---

## 8. Документация для получателя

### 8.1. Комплект документации

> Требование ГОСТ Р 56939-2024, п. 5.21.2 — предоставлять ПО вместе с документацией.

| Документ | Описание | Формат | Обязательность |
|----------|----------|--------|---------------|
| **Release notes** | Описание изменений: новая функциональность, исправления, breaking changes, security fixes | Markdown / HTML | Обязательно |
| **Installation guide** | Инструкция по установке / развёртыванию для каждого канала доставки | Markdown / HTML | Обязательно |
| **Verification instructions** | Инструкции по проверке подлинности и целостности артефактов (раздел 5) | Markdown / HTML | Обязательно |
| **SBOM** | Перечень программных компонентов (CycloneDX) | CycloneDX JSON / XML | Обязательно |
| **Migration guide** | Инструкции по миграции с предыдущей версии (при breaking changes) | Markdown / HTML | При наличии breaking changes |
| **Security advisory** | Описание устранённых уязвимостей (раздел 7.3) | [ЗАПОЛНИТЬ: CSAF / GitHub Advisory / markdown] | При наличии security fixes |
| **Configuration reference** | Описание параметров конфигурации и значений по умолчанию | Markdown / HTML | [ЗАПОЛНИТЬ: обязательно / для major releases] |
| **API changelog** | Описание изменений в API (при наличии) | Markdown / OpenAPI diff | При наличии API changes |

### 8.2. Release notes — содержание

| Раздел | Описание | Пример |
|--------|----------|--------|
| **Версия и дата** | Номер версии, дата выпуска | `v2.1.0 — 2024-12-01` |
| **Краткое описание** | Обзор изменений в 1–2 предложениях | «Добавлена поддержка SSO; устранены 3 уязвимости» |
| **Новое (Added)** | Новые возможности | — Поддержка SAML SSO |
| **Изменено (Changed)** | Изменения в существующей функциональности | — Обновлён формат логов |
| **Исправлено (Fixed)** | Исправления ошибок | — Исправлена ошибка валидации ввода |
| **Безопасность (Security)** | Устранённые уязвимости с CVE ID и severity | — CVE-2024-XXXXX (High): исправлен SQL injection |
| **Удалено (Removed)** | Удалённая функциональность | — Удалена поддержка API v1 |
| **Breaking changes** | Несовместимые изменения | — Изменён формат конфигурационного файла (см. migration guide) |
| **Обновление зависимостей** | Значимые обновления зависимостей (особенно security-related) | — Обновлён openssl до 3.2.0 |

### 8.3. Installation guide — содержание

| Раздел | Описание |
|--------|----------|
| **Системные требования** | Поддерживаемые ОС, архитектуры, минимальные ресурсы |
| **Предварительные условия** | Необходимое ПО (Docker, runtime, etc.) |
| **Получение артефактов** | Команды для скачивания / pull из registry |
| **Верификация** | Ссылка на verification instructions (раздел 5) |
| **Установка / развёртывание** | Пошаговая инструкция для каждого метода |
| **Конфигурация** | Описание обязательных и опциональных параметров |
| **Проверка работоспособности** | Health check, smoke test |
| **Обновление с предыдущей версии** | Процедура обновления; ссылка на migration guide |
| **Откат** | Процедура отката к предыдущей версии |

---

## 9. Мониторинг целостности доставленного ПО

### 9.1. Проверка после развёртывания

| Проверка | Описание | Метод | Периодичность |
|----------|----------|-------|---------------|
| **Версия соответствует ожидаемой** | Развёрнутая версия совпадает с выпущенной | Health endpoint возвращает version; `docker inspect` для image digest | При каждом развёртывании |
| **Image digest не изменился** | Digest контейнерного образа совпадает с опубликованным | Сравнение digest с registry | При каждом развёртывании |
| **SBOM соответствует** | Состав компонентов развёрнутого ПО совпадает с SBOM | [ЗАПОЛНИТЬ: runtime SBOM comparison / syft scan running container] | [ЗАПОЛНИТЬ: еженедельно / при развёртывании] |
| **Подпись артефакта валидна** | Подпись развёрнутого артефакта проверена | cosign verify / gpg --verify | При каждом развёртывании |
| **Конфигурация не изменена** | Конфигурация соответствует эталонной | [ЗАПОЛНИТЬ: configuration drift detection] | [ЗАПОЛНИТЬ: ежедневно / по расписанию] |
| **Нет несанкционированных изменений** | Файлы в production не изменены после развёртывания | [ЗАПОЛНИТЬ: file integrity monitoring (AIDE / OSSEC / Wazuh)] | [ЗАПОЛНИТЬ: непрерывно / по расписанию] |

### 9.2. Реагирование при нарушении целостности

| Событие | Действие | Срок | Ответственный |
|---------|----------|------|---------------|
| **Несовпадение digest / checksum** | Немедленная остановка развёртывания; расследование; проверка registry на компрометацию | Немедленно | DevOps + Security |
| **Невалидная подпись** | Отклонение артефакта; уведомление Security; проверка ключей подписания | Немедленно | DevOps + Security |
| **Изменение файлов в production** | Изоляция затронутого сервера; forensic snapshot; переразвёртывание из доверенного источника | [ЗАПОЛНИТЬ: ≤ 1 час] | DevOps + Security |
| **Подмена артефакта в registry** | Блокировка registry; rollback к последнему верифицированному артефакту; расследование | Немедленно | DevOps + Security |
| **Компрометация канала доставки** | Приостановка доставки; ротация credentials; уведомление получателей | [ЗАПОЛНИТЬ: ≤ 4 часа] | Security + DevOps |

### 9.3. Метрики мониторинга доставки

| Метрика | Описание | Целевое значение |
|---------|----------|-----------------|
| **Adoption rate** | Процент получателей, обновившихся до последней версии | [ЗАПОЛНИТЬ: ≥ 80% в течение 30 дней] |
| **Время от выпуска до доступности** | Время от создания release до доступности во всех каналах доставки | [ЗАПОЛНИТЬ: ≤ 1 час] |
| **Verification success rate** | Процент успешных верификаций подписей и checksums получателями | [ЗАПОЛНИТЬ: 100%] |
| **Integrity incidents** | Количество инцидентов нарушения целостности при доставке | [ЗАПОЛНИТЬ: 0] |
| **Security update delivery time** | Время от выпуска hotfix до доставки всем получателям | [ЗАПОЛНИТЬ: ≤ 4 часа] |

---

## 10. Реестр доставок

### 10.1. Формат реестра

| ID | Версия | Канал | Получатель | Дата доставки | Артефакт | Digest / Checksum | Подпись | Документация | Статус | Примечания |
|----|--------|-------|-----------|--------------|----------|-------------------|---------|-------------|--------|------------|
| DEL-001 | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: container registry] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: image:tag] | [ЗАПОЛНИТЬ: sha256:...] | [ЗАПОЛНИТЬ: cosign / GPG] | [ЗАПОЛНИТЬ: release notes, SBOM, verification guide] | [ЗАПОЛНИТЬ: Delivered / Verified / Failed] | [ЗАПОЛНИТЬ] |
| DEL-002 | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: npm registry] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: @scope/package@version] | [ЗАПОЛНИТЬ: sha512-...] | [ЗАПОЛНИТЬ: npm provenance] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |
| DEL-003 | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: binary / GitHub Release] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: filename.tar.gz] | [ЗАПОЛНИТЬ: sha256:...] | [ЗАПОЛНИТЬ: GPG detached] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |
| DEL-004 | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: physical media] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: ISO-образ, серийный номер носителя] | [ЗАПОЛНИТЬ: sha256:...] | [ЗАПОЛНИТЬ: GPG] | [ЗАПОЛНИТЬ: акт приёма-передачи] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

### 10.2. Статусы доставки

| Статус | Описание |
|--------|----------|
| **Preparing** | Артефакт готовится к публикации в канал доставки |
| **Published** | Артефакт опубликован в канале доставки; ожидает получения |
| **Delivered** | Артефакт доставлен получателю (подтверждено) |
| **Verified** | Получатель подтвердил верификацию целостности (checksum + подпись) |
| **Failed** | Доставка не удалась; требуется повторная доставка |
| **Recalled** | Артефакт отозван из канала доставки (по причине обнаруженных проблем) |

### 10.3. Связь с реестром выпусков

Каждая запись в реестре доставок ссылается на соответствующую запись в реестре выпусков (документ 19, раздел 10):

| Поле | Описание |
|------|----------|
| **Release ID** | Идентификатор выпуска из документа 19 (REL-XXX) |
| **Delivery ID** | Идентификатор доставки (DEL-XXX) |
| **Связь** | Один выпуск (REL) может иметь несколько доставок (DEL) — по одной на каждый канал/получателя |

### 10.4. Хранение реестра

| Параметр | Значение |
|----------|----------|
| Место хранения | [ЗАПОЛНИТЬ: Confluence / внутренняя wiki / Git-репозиторий / система управления поставками] |
| Доступ | [ЗАПОЛНИТЬ: Release Manager, DevOps, Security — read/write; разработчики — read] |
| Срок хранения | [ЗАПОЛНИТЬ: не менее 3 лет / срок действия сертификата + 1 год] |
| Автоматизация | [ЗАПОЛНИТЬ: CI/CD автоматически создаёт записи при публикации / ручное ведение] |

---

## 11. История изменений

| Версия | Дата | Описание изменений | Автор |
|--------|------|--------------------|-------|
| 1.0 | [ЗАПОЛНИТЬ: дата] | Первая версия документа | [ЗАПОЛНИТЬ: ФИО] |
