# Регламент управления доступом и контроля целостности кода

| | |
|---|---|
| **Продукт** | [ЗАПОЛНИТЬ: наименование СЗИ] |
| **Версия документа** | 1.0 |
| **Дата** | [ЗАПОЛНИТЬ: дата утверждения] |
| **Статус** | Проект |
| **Утверждено** | [ЗАПОЛНИТЬ: должность, ФИО руководителя] |
| **Процесс ГОСТ Р 56939-2024** | 5.14 — Управление доступом и контроль целостности кода |

---

## Содержание

1. [Общие сведения](#1-общие-сведения)
2. [Область применения](#2-область-применения)
3. [Модель управления доступом](#3-модель-управления-доступом)
4. [Правила доступа к репозиториям](#4-правила-доступа-к-репозиториям)
5. [Защита ветвей](#5-защита-ветвей)
6. [Подпись коммитов и тегов](#6-подпись-коммитов-и-тегов)
7. [Контроль целостности кода](#7-контроль-целостности-кода)
8. [Аудит изменений](#8-аудит-изменений)
9. [Управление учётными записями](#9-управление-учётными-записями)
10. [История изменений](#10-история-изменений)

---

## 1. Общие сведения

### 1.1. Назначение документа

Настоящий Регламент определяет порядок:

- Управления правами доступа к репозиториям исходного кода продукта [ЗАПОЛНИТЬ: наименование СЗИ].
- Контроля доступа на основе ролей (RBAC) с применением принципа минимальных привилегий.
- Защиты ветвей (branch protection) и обеспечения контролируемого слияния изменений.
- Подписания коммитов и тегов для обеспечения неотказуемости и контроля авторства.
- Контроля целостности исходного кода на всех этапах жизненного цикла.
- Ведения аудит-журнала изменений и периодического review прав доступа.
- Управления учётными записями (создание, деактивация, offboarding).

Регламент разработан в соответствии с требованиями ГОСТ Р 56939-2024, п. 5.14 (управление доступом и контроль целостности кода) и п. 5.14.2, которые устанавливают необходимость:

- Разработать регламент доступа к исходному коду.
- Контролировать доступ (RBAC, защищённые ветки, pull requests).
- Обеспечить целостность кода (подпись коммитов, protected branches).
- Описать процедуру контроля целостности.
- Вести аудит изменений.

### 1.2. Нормативные ссылки

| Документ | Описание |
|----------|----------|
| ГОСТ Р 56939-2024, п. 5.14 | Управление доступом и контроль целостности кода — основной процесс |
| ГОСТ Р 56939-2024, п. 5.14.2 | Требования к процессу управления доступом и контроля целостности кода |
| ГОСТ Р 56939-2024, п. 5.4 | Управление конфигурацией ПО — репозиторий как элемент конфигурации |
| ГОСТ Р 56939-2024, п. 5.13 | Обеспечение безопасности сборочной среды — доступ к коду как часть безопасности среды |
| ГОСТ Р 56939-2024, п. 5.9 | Экспертиза исходного кода — code review как механизм контроля изменений |
| CIS Software Supply Chain Security Guide | Руководство по безопасности цепочки поставок ПО |

### 1.3. Связь с другими документами комплекта РБПО

| Документ РБПО | Связь |
|----------------|-------|
| 03 — Регламент управления конфигурациями | Репозиторий исходного кода — элемент конфигурации, управляемый по процессу 5.4 |
| 08 — Регламент экспертизы кода | Code review через PR/MR — ключевой механизм контроля доступа к защищённым ветвям |
| 11 — Регламент безопасной сборки | Целостность исходного кода — входное условие для целостности сборки (процесс 5.12) |
| 12 — Регламент безопасности сборочной среды | Доступ к коду — часть общей модели доступа к сборочной инфраструктуре (процесс 5.13) |
| 14 — Политика управления секретами | SSH-ключи и access tokens для доступа к VCS — управляются как секреты (процесс 5.15) |

---

## 2. Область применения

### 2.1. Объекты управления доступом

Настоящий Регламент распространяется на:

- **Репозитории исходного кода** — все репозитории продукта, включая основной код, инфраструктуру, тесты, документацию.
- **Артефакты в VCS** — ветки, теги, релизы, CI/CD конфигурация, секреты VCS.
- **Связанные системы** — issue tracker, wiki, package registry (в рамках доступа через VCS).
- **Документация** — если хранится в репозитории вместе с кодом.

### 2.2. Реестр репозиториев

| Репозиторий | Назначение | Классификация | Платформа |
|-------------|-----------|---------------|-----------|
| [ЗАПОЛНИТЬ: основной репозиторий] | Исходный код продукта (backend, frontend) | Критичный | [ЗАПОЛНИТЬ: GitLab / GitHub / Gitea] |
| [ЗАПОЛНИТЬ: infrastructure] | IaC, CI/CD конфигурация, Helm charts | Критичный | [ЗАПОЛНИТЬ] |
| [ЗАПОЛНИТЬ: docs] | Техническая документация | Стандартный | [ЗАПОЛНИТЬ] |
| [ЗАПОЛНИТЬ: дополнительные] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

### 2.3. Классификация репозиториев по уровню критичности

| Уровень | Описание | Требования к доступу |
|---------|----------|---------------------|
| **Критичный** | Репозитории с исходным кодом продукта, security-critical компоненты, IaC, CI/CD | Обязательный code review, branch protection, signed commits, restricted push |
| **Стандартный** | Документация, вспомогательные скрипты, тестовые данные | Code review, branch protection для main |
| **Публичный** | Open source компоненты, публичная документация (при наличии) | Code review, подписание релизов |

---

## 3. Модель управления доступом

### 3.1. Роли и права (RBAC)

> Требование ГОСТ Р 56939-2024, п. 5.14.2 — контролировать доступ на основе ролей.

| Роль | Описание | Назначается кем |
|------|----------|----------------|
| **Owner** | Полный контроль над репозиторием: настройки, доступ, удаление | [ЗАПОЛНИТЬ: руководитель проекта / CTO] |
| **Maintainer** | Управление ветвями, merge в protected branches, управление CI/CD, релизы | [ЗАПОЛНИТЬ: техлид / senior developer] |
| **Developer** | Push в feature/fix ветки, создание PR/MR, запуск CI, просмотр кода | [ЗАПОЛНИТЬ: разработчик команды] |
| **Security Reviewer** | Просмотр кода, code review с фокусом на безопасность, доступ к SAST/SCA отчётам | [ЗАПОЛНИТЬ: инженер по безопасности] |
| **Reporter / Guest** | Только чтение: просмотр кода, issues, CI results. Без возможности push | [ЗАПОЛНИТЬ: аналитики, аудиторы, стажёры] |
| **Bot / Service Account** | Автоматизированные операции: CI/CD, автоматическое обновление зависимостей | [ЗАПОЛНИТЬ: CI/CD система, Dependabot] |

### 3.2. Матрица доступа

| Действие | Owner | Maintainer | Developer | Security Reviewer | Reporter | Bot |
|----------|-------|-----------|-----------|-------------------|----------|-----|
| Просмотр кода (clone, fetch) | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| Push в feature/fix ветки | ✅ | ✅ | ✅ | — | — | ✅ (scoped) |
| Push в protected ветки (main, dev) | ✅ | ✅ (через PR) | — | — | — | — |
| Создание PR/MR | ✅ | ✅ | ✅ | ✅ | — | ✅ (scoped) |
| Code review (approve/reject) | ✅ | ✅ | ✅ | ✅ | — | — |
| Merge PR/MR в protected ветки | ✅ | ✅ | — | — | — | — |
| Создание тегов / релизов | ✅ | ✅ | — | — | — | — |
| Настройка branch protection | ✅ | — | — | — | — | — |
| Управление правами доступа | ✅ | — | — | — | — | — |
| Удаление репозитория | ✅ | — | — | — | — | — |
| Просмотр аудит-журналов | ✅ | ✅ | — | ✅ | — | — |
| Настройка CI/CD переменных | ✅ | ✅ | — | — | — | — |

### 3.3. Принцип минимальных привилегий

| Правило | Описание |
|---------|----------|
| Минимальная роль по умолчанию | Новые участники получают роль Reporter; повышение — по запросу с обоснованием |
| Ограниченные Bot-аккаунты | Service accounts имеют доступ только к необходимым репозиториям и операциям (scoped tokens) |
| Временный доступ | Для внешних подрядчиков и аудиторов — временный доступ с датой истечения |
| Разделение полномочий | Запрещено совмещение: автор PR и единственный reviewer; Developer и Owner одного репозитория |
| Регулярный review | Периодический пересмотр прав доступа (раздел 9.3) |

---

## 4. Правила доступа к репозиториям

### 4.1. Общие правила

| Правило | Описание |
|---------|----------|
| Аутентификация | Доступ к репозиториям только через аутентифицированные соединения (SSH с ключами ED25519 / HTTPS с access token) |
| Запрет анонимного доступа | Анонимный clone/fetch запрещён для всех репозиториев (кроме публичных) |
| MFA | [ЗАПОЛНИТЬ: обязательна для всех пользователей / для Owner и Maintainer] |
| Access tokens | Personal access tokens с минимальным scope и сроком действия ≤ [ЗАПОЛНИТЬ: 90 дней] |
| SSH-ключи | Регистрация SSH-ключей привязана к конкретному пользователю; управление по документу 14 |

### 4.2. Правила по типам операций

| Операция | Правило |
|----------|---------|
| **Clone / Fetch** | Разрешено для всех ролей (Reporter+) по аутентифицированному каналу |
| **Push в feature/fix ветку** | Разрешено для Developer+; имя ветки должно соответствовать конвенции (feature/*, fix/*) |
| **Force push** | [ЗАПОЛНИТЬ: запрещено для всех / разрешено только для Owner в non-protected ветках] |
| **Delete ветку** | Разрешено для автора ветки (Developer+) после merge; для protected — только Owner |
| **Создание PR/MR** | Разрешено для Developer+; PR/MR обязателен для слияния в protected ветки |
| **Merge PR/MR** | Только Maintainer+ при выполнении условий слияния (раздел 5) |
| **Создание тега** | Только Maintainer+ для signed tags; lightweight tags запрещены для releases |
| **Изменение CI/CD config** | Требует review от CODEOWNERS (DevOps / Security) |

### 4.3. Доступ для внешних участников

| Параметр | Значение |
|----------|----------|
| Допустимость | [ЗАПОЛНИТЬ: разрешено с ограничениями / запрещено] |
| Максимальная роль | [ЗАПОЛНИТЬ: Developer (без доступа к protected ветвям и CI/CD переменным)] |
| Срок доступа | [ЗАПОЛНИТЬ: ≤ 90 дней с возможностью продления по запросу] |
| Согласование | [ЗАПОЛНИТЬ: руководитель проекта + Security] |
| Аудит | Все действия внешних участников логируются и ревьюятся [ЗАПОЛНИТЬ: еженедельно] |
| NDA | [ЗАПОЛНИТЬ: обязательно / не требуется] |

---

## 5. Защита ветвей

### 5.1. Правила защиты ветвей (Branch Protection Rules)

> Требование ГОСТ Р 56939-2024, п. 5.14.2 — обеспечить контроль доступа через защищённые ветки и pull requests.

| Правило | main | development | release/* | feature/*, fix/* |
|---------|------|-------------|-----------|-----------------|
| Require pull request | ✅ | ✅ | ✅ | — |
| Minimum approvals | [ЗАПОЛНИТЬ: 2] | [ЗАПОЛНИТЬ: 1] | [ЗАПОЛНИТЬ: 2] | — |
| Require CODEOWNERS review | ✅ | [ЗАПОЛНИТЬ: Да / Нет] | ✅ | — |
| Dismiss stale approvals | ✅ | ✅ | ✅ | — |
| Require status checks | ✅ | ✅ | ✅ | — |
| Required status checks | build, lint, test, SAST, SCA | build, lint, test | build, lint, test, SAST, SCA, DAST | — |
| Require signed commits | [ЗАПОЛНИТЬ: Да / Нет] | [ЗАПОЛНИТЬ: Нет] | [ЗАПОЛНИТЬ: Да] | — |
| Require linear history | [ЗАПОЛНИТЬ: Да / Нет] | [ЗАПОЛНИТЬ: Нет] | [ЗАПОЛНИТЬ: Нет] | — |
| Restrict push | Только через PR | Только через PR | Только через PR | Developer+ |
| Allow force push | ❌ | ❌ | ❌ | [ЗАПОЛНИТЬ: Да / Нет] |
| Allow deletion | ❌ | ❌ | ❌ | ✅ (после merge) |
| Include administrators | ✅ | [ЗАПОЛНИТЬ: Да / Нет] | ✅ | — |

### 5.2. CODEOWNERS

Файл CODEOWNERS определяет обязательных рецензентов для критичных файлов и директорий:

```
# Формат: <path-pattern>  <owners>

# Security-critical paths
[ЗАПОЛНИТЬ: src/auth/*]                    @security-team
[ЗАПОЛНИТЬ: src/crypto/*]                  @security-team
[ЗАПОЛНИТЬ: src/middleware/security/*]     @security-team

# CI/CD and infrastructure
[ЗАПОЛНИТЬ: .gitlab-ci.yml]               @devops-team @security-team
[ЗАПОЛНИТЬ: .github/workflows/*]          @devops-team @security-team
[ЗАПОЛНИТЬ: Dockerfile*]                   @devops-team
[ЗАПОЛНИТЬ: docker-compose*]              @devops-team
[ЗАПОЛНИТЬ: infrastructure/*]             @devops-team @security-team

# Dependency files
[ЗАПОЛНИТЬ: package-lock.json]            @devops-team
[ЗАПОЛНИТЬ: requirements.txt]             @devops-team

# Configuration
[ЗАПОЛНИТЬ: config/security/*]            @security-team
```

### 5.3. Стратегия ветвления

| Ветка | Назначение | Создаётся от | Сливается в | Правила |
|-------|-----------|-------------|-------------|---------|
| `main` | Стабильный релиз | — | — | Protected; merge только из development (через release) |
| `development` | Основная ветка разработки | main | main (при релизе) | Protected; merge через PR |
| `feature/*` | Новая функциональность | development | development | PR с code review |
| `fix/*` | Исправление дефектов | development | development | PR с code review |
| `hotfix/*` | Экстренное исправление | main | main + development | PR с code review (ускоренная процедура) |
| `release/*` | Подготовка релиза | development | main + development | Protected; PR с расширенным review |

---

## 6. Подпись коммитов и тегов

### 6.1. Политика подписания

> Требование ГОСТ Р 56939-2024, п. 5.14.2 — обеспечить целостность кода, в том числе через подпись коммитов.

| Параметр | Значение |
|----------|----------|
| Обязательность подписания коммитов | [ЗАПОЛНИТЬ: обязательно для protected ветвей / рекомендовано для всех / обязательно для всех] |
| Обязательность подписания тегов | [ЗАПОЛНИТЬ: обязательно для release-тегов] |
| Метод подписания | [ЗАПОЛНИТЬ: GPG / SSH signing / Sigstore gitsign] |
| Алгоритм | [ЗАПОЛНИТЬ: RSA-4096 / ED25519 / ECDSA P-256] |
| Верификация подписей | [ЗАПОЛНИТЬ: обязательная проверка при merge в protected / информационная] |

### 6.2. Настройка подписания

**Генерация ключа (GPG):**

```
# Генерация GPG-ключа (рекомендуется ED25519)
gpg --full-generate-key
# Выбрать: (9) ECC (sign and encrypt), Curve 25519

# Или RSA-4096:
gpg --full-generate-key
# Выбрать: (1) RSA and RSA, 4096 bits
```

**Настройка Git:**

```
# Настройка подписания коммитов
git config --global user.signingkey <KEY_ID>
git config --global commit.gpgsign true
git config --global tag.gpgsign true

# Или SSH signing (Git ≥ 2.34):
git config --global gpg.format ssh
git config --global user.signingkey ~/.ssh/id_ed25519.pub
git config --global commit.gpgsign true
```

### 6.3. Регистрация ключей

| Шаг | Действие |
|-----|----------|
| 1 | Сотрудник генерирует ключевую пару локально |
| 2 | Открытый ключ загружается в профиль пользователя на платформе VCS |
| 3 | [ЗАПОЛНИТЬ: открытый ключ также регистрируется в централизованном keyserver / не требуется] |
| 4 | Платформа VCS верифицирует подпись коммитов автоматически (отображает Verified badge) |
| 5 | При увольнении / ротации — ключ отзывается (раздел 9.2) |

### 6.4. Верификация подписей

| Контекст | Действие | Инструмент |
|----------|----------|-----------|
| В CI/CD pipeline | Автоматическая проверка подписи коммитов при PR в protected ветку | [ЗАПОЛНИТЬ: git verify-commit / CI script / платформа VCS] |
| При merge | Платформа VCS отображает статус подписи (Verified / Unverified) | [ЗАПОЛНИТЬ: GitLab / GitHub] |
| При создании release-тега | Обязательная проверка подписи тега | [ЗАПОЛНИТЬ: git verify-tag / CI script] |
| При аудите | Ретроспективная проверка подписей коммитов в определённом диапазоне | `git log --show-signature` |

---

## 7. Контроль целостности кода

### 7.1. Механизмы контроля целостности

> Требование ГОСТ Р 56939-2024, п. 5.14.2 — описать процедуру контроля целостности кода.

| Механизм | Описание | Уровень |
|----------|----------|---------|
| **Git-хеши (SHA-1 / SHA-256)** | Каждый коммит, дерево и blob идентифицируется криптографическим хешем; изменение любого бита приводит к изменению хеша | Встроенный в Git |
| **Подпись коммитов** | GPG/SSH-подпись подтверждает авторство и целостность коммита | Раздел 6 |
| **Подпись тегов** | GPG/SSH-подпись release-тега подтверждает целостность snapshot кода | Раздел 6 |
| **Branch protection** | Запрет force push и direct push в protected ветки предотвращает перезапись истории | Раздел 5 |
| **Code review** | Обязательный review перед merge гарантирует, что изменения прошли проверку авторизованным рецензентом | Документ 08 |
| **CI/CD status checks** | Автоматические проверки (build, test, SAST, SCA) подтверждают корректность кода перед merge | Документ 12 |
| **Audit log** | Журнал всех операций с репозиторием (push, merge, settings change) | Раздел 8 |

### 7.2. Процедура контроля целостности

| Шаг | Действие | Когда | Ответственный |
|-----|----------|-------|---------------|
| 1 | Верификация подписей коммитов в PR | При каждом PR в protected ветку | CI/CD (автоматически) |
| 2 | Проверка соответствия автора коммита и автора PR | При каждом PR | CI/CD (автоматически) |
| 3 | Code review (документ 08) | При каждом PR | Рецензент(ы) |
| 4 | Прохождение всех required status checks | При каждом PR | CI/CD (автоматически) |
| 5 | Верификация подписи release-тега | При создании релиза | CI/CD + Release Manager |
| 6 | Сравнение хеша коммита в теге с хешем в сборке | При release-сборке | CI/CD (автоматически) |
| 7 | Периодический аудит истории коммитов | [ЗАПОЛНИТЬ: ежемесячно] | [ЗАПОЛНИТЬ: Security] |

### 7.3. Обнаружение нарушений целостности

| Индикатор | Действие |
|-----------|----------|
| Коммит без подписи или с невалидной подписью в protected ветке | Блокировка merge; уведомление Security |
| Force push в protected ветку | Блокировка (branch protection); если произошёл — Critical инцидент |
| Несоответствие автора коммита и пользователя VCS | Предупреждение; расследование при повторении |
| Изменение истории (rebase published commits, amend published) | Блокировка в protected ветках; предупреждение для остальных |
| Подозрительная активность (массовые push, необычное время) | Алерт мониторинга; расследование |

---

## 8. Аудит изменений

### 8.1. Регистрируемые события

> Требование ГОСТ Р 56939-2024, п. 5.14.2 — вести аудит изменений.

| Категория | События |
|-----------|---------|
| **Изменения кода** | Push (ветка, коммиты, автор), merge PR/MR, создание/удаление тегов, создание/удаление веток |
| **Code review** | Создание PR/MR, назначение рецензентов, комментарии, approve/reject, merge, close |
| **Управление доступом** | Добавление/удаление участников, изменение ролей, создание/отзыв access tokens, регистрация SSH-ключей |
| **Настройки репозитория** | Изменение branch protection rules, CODEOWNERS, CI/CD конфигурации, webhooks |
| **Секреты VCS** | Создание/изменение/удаление CI/CD переменных (факт изменения, не значение) |
| **Административные** | Создание/удаление репозиториев, трансфер, изменение visibility |

### 8.2. Формат аудит-журнала

| Поле | Описание |
|------|----------|
| `timestamp` | Дата и время события (UTC) |
| `actor` | Пользователь или service account, выполнивший действие |
| `action` | Тип действия (push, merge, settings_change, member_add и др.) |
| `resource` | Объект действия (репозиторий, ветка, PR/MR, пользователь) |
| `details` | Детали: хеши коммитов, имена ветвей, изменённые настройки |
| `source_ip` | IP-адрес источника |
| `result` | Результат (success / denied / error) |

### 8.3. Хранение и доступ

| Параметр | Значение |
|----------|----------|
| Источник журнала | [ЗАПОЛНИТЬ: GitLab Audit Events / GitHub Audit Log / встроенный в VCS] |
| Экспорт | [ЗАПОЛНИТЬ: JSON export в ELK / Loki / S3] |
| Срок хранения | [ЗАПОЛНИТЬ: не менее 3 лет] |
| Защита от модификации | [ЗАПОЛНИТЬ: append-only / WORM storage / подписание] |
| Доступ | [ЗАПОЛНИТЬ: Owner, Security Engineer, аудиторы — read-only] |

### 8.4. Периодический review

| Мероприятие | Периодичность | Ответственный |
|-------------|---------------|---------------|
| Обзор аудит-журнала на аномалии | [ЗАПОЛНИТЬ: еженедельно] | [ЗАПОЛНИТЬ: Security Engineer] |
| Полный аудит прав доступа к репозиториям | [ЗАПОЛНИТЬ: ежеквартально] | [ЗАПОЛНИТЬ: Security + Owner] |
| Проверка актуальности branch protection rules | [ЗАПОЛНИТЬ: ежемесячно] | [ЗАПОЛНИТЬ: Maintainer] |
| Проверка актуальности CODEOWNERS | [ЗАПОЛНИТЬ: при изменении состава команды] | [ЗАПОЛНИТЬ: Maintainer] |
| Ревизия service accounts и их прав | [ЗАПОЛНИТЬ: ежеквартально] | [ЗАПОЛНИТЬ: DevOps + Security] |

---

## 9. Управление учётными записями

### 9.1. Создание учётной записи (Onboarding)

| Шаг | Действие | Ответственный |
|-----|----------|---------------|
| 1 | Руководитель подаёт запрос на предоставление доступа с указанием роли и обоснованием | [ЗАПОЛНИТЬ: руководитель подразделения] |
| 2 | Согласование запроса | [ЗАПОЛНИТЬ: Owner репозитория / Security] |
| 3 | Создание учётной записи на платформе VCS (или привязка к корпоративному SSO/LDAP) | [ЗАПОЛНИТЬ: CI/CD Admin / IT] |
| 4 | Назначение минимально необходимой роли | [ЗАПОЛНИТЬ: Owner репозитория] |
| 5 | Настройка MFA | Сотрудник (обязательно) |
| 6 | Генерация и регистрация SSH-ключа / GPG-ключа | Сотрудник |
| 7 | Ознакомление с настоящим регламентом | Сотрудник (подтверждение) |

### 9.2. Деактивация учётной записи (Offboarding)

| Шаг | Действие | Срок | Ответственный |
|-----|----------|------|---------------|
| 1 | Получение уведомления об увольнении / переводе сотрудника | В день уведомления | [ЗАПОЛНИТЬ: HR / руководитель] |
| 2 | Блокировка учётной записи на платформе VCS | [ЗАПОЛНИТЬ: в день увольнения / в течение 24 часов] | [ЗАПОЛНИТЬ: CI/CD Admin / IT] |
| 3 | Отзыв всех personal access tokens | Одновременно с блокировкой | [ЗАПОЛНИТЬ: CI/CD Admin] |
| 4 | Удаление SSH-ключей из профиля | Одновременно с блокировкой | [ЗАПОЛНИТЬ: CI/CD Admin] |
| 5 | Отзыв GPG-ключа (если использовался) | [ЗАПОЛНИТЬ: в течение 24 часов] | [ЗАПОЛНИТЬ: CI/CD Admin / Security] |
| 6 | Проверка отсутствия незавершённых PR/MR — переназначение или закрытие | [ЗАПОЛНИТЬ: в течение 3 рабочих дней] | [ЗАПОЛНИТЬ: Maintainer] |
| 7 | Проверка отсутствия sole ownership — передача прав | [ЗАПОЛНИТЬ: в течение 3 рабочих дней] | [ЗАПОЛНИТЬ: Owner + Security] |
| 8 | Ротация секретов, к которым имел доступ сотрудник | [ЗАПОЛНИТЬ: по результатам оценки рисков] | [ЗАПОЛНИТЬ: Security] |
| 9 | Запись в журнал offboarding | Одновременно с блокировкой | [ЗАПОЛНИТЬ: CI/CD Admin] |

### 9.3. Ротация credentials

| Тип credential | Максимальный срок действия | Процедура ротации |
|---------------|---------------------------|-------------------|
| Personal access token | [ЗАПОЛНИТЬ: 90 дней] | Автоматическое истечение; создание нового токена; отзыв старого |
| SSH-ключ | [ЗАПОЛНИТЬ: 1 год] | Генерация новой пары; регистрация в VCS; удаление старого |
| GPG-ключ | [ЗАПОЛНИТЬ: 2 года] | Генерация новой пары; публикация; отзыв старого |
| Service account token | [ЗАПОЛНИТЬ: 90 дней / per-pipeline] | Автоматическая ротация через Vault / CI/CD |
| Deploy key | [ЗАПОЛНИТЬ: 180 дней] | Генерация новой пары; замена в CI/CD; удаление старого |

### 9.4. Реестр учётных записей

| Username / Service | Роль | Репозитории | Дата предоставления | Дата последнего review | MFA | Signed commits |
|-------------------|------|-------------|--------------------|-----------------------|-----|---------------|
| [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

---

## 10. История изменений

| Версия | Дата | Описание изменений | Автор |
|--------|------|--------------------|-------|
| 1.0 | [ЗАПОЛНИТЬ: дата] | Первая версия документа | [ЗАПОЛНИТЬ: ФИО] |
