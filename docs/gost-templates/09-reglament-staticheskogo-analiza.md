# Регламент проведения статического анализа исходного кода

| | |
|---|---|
| **Продукт** | [ЗАПОЛНИТЬ: наименование СЗИ] |
| **Версия документа** | 1.0 |
| **Дата** | [ЗАПОЛНИТЬ: дата утверждения] |
| **Статус** | Проект |
| **Утверждено** | [ЗАПОЛНИТЬ: должность, ФИО руководителя] |
| **Процесс ГОСТ Р 56939-2024** | 5.10 — Статический анализ исходного кода |

---

## Содержание

1. [Общие сведения](#1-общие-сведения)
2. [Область применения](#2-область-применения)
3. [Инструменты статического анализа](#3-инструменты-статического-анализа)
4. [Конфигурация инструментов](#4-конфигурация-инструментов)
5. [Порядок проведения статического анализа](#5-порядок-проведения-статического-анализа)
6. [Классификация результатов](#6-классификация-результатов)
7. [Управление ложноположительными срабатываниями](#7-управление-ложноположительными-срабатываниями)
8. [Пересмотр конфигурации](#8-пересмотр-конфигурации)
9. [Метрики и отчётность](#9-метрики-и-отчётность)
10. [Реестр результатов анализа](#10-реестр-результатов-анализа)
11. [История изменений](#11-история-изменений)

---

## 1. Общие сведения

### 1.1. Назначение документа

Настоящий Регламент определяет порядок:

- Выбора и настройки инструментов статического анализа исходного кода (SAST) для продукта [ЗАПОЛНИТЬ: наименование СЗИ].
- Конфигурирования инструментов для каждого используемого языка программирования.
- Проведения регулярного статического анализа на всех этапах жизненного цикла.
- Классификации, триажа и обработки выявленных дефектов.
- Управления ложноположительными срабатываниями.
- Периодического пересмотра параметров конфигурации инструментов.

Регламент разработан в соответствии с требованиями ГОСТ Р 56939-2024, п. 5.10, п. 5.10.2, а также ГОСТ Р 71207-2024 «Защита информации. Статический анализ программного обеспечения. Общие требования».

### 1.2. Нормативные ссылки

| Документ | Описание |
|----------|----------|
| ГОСТ Р 56939-2024, п. 5.10 | Статический анализ исходного кода |
| ГОСТ Р 56939-2024, п. 5.10.2 | Требования к реализации процесса статического анализа |
| ГОСТ Р 71207-2024 | Защита информации. Статический анализ ПО. Общие требования |
| ГОСТ Р 56939-2024, п. 5.8 | Стандарт кодирования (правила и соглашения) |
| ГОСТ Р 56939-2024, п. 5.9 | Экспертиза исходного кода (code review) |
| ГОСТ Р 56939-2024, п. 5.5 | Управление недостатками и запросами на изменение ПО |
| ГОСТ Р 56939-2024, п. 5.3 | Формирование и поддержание требований безопасности |
| CWE (Common Weakness Enumeration) | Классификация программных недостатков |
| OWASP Top 10 | Наиболее критичные категории уязвимостей веб-приложений |
| SEI CERT Coding Standards | Стандарты безопасного кодирования (C, C++, Java) |
| CVSS v3.1/v4.0 | Система оценки критичности уязвимостей |

### 1.3. Связь с другими документами комплекта РБПО

| Документ | Связь |
|----------|-------|
| 02 — Стандарт кодирования | SAST обеспечивает автоматическую проверку соблюдения стандарта кодирования. Правила SAST должны соответствовать утверждённым соглашениям по кодированию (п. 5.8) |
| 04 — Регламент управления недостатками | Дефекты, выявленные при статическом анализе, регистрируются и обрабатываются в соответствии с Регламентом управления недостатками (п. 5.5) |
| 05 — Требования безопасности | SAST верифицирует выполнение требований безопасности на уровне исходного кода (п. 5.3) |
| 08 — Регламент экспертизы кода | Статический анализ дополняет ручную экспертизу кода. SAST выполняется до code review, чтобы ревьюер сосредоточился на логических и архитектурных аспектах (п. 5.9) |
| 10 — Регламент динамического анализа | SAST и DAST обеспечивают комплексное покрытие: SAST выявляет дефекты в исходном коде, DAST — в работающем приложении (п. 5.11) |

---

## 2. Область применения

### 2.1. Анализируемый код

Статический анализ проводится для следующих категорий кода:

- **Весь исходный код** продукта [ЗАПОЛНИТЬ: наименование СЗИ], включая все модули и компоненты.
- **Конфигурационные файлы** — Docker-файлы, Compose-конфигурации, YAML/JSON-конфигурации.
- **Инфраструктура как код (IaC)** — Terraform, Ansible, Helm charts (при наличии).
- **Скрипты сборки и развёртывания** — CI/CD пайплайны, Makefile, shell-скрипты.
- **Тестовый код** — модульные, интеграционные и end-to-end тесты (анализ на предмет качества и безопасности тестов).

### 2.2. Исключения

Из периметра статического анализа исключаются:

| Категория | Обоснование | Условие исключения |
|-----------|-------------|-------------------|
| Сторонние библиотеки и зависимости | Анализируются средствами SCA (п. 5.16) | Только если не модифицированы |
| Автоматически сгенерированный код | Генерируется инструментами (protobuf, OpenAPI) | Исключение оформляется через suppress-файл |
| Файлы миграций БД | Автоматически сгенерированные миграции | Ручные миграции анализируются |
| Минифицированный/обфусцированный код | Анализ источника, а не артефакта | Анализируется исходная версия |

### 2.3. Этапы жизненного цикла

| Этап | Вид анализа | Описание |
|------|-------------|----------|
| Разработка | Локальный анализ | Анализ в IDE и pre-commit hooks |
| Code review | Инкрементальный анализ | Анализ изменённых файлов при создании PR |
| Интеграция | CI/CD анализ | Автоматический анализ при каждом merge в основные ветки |
| Подготовка релиза | Полный анализ | Полное сканирование всей кодовой базы |
| Сопровождение | Периодический анализ | Регулярное полное сканирование с обновлёнными правилами |

---

## 3. Инструменты статического анализа

### 3.1. Реестр инструментов

> Требование ГОСТ Р 56939-2024, п. 5.10.2 и ГОСТ Р 71207-2024 — выбрать и настроить инструменты SAST для каждого используемого языка программирования.

| Инструмент | Версия | Назначение | Поддерживаемые языки | Лицензия | Статус |
|------------|--------|------------|---------------------|----------|--------|
| [ЗАПОЛНИТЬ: например, SonarQube] | [ЗАПОЛНИТЬ] | Комплексный анализ качества и безопасности | [ЗАПОЛНИТЬ: Java, Python, JS/TS, Go, C/C++] | [ЗАПОЛНИТЬ: Community / Enterprise] | [ЗАПОЛНИТЬ: Основной / Дополнительный] |
| [ЗАПОЛНИТЬ: например, PVS-Studio] | [ЗАПОЛНИТЬ] | Глубокий анализ C/C++/C#/Java | [ЗАПОЛНИТЬ: C, C++, C#, Java] | [ЗАПОЛНИТЬ: коммерческая] | [ЗАПОЛНИТЬ] |
| [ЗАПОЛНИТЬ: например, Svace] | [ЗАПОЛНИТЬ] | Анализ безопасности (сертификация ФСТЭК) | [ЗАПОЛНИТЬ: C, C++, Java, C#, Go, Python] | [ЗАПОЛНИТЬ: коммерческая] | [ЗАПОЛНИТЬ] |
| [ЗАПОЛНИТЬ: например, Semgrep] | [ЗАПОЛНИТЬ] | Поиск уязвимостей по паттернам | [ЗАПОЛНИТЬ: Python, JS/TS, Go, Java, Ruby, и др.] | [ЗАПОЛНИТЬ: OSS / Team] | [ЗАПОЛНИТЬ] |
| [ЗАПОЛНИТЬ: например, ESLint + security plugins] | [ЗАПОЛНИТЬ] | Линтинг и безопасность JavaScript/TypeScript | JavaScript, TypeScript | MIT | [ЗАПОЛНИТЬ] |
| [ЗАПОЛНИТЬ: например, Bandit] | [ЗАПОЛНИТЬ] | Анализ безопасности Python-кода | Python | Apache 2.0 | [ЗАПОЛНИТЬ] |

### 3.2. Критерии выбора инструментов

При выборе инструментов статического анализа учитываются следующие критерии:

| Критерий | Описание | Вес |
|----------|----------|-----|
| Поддержка языков | Покрытие всех используемых в проекте языков программирования | Высокий |
| Покрытие CWE | Количество детектируемых классов уязвимостей (CWE Top 25, OWASP Top 10) | Высокий |
| Интеграция с CI/CD | Наличие CLI, API, плагинов для используемой CI/CD системы | Высокий |
| Уровень ложноположительных | Процент ложных срабатываний при стандартной конфигурации | Средний |
| Качество отчётности | Детализация описаний дефектов, наличие CWE-маппинга, рекомендации по исправлению | Средний |
| Инкрементальный анализ | Возможность анализировать только изменённые файлы | Средний |
| Сертификация ФСТЭК | Наличие сертификата ФСТЭК России (для проектов с требованиями сертификации) | [ЗАПОЛНИТЬ: Высокий / Не применимо] |
| Интеграция с IDE | Наличие плагинов для используемых IDE | Низкий |
| Стоимость | Стоимость лицензии относительно функциональности | Низкий |

### 3.3. Совместное использование инструментов

> ГОСТ Р 71207-2024 рекомендует применение нескольких инструментов для повышения полноты анализа.

Стратегия совместного использования:

1. **Основной инструмент** — [ЗАПОЛНИТЬ: SonarQube / Svace] обеспечивает базовое покрытие для всех языков.
2. **Специализированные инструменты** — дополняют основной инструмент для конкретных языков и категорий дефектов:
   - [ЗАПОЛНИТЬ: PVS-Studio] — углублённый анализ [ЗАПОЛНИТЬ: C/C++] кода.
   - [ЗАПОЛНИТЬ: Semgrep] — поиск уязвимостей по пользовательским паттернам.
   - [ЗАПОЛНИТЬ: Bandit / ESLint security] — специализированный анализ безопасности [ЗАПОЛНИТЬ: Python / JS/TS].
3. **Устранение дублирования** — при обнаружении одного и того же дефекта несколькими инструментами регистрируется один тикет со ссылками на все источники.
4. **Приоритет инструмента** — при расхождении severity между инструментами принимается наивысшая оценка.

---

## 4. Конфигурация инструментов

### 4.1. Профили анализа

> Требование ГОСТ Р 56939-2024, п. 5.10.2 — конфигурировать инструменты для каждого используемого языка программирования.

#### Профиль для [ЗАПОЛНИТЬ: Python]

| Параметр | Значение |
|----------|----------|
| Инструмент | [ЗАПОЛНИТЬ: SonarQube + Bandit] |
| Профиль качества | [ЗАПОЛНИТЬ: Sonar way + Security] |
| Набор правил | [ЗАПОЛНИТЬ: все правила severity >= Major] |
| Минимальный уровень severity | [ЗАПОЛНИТЬ: Info] |
| Дополнительные правила | [ЗАПОЛНИТЬ: OWASP Top 10, CWE Top 25] |

#### Профиль для [ЗАПОЛНИТЬ: JavaScript / TypeScript]

| Параметр | Значение |
|----------|----------|
| Инструмент | [ЗАПОЛНИТЬ: SonarQube + ESLint + Semgrep] |
| Профиль качества | [ЗАПОЛНИТЬ: Sonar way + Security] |
| Набор правил | [ЗАПОЛНИТЬ: все правила severity >= Major, eslint-plugin-security] |
| Минимальный уровень severity | [ЗАПОЛНИТЬ: Info] |
| Дополнительные правила | [ЗАПОЛНИТЬ: OWASP Top 10, Node.js security] |

#### Профиль для [ЗАПОЛНИТЬ: C/C++]

| Параметр | Значение |
|----------|----------|
| Инструмент | [ЗАПОЛНИТЬ: Svace / PVS-Studio] |
| Профиль качества | [ЗАПОЛНИТЬ: CERT C / CERT C++ / MISRA C] |
| Набор правил | [ЗАПОЛНИТЬ: все правила severity >= Medium] |
| Минимальный уровень severity | [ЗАПОЛНИТЬ: Low] |
| Дополнительные правила | [ЗАПОЛНИТЬ: Buffer overflow, memory management, integer overflow] |

#### Профиль для [ЗАПОЛНИТЬ: дополнительные языки]

| Параметр | Значение |
|----------|----------|
| Инструмент | [ЗАПОЛНИТЬ] |
| Профиль качества | [ЗАПОЛНИТЬ] |
| Набор правил | [ЗАПОЛНИТЬ] |
| Минимальный уровень severity | [ЗАПОЛНИТЬ] |
| Дополнительные правила | [ЗАПОЛНИТЬ] |

### 4.2. Категории проверок

> Минимальный набор категорий проверок в соответствии с ГОСТ Р 71207-2024 и CWE Top 25.

| CWE ID | Категория | Описание | Severity | Включена |
|--------|-----------|----------|----------|----------|
| CWE-787 | Memory | Запись за пределами буфера (Out-of-bounds Write) | Critical | Да |
| CWE-79 | Injection | Межсайтовый скриптинг (XSS) | High | Да |
| CWE-89 | Injection | SQL-инъекция | Critical | Да |
| CWE-416 | Memory | Использование памяти после освобождения (Use After Free) | Critical | Да |
| CWE-78 | Injection | Внедрение команд ОС (OS Command Injection) | Critical | Да |
| CWE-20 | Validation | Некорректная валидация входных данных | High | Да |
| CWE-125 | Memory | Чтение за пределами буфера (Out-of-bounds Read) | High | Да |
| CWE-22 | Path | Обход каталогов (Path Traversal) | High | Да |
| CWE-352 | Session | Подделка межсайтовых запросов (CSRF) | High | Да |
| CWE-434 | Upload | Загрузка файлов опасного типа | High | Да |
| CWE-862 | AuthZ | Отсутствие авторизации | High | Да |
| CWE-476 | Null | Разыменование нулевого указателя (NULL Pointer Dereference) | Medium | Да |
| CWE-287 | AuthN | Некорректная аутентификация | Critical | Да |
| CWE-190 | Integer | Целочисленное переполнение (Integer Overflow) | High | Да |
| CWE-502 | Deserialization | Десериализация ненадёжных данных | Critical | Да |
| CWE-798 | Credentials | Жёстко закодированные учётные данные | Critical | Да |
| CWE-918 | SSRF | Подделка запросов на стороне сервера (SSRF) | High | Да |
| CWE-306 | AuthN | Отсутствие аутентификации для критической функции | Critical | Да |
| CWE-362 | Concurrency | Состояние гонки (Race Condition) | Medium | Да |
| CWE-400 | Resource | Неконтролируемое потребление ресурсов | Medium | Да |
| CWE-611 | XML | Некорректная обработка XML (XXE) | High | Да |
| CWE-259 | Credentials | Использование жёстко закодированного пароля | Critical | Да |
| CWE-327 | Crypto | Использование ненадёжного криптографического алгоритма | High | Да |
| CWE-532 | Logging | Запись чувствительной информации в лог | Medium | Да |
| CWE-200 | Information | Раскрытие чувствительной информации | Medium | Да |

### 4.3. Управление исключениями

Исключения из правил анализа допускаются в следующих случаях:

1. **Ложноположительное срабатывание** — инструмент ошибочно идентифицирует безопасный код как уязвимый (подробнее см. раздел 7).
2. **Технически необходимый паттерн** — использование конструкции, которая формально нарушает правило, но необходима для реализации функциональности (например, динамическая загрузка модулей).
3. **Сторонний код во внутренних зависимостях** — код, включённый в проект через vendor, но не модифицируемый (временное исключение до замены зависимости).

Формат документирования исключений:

```
// SAST-SUPPRESS: CWE-XXX
// Причина: [описание причины подавления]
// Утвердил: [ФИО, дата]
// Пересмотр: [дата следующего пересмотра]
```

### 4.4. Quality Gates

> Критерии прохождения (Quality Gates) определяют, допустим ли код к включению в основные ветки.

#### Quality Gate для pull request (инкрементальный анализ)

| Критерий | Пороговое значение | Действие при нарушении |
|----------|-------------------|----------------------|
| Новые дефекты Critical severity | 0 | Блокировка merge |
| Новые дефекты High severity | 0 | Блокировка merge |
| Новые дефекты Medium severity | [ЗАПОЛНИТЬ: 0 / ≤ 3] | [ЗАПОЛНИТЬ: Блокировка merge / Предупреждение] |
| Новые дефекты Low severity | [ЗАПОЛНИТЬ: ≤ 5] | Предупреждение |
| Новые уязвимости безопасности | 0 | Блокировка merge |
| Новые code smells | [ЗАПОЛНИТЬ: ≤ 10] | Предупреждение |

#### Quality Gate для релиза (полный анализ)

| Критерий | Пороговое значение | Действие при нарушении |
|----------|-------------------|----------------------|
| Открытые дефекты Critical severity | 0 | Блокировка релиза |
| Открытые дефекты High severity | 0 | Блокировка релиза |
| Открытые дефекты Medium severity | [ЗАПОЛНИТЬ: ≤ 10] | Требуется обоснование и утверждение |
| Общее количество открытых уязвимостей | [ЗАПОЛНИТЬ: 0 Critical/High, ≤ N Medium] | Блокировка релиза при превышении |
| Покрытие кодовой базы анализом | [ЗАПОЛНИТЬ: ≥ 95%] | Блокировка релиза при недостаточном покрытии |
| Все подавления (suppressions) актуальны | Да | Требуется пересмотр |

---

## 5. Порядок проведения статического анализа

### 5.1. Интеграция в CI/CD

> Требование ГОСТ Р 56939-2024, п. 5.10.2 — проводить регулярный статический анализ.

| Событие | Вид анализа | Инструменты | Quality Gate | Время выполнения |
|---------|-------------|-------------|--------------|------------------|
| Создание / обновление pull request | Инкрементальный | [ЗАПОЛНИТЬ: SonarQube, Semgrep] | QG для PR | [ЗАПОЛНИТЬ: ≤ 10 мин] |
| Merge в `development` | Инкрементальный + Security | [ЗАПОЛНИТЬ: SonarQube, Semgrep, Bandit] | QG для PR | [ЗАПОЛНИТЬ: ≤ 15 мин] |
| Merge в `main` | Полный анализ | Все инструменты | QG для релиза | [ЗАПОЛНИТЬ: ≤ 60 мин] |
| Ночная сборка (nightly) | Полный анализ | Все инструменты | Отчёт (не блокирует) | [ЗАПОЛНИТЬ: без ограничений] |
| Подготовка релиза | Полный анализ + ручной триаж | Все инструменты | QG для релиза | [ЗАПОЛНИТЬ: до 1 рабочего дня] |

Конфигурация CI/CD пайплайна:

```
[ЗАПОЛНИТЬ: пример конфигурации CI/CD для вашей системы, например:]

# .gitlab-ci.yml / .github/workflows/sast.yml
sast:
  stage: test
  script:
    - [ЗАПОЛНИТЬ: команды запуска SAST]
  rules:
    - if: $CI_PIPELINE_SOURCE == "merge_request_event"
    - if: $CI_COMMIT_BRANCH == "development"
    - if: $CI_COMMIT_BRANCH == "main"
  artifacts:
    reports:
      sast: gl-sast-report.json
```

### 5.2. Локальный анализ

Разработчики проводят локальный статический анализ до отправки кода в репозиторий:

**Pre-commit hooks:**

| Hook | Инструмент | Назначение |
|------|-----------|------------|
| [ЗАПОЛНИТЬ: pre-commit] | [ЗАПОЛНИТЬ: Semgrep / ESLint / Bandit] | Быстрая проверка изменённых файлов |
| [ЗАПОЛНИТЬ: commit-msg] | [ЗАПОЛНИТЬ: скрипт валидации] | Проверка формата сообщения коммита |

**IDE-плагины:**

| IDE | Плагин | Назначение |
|-----|--------|------------|
| [ЗАПОЛНИТЬ: VS Code] | [ЗАПОЛНИТЬ: SonarLint / Semgrep] | Подсветка дефектов в реальном времени |
| [ЗАПОЛНИТЬ: IntelliJ IDEA] | [ЗАПОЛНИТЬ: SonarLint / PVS-Studio] | Подсветка дефектов в реальном времени |
| [ЗАПОЛНИТЬ: CLion] | [ЗАПОЛНИТЬ: PVS-Studio / Svace] | Анализ C/C++ кода в реальном времени |

Локальный анализ носит рекомендательный характер и не заменяет анализ в CI/CD.

### 5.3. Полный анализ

Полный статический анализ всей кодовой базы проводится:

| Событие | Периодичность | Ответственный |
|---------|---------------|---------------|
| Ночная сборка | Ежедневно (рабочие дни) | CI/CD автоматически |
| Подготовка релиза | Перед каждым релизом | [ЗАПОЛНИТЬ: инженер по безопасности] |
| Обновление инструментов | После обновления версии SAST-инструмента | [ЗАПОЛНИТЬ: DevSecOps-инженер] |
| Обновление набора правил | После добавления новых правил или CWE | [ЗАПОЛНИТЬ: DevSecOps-инженер] |
| Плановый пересмотр | [ЗАПОЛНИТЬ: ежемесячно / ежеквартально] | [ЗАПОЛНИТЬ: инженер по безопасности] |

### 5.4. Триаж результатов

Процедура обработки результатов статического анализа:

```
1. Получение результатов анализа
   │
2. Автоматическая фильтрация
   │  ├── Ранее подавленные (suppress) → Пропустить
   │  └── Новые находки → Далее
   │
3. Первичный триаж
   │  ├── Инструмент присвоил severity → Проверить корректность
   │  ├── CWE-маппинг доступен → Использовать для классификации
   │  └── CWE-маппинг отсутствует → Классифицировать вручную
   │
4. Верификация
   │  ├── Подтверждённый дефект → Создать тикет (см. раздел 5.5)
   │  ├── Ложноположительное → Подавить (см. раздел 7)
   │  └── Требует анализа → Назначить эксперту
   │
5. Назначение исполнителя
   │  ├── Уязвимость (security) → [ЗАПОЛНИТЬ: инженер по безопасности]
   │  ├── Дефект качества → Автор кода / Разработчик
   │  └── Нарушение стандарта → Автор кода
   │
6. Контроль устранения → Регламент управления недостатками (раздел 5.5)
```

Ответственные за триаж:

| Роль | Зона ответственности |
|------|---------------------|
| [ЗАПОЛНИТЬ: DevSecOps-инженер] | Автоматизация SAST, настройка пайплайнов, обновление инструментов |
| [ЗАПОЛНИТЬ: Инженер по безопасности] | Триаж уязвимостей (severity Critical, High), верификация security-находок |
| [ЗАПОЛНИТЬ: Тимлид / Senior-разработчик] | Триаж дефектов качества, распределение задач, контроль устранения |
| Разработчик | Устранение назначенных дефектов, локальный SAST |

### 5.5. Устранение выявленных дефектов

> Требование ГОСТ Р 56939-2024, п. 5.10.2 — устранять выявленные дефекты.

Подтверждённые дефекты регистрируются в системе трекинга в соответствии с Регламентом управления недостатками (документ 04) со следующими обязательными полями:

| Поле | Значение |
|------|----------|
| Источник обнаружения | SAST |
| Инструмент | Наименование и версия инструмента |
| CWE ID | Классификатор обнаруженного дефекта |
| Файл и строка | Точное расположение дефекта в коде |
| Правило | Идентификатор правила SAST-инструмента |
| Severity | Critical / High / Medium / Low / Info |

Сроки устранения определяются в соответствии с SLA Регламента управления недостатками (документ 04, раздел 7).

---

## 6. Классификация результатов

### 6.1. По уровню критичности (Severity)

| Severity | Описание | Примеры | Действие |
|----------|----------|---------|----------|
| **Critical** | Критическая уязвимость, позволяющая удалённую компрометацию без аутентификации | SQL injection (CWE-89), RCE (CWE-78), десериализация (CWE-502), жёстко закодированные credentials (CWE-798) | Немедленное исправление, блокировка merge/релиза |
| **High** | Серьёзная уязвимость или дефект, существенно влияющий на безопасность | XSS (CWE-79), Path Traversal (CWE-22), SSRF (CWE-918), некорректная аутентификация (CWE-287) | Исправление в текущем спринте |
| **Medium** | Умеренный дефект с ограниченным воздействием | Race condition (CWE-362), раскрытие информации (CWE-200), ненадёжная криптография (CWE-327) | Запланировать исправление |
| **Low** | Незначительный дефект с минимальным воздействием | Code smell, избыточная сложность, мелкие нарушения стандарта | Исправить при возможности |
| **Info** | Информационное замечание, рекомендация по улучшению | Стилистические замечания, рекомендации по оптимизации | На усмотрение разработчика |

### 6.2. По типу дефекта

| Тип | Описание | Источник правил | Примеры |
|-----|----------|----------------|---------|
| **Уязвимость (Security)** | Дефект, эксплуатация которого может нарушить безопасность | CWE, OWASP Top 10, CERT | SQL injection, XSS, buffer overflow |
| **Дефект качества (Bug)** | Ошибка, приводящая к некорректному поведению | Правила инструмента, CERT | NullPointerException, утечка ресурсов, деление на ноль |
| **Code Smell** | Код, который работает корректно, но сложен в поддержке | Правила инструмента | Дублирование, высокая цикломатическая сложность |
| **Нарушение стандарта (Convention)** | Отклонение от принятых стандартов кодирования | Стандарт кодирования (документ 02), CERT | Нарушение именования, отсутствие документации |

### 6.3. Маппинг на CWE

Все результаты статического анализа маппируются на классификатор CWE:

| Категория OWASP Top 10 | CWE | Описание | Инструмент обнаружения |
|------------------------|-----|----------|----------------------|
| A01 — Broken Access Control | CWE-862, CWE-863, CWE-22 | Нарушения контроля доступа | [ЗАПОЛНИТЬ: SonarQube, Semgrep] |
| A02 — Cryptographic Failures | CWE-327, CWE-328, CWE-259 | Криптографические ошибки | [ЗАПОЛНИТЬ: SonarQube, Semgrep] |
| A03 — Injection | CWE-79, CWE-89, CWE-78 | Инъекции | [ЗАПОЛНИТЬ: SonarQube, Semgrep, Bandit] |
| A04 — Insecure Design | CWE-209, CWE-256, CWE-501 | Небезопасное проектирование | [ЗАПОЛНИТЬ: Semgrep, ручная экспертиза] |
| A05 — Security Misconfiguration | CWE-16, CWE-611, CWE-1004 | Ошибки конфигурации безопасности | [ЗАПОЛНИТЬ: Semgrep, Checkov] |
| A06 — Vulnerable Components | CWE-1035, CWE-1104 | Уязвимые компоненты (SCA) | Вне скоупа SAST (см. п. 5.16) |
| A07 — Auth Failures | CWE-287, CWE-306, CWE-384 | Ошибки аутентификации | [ЗАПОЛНИТЬ: SonarQube, Semgrep] |
| A08 — Data Integrity Failures | CWE-502, CWE-829 | Нарушения целостности данных | [ЗАПОЛНИТЬ: SonarQube, Semgrep] |
| A09 — Logging Failures | CWE-532, CWE-117, CWE-778 | Ошибки логирования и мониторинга | [ЗАПОЛНИТЬ: Semgrep, Bandit] |
| A10 — SSRF | CWE-918 | Подделка запросов на стороне сервера | [ЗАПОЛНИТЬ: Semgrep, Bandit] |

---

## 7. Управление ложноположительными срабатываниями

### 7.1. Процедура подавления (Suppression)

> ГОСТ Р 71207-2024 требует документировать решения о подавлении результатов и обеспечивать их прослеживаемость.

Подавление ложноположительного срабатывания допускается при одновременном выполнении условий:

1. Дефект верифицирован вручную и подтверждён как ложноположительный.
2. Решение о подавлении документировано (причина, обоснование, дата).
3. Подавление утверждено уполномоченным лицом (см. раздел 7.2).

Способы подавления:

| Способ | Описание | Когда применяется |
|--------|----------|-------------------|
| Inline suppress | Комментарий в коде (`// NOSONAR`, `# nosec`, `// nolint`) | Конкретная строка, ожидается долгосрочное подавление |
| Файл исключений | Конфигурационный файл инструмента (`.semgrepignore`, `sonar-project.properties`) | Целый файл или паттерн файлов |
| Серверная suppress | Через UI инструмента (SonarQube «Won't Fix» / «False Positive») | Разовое подавление конкретного экземпляра |

### 7.2. Роли и полномочия

| Категория дефекта | Кто может подавить | Кто утверждает |
|-------------------|-------------------|----------------|
| Security (уязвимость) — Critical/High | [ЗАПОЛНИТЬ: инженер по безопасности] | [ЗАПОЛНИТЬ: руководитель РБПО] |
| Security (уязвимость) — Medium/Low | [ЗАПОЛНИТЬ: инженер по безопасности] | [ЗАПОЛНИТЬ: тимлид] |
| Bug (дефект качества) | Разработчик (автор кода) | [ЗАПОЛНИТЬ: тимлид] |
| Code Smell / Convention | Разработчик (автор кода) | Не требуется (только документирование) |

### 7.3. Обязательная документация при подавлении

При подавлении каждого срабатывания фиксируется:

| Поле | Описание | Обязательность |
|------|----------|----------------|
| ID находки | Идентификатор в инструменте SAST | Обязательно |
| Правило / CWE | Идентификатор правила и/или CWE | Обязательно |
| Файл и строка | Расположение в коде | Обязательно |
| Причина подавления | Обоснование, почему это ложноположительное | Обязательно |
| Верифицировал | ФИО и дата верификации | Обязательно |
| Утвердил | ФИО и дата утверждения (для security-находок) | Для security |
| Дата пересмотра | Дата следующего пересмотра подавления | Обязательно |
| Тикет | Ссылка на тикет в трекере (при наличии) | Рекомендуется |

### 7.4. Периодический пересмотр подавлений

> Требование ГОСТ Р 56939-2024, п. 5.10.2 — периодически пересматривать параметры конфигурации.

| Мероприятие | Периодичность | Ответственный |
|-------------|---------------|---------------|
| Пересмотр всех подавлений security-находок | [ЗАПОЛНИТЬ: ежеквартально] | [ЗАПОЛНИТЬ: инженер по безопасности] |
| Пересмотр подавлений дефектов качества | [ЗАПОЛНИТЬ: раз в полгода] | [ЗАПОЛНИТЬ: тимлид] |
| Аудит подавлений перед релизом | Перед каждым мажорным релизом | [ЗАПОЛНИТЬ: инженер по безопасности] |
| Пересмотр после обновления правил инструмента | После каждого обновления | [ЗАПОЛНИТЬ: DevSecOps-инженер] |

При пересмотре для каждого подавления принимается решение:

1. **Подтвердить** — подавление остаётся в силе, обновить дату пересмотра.
2. **Отменить** — подавление снимается, дефект возвращается в работу.
3. **Обновить** — изменить обоснование или связанные данные.

---

## 8. Пересмотр конфигурации

> Требование ГОСТ Р 56939-2024, п. 5.10.2 — периодически пересматривать параметры конфигурации инструментов.

### 8.1. Триггеры пересмотра

| Триггер | Описание | Инициатор |
|---------|----------|-----------|
| Добавление нового языка программирования | Необходим выбор и настройка инструмента для нового языка | Архитектор / Тимлид |
| Публикация нового CWE в Top 25 | Проверить покрытие новой уязвимости инструментами | [ЗАПОЛНИТЬ: инженер по безопасности] |
| Обновление OWASP Top 10 | Адаптировать набор правил под обновлённый список | [ЗАПОЛНИТЬ: инженер по безопасности] |
| Выход новой версии инструмента | Оценить новые правила, улучшения, изменения в поведении | [ЗАПОЛНИТЬ: DevSecOps-инженер] |
| Инцидент безопасности | Анализ: мог ли SAST обнаружить уязвимость? Необходимо ли добавить правило? | [ЗАПОЛНИТЬ: инженер по безопасности] |
| Высокий уровень ложноположительных | Пересмотр порогов и правил при FP rate > [ЗАПОЛНИТЬ: 15%] | [ЗАПОЛНИТЬ: DevSecOps-инженер] |
| Плановый пересмотр | Регулярная проверка актуальности конфигурации | [ЗАПОЛНИТЬ: инженер по безопасности] |

### 8.2. Периодичность планового пересмотра

| Объект пересмотра | Периодичность |
|-------------------|---------------|
| Набор правил (rule sets) | [ЗАПОЛНИТЬ: ежеквартально] |
| Профили анализа по языкам | [ЗАПОЛНИТЬ: раз в полгода] |
| Quality Gates (пороговые значения) | [ЗАПОЛНИТЬ: раз в полгода] |
| Реестр инструментов | [ЗАПОЛНИТЬ: ежегодно] |
| Подавления (suppressions) | См. раздел 7.4 |

### 8.3. Процедура обновления правил

```
1. Идентификация необходимости обновления (триггер)
   │
2. Анализ влияния
   │  ├── Какие языки и компоненты затронуты?
   │  ├── Ожидаемое количество новых срабатываний?
   │  └── Влияние на Quality Gates?
   │
3. Подготовка обновления
   │  ├── Обновить конфигурацию в тестовой среде
   │  ├── Запустить полный анализ с новыми правилами
   │  └── Оценить количество и качество новых находок
   │
4. Согласование
   │  ├── Результаты тестирования → [ЗАПОЛНИТЬ: инженер по безопасности]
   │  └── Утверждение → [ЗАПОЛНИТЬ: руководитель РБПО / тимлид]
   │
5. Применение обновления
   │  ├── Обновить конфигурацию в production
   │  ├── Уведомить команду разработки
   │  └── Провести триаж новых находок
   │
6. Документирование
      ├── Обновить раздел 3 (реестр инструментов)
      ├── Обновить раздел 4 (профили и правила)
      └── Записать в историю изменений (раздел 11)
```

---

## 9. Метрики и отчётность

### 9.1. Метрики статического анализа

| Метрика | Описание | Целевое значение |
|---------|----------|------------------|
| **Total Findings** | Общее количество открытых дефектов SAST | Тренд к снижению |
| **New Findings Rate** | Количество новых дефектов за период | [ЗАПОЛНИТЬ: ≤ N в неделю] |
| **Fix Rate** | Процент устранённых дефектов от общего числа за период | [ЗАПОЛНИТЬ: ≥ 80%] |
| **Mean Time to Fix (MTTF)** | Среднее время от обнаружения до устранения дефекта | Critical: [ЗАПОЛНИТЬ: ≤ 24ч], High: [ЗАПОЛНИТЬ: ≤ 5 дн] |
| **False Positive Rate** | Процент ложноположительных от общего числа срабатываний | [ЗАПОЛНИТЬ: ≤ 15%] |
| **Suppression Count** | Количество подавленных срабатываний | Тренд к снижению |
| **Code Coverage (SAST)** | Процент кодовой базы, покрытой статическим анализом | [ЗАПОЛНИТЬ: ≥ 95%] |
| **Quality Gate Pass Rate** | Процент PR, прошедших Quality Gate с первого раза | [ЗАПОЛНИТЬ: ≥ 85%] |
| **Security Debt** | Количество открытых security-дефектов (взвешенное по severity) | [ЗАПОЛНИТЬ: Critical: 0, High: ≤ 3] |
| **Reopened Findings** | Количество дефектов, устранённых некорректно и переоткрытых | [ЗАПОЛНИТЬ: ≤ 5%] |

### 9.2. Отчёты

#### Отчёт по каждому запуску SAST в CI/CD

Формируется автоматически. Содержит:

- Дата и время запуска, ветка, коммит.
- Инструменты и версии.
- Количество находок по severity и типу.
- Список новых находок.
- Статус Quality Gate (Pass / Fail).

#### Сводный отчёт (ежемесячный)

Формируется [ЗАПОЛНИТЬ: DevSecOps-инженером / инженером по безопасности]. Содержит:

- Динамика метрик за период (тренды).
- Топ-10 наиболее частых CWE.
- Статистика по компонентам / модулям.
- Статистика ложноположительных.
- Рекомендации по улучшению конфигурации.

#### Отчёт перед релизом

Формируется перед каждым релизом. Содержит:

- Результаты полного анализа кодовой базы.
- Статус Quality Gate для релиза.
- Перечень всех открытых дефектов с обоснованием (если есть).
- Перечень подавленных срабатываний с обоснованиями.
- Заключение о допустимости релиза.

### 9.3. Отслеживание трендов

Тренды отслеживаются по следующим показателям:

| Показатель | Период | Визуализация |
|------------|--------|-------------|
| Новые находки vs. исправленные | Понедельно | Линейный график |
| Открытые дефекты по severity | Понедельно | Stacked bar chart |
| False positive rate | Помесячно | Линейный график |
| Среднее время исправления (MTTF) | Помесячно | Линейный график |
| Quality Gate pass rate | Помесячно | Линейный график |
| Топ CWE | Поквартально | Горизонтальная гистограмма |

---

## 10. Реестр результатов анализа

### 10.1. Формат реестра

Реестр результатов ведётся в системе [ЗАПОЛНИТЬ: SonarQube / Jira / GitLab] и дополнительно фиксируется в сводной таблице:

| ID | Дата обнаружения | Инструмент | Правило | CWE | Файл | Строка | Severity | Тип | Статус | Исполнитель | Дата устранения | Версия исправления | Примечание |
|----|------------------|-----------|---------|-----|------|--------|----------|-----|--------|-------------|-----------------|-------------------|------------|
| [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

Статусы записей:

| Статус | Описание |
|--------|----------|
| Open | Дефект обнаружен, ожидает триажа или исправления |
| In Progress | Дефект в работе у исполнителя |
| Fixed | Дефект исправлен и проверен |
| Suppressed | Ложноположительное, подавлено с обоснованием |
| Won't Fix | Принято решение не исправлять (с обоснованием и утверждением) |

### 10.2. Хранение отчётов

| Параметр | Значение |
|----------|----------|
| Место хранения отчётов | [ЗАПОЛНИТЬ: SonarQube server / артефакты CI/CD / файловый архив] |
| Срок хранения | [ЗАПОЛНИТЬ: не менее 5 лет / срок действия сертификата + 1 год] |
| Резервное копирование | [ЗАПОЛНИТЬ: периодичность и способ] |
| Доступ | [ЗАПОЛНИТЬ: ограниченный круг лиц — команда разработки, ИБ, аудиторы] |
| Формат экспорта | [ЗАПОЛНИТЬ: JSON (SARIF), PDF, HTML] |

> Требование ГОСТ Р 71207-2024 — обеспечить хранение результатов статического анализа и возможность их воспроизведения.

---

## 11. История изменений

| Версия | Дата | Описание изменений | Автор |
|--------|------|--------------------|-------|
| 1.0 | [ЗАПОЛНИТЬ: дата] | Первая версия документа | [ЗАПОЛНИТЬ: ФИО] |
