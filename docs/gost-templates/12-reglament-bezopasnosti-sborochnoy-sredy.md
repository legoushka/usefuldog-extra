# Регламент безопасности сборочной среды

| | |
|---|---|
| **Продукт** | [ЗАПОЛНИТЬ: наименование СЗИ] |
| **Версия документа** | 1.0 |
| **Дата** | [ЗАПОЛНИТЬ: дата утверждения] |
| **Статус** | Проект |
| **Утверждено** | [ЗАПОЛНИТЬ: должность, ФИО руководителя] |
| **Процесс ГОСТ Р 56939-2024** | 5.13 — Обеспечение безопасности сборочной среды ПО |

---

## Содержание

1. [Общие сведения](#1-общие-сведения)
2. [Область применения](#2-область-применения)
3. [Управление доступом к сборочной среде](#3-управление-доступом-к-сборочной-среде)
4. [Защита CI/CD пайплайна](#4-защита-cicd-пайплайна)
5. [Защита каналов связи](#5-защита-каналов-связи)
6. [Контроль целостности инструментов](#6-контроль-целостности-инструментов)
7. [Изоляция сборочных сред](#7-изоляция-сборочных-сред)
8. [Аудит и мониторинг](#8-аудит-и-мониторинг)
9. [Реагирование на инциденты в сборочной среде](#9-реагирование-на-инциденты-в-сборочной-среде)
10. [История изменений](#10-история-изменений)

---

## 1. Общие сведения

### 1.1. Назначение документа

Настоящий Регламент определяет порядок:

- Управления правами доступа к компонентам сборочной среды (CI/CD серверы, build agents, registry, artifact storage).
- Защиты CI/CD пайплайна от несанкционированных изменений и атак на цепочку поставок.
- Защиты каналов связи между компонентами сборочной инфраструктуры.
- Контроля целостности инструментов разработки и сборки.
- Изоляции сборочных сред для предотвращения влияния между сборками.
- Ведения аудит-журналов и мониторинга событий безопасности в сборочной среде.
- Реагирования на инциденты безопасности в сборочной среде.

Регламент разработан в соответствии с требованиями ГОСТ Р 56939-2024, п. 5.13 (обеспечение безопасности сборочной среды ПО) и п. 5.13.2, которые устанавливают необходимость:

- Определить и контролировать права доступа к сборочной среде.
- Вести аудит-журналы.
- Защитить каналы связи.
- Обеспечить целостность инструментов разработки.
- Защитить CI/CD пайплайн.

### 1.2. Нормативные ссылки

| Документ | Описание |
|----------|----------|
| ГОСТ Р 56939-2024, п. 5.13 | Обеспечение безопасности сборочной среды ПО — основной процесс |
| ГОСТ Р 56939-2024, п. 5.13.2 | Требования к процессу обеспечения безопасности сборочной среды |
| ГОСТ Р 56939-2024, п. 5.12 | Использование безопасной системы сборки ПО — сборка выполняется в защищённой среде |
| ГОСТ Р 56939-2024, п. 5.14 | Управление доступом к коду — контроль доступа к исходному коду |
| ГОСТ Р 56939-2024, п. 5.15 | Обеспечение безопасности секретов — секреты в CI/CD среде |
| ГОСТ Р 56939-2024, п. 5.7 | Моделирование угроз — CI/CD как часть поверхности атаки |
| SLSA (Supply-chain Levels for Software Artifacts) | Фреймворк уровней безопасности цепочки поставок |
| CIS Benchmarks (Docker, Kubernetes, CI/CD) | Базовые конфигурации безопасности |
| OWASP CI/CD Security Top 10 | Перечень наиболее критичных рисков CI/CD |

### 1.3. Связь с другими документами комплекта РБПО

| Документ РБПО | Связь |
|----------------|-------|
| 07 — Модель угроз | CI/CD инфраструктура входит в периметр моделирования угроз; атаки на сборочную среду — часть поверхности атаки |
| 11 — Регламент безопасной сборки | Настоящий документ описывает защиту СРЕДЫ, документ 11 — безопасность самого ПРОЦЕССА сборки |
| 13 — Регламент управления доступом к коду | Доступ к исходному коду — часть общей модели доступа к сборочной среде |
| 14 — Политика управления секретами | Секреты (токены, ключи, credentials), используемые в CI/CD, управляются по политике документа 14 |
| 03 — Регламент управления конфигурациями | Конфигурация сборочной среды (CI/CD pipelines, runner configs) — элемент конфигурации по процессу 5.4 |
| 04 — Регламент управления недостатками | Инциденты безопасности сборочной среды регистрируются как недостатки по процессу 5.5 |

---

## 2. Область применения

### 2.1. Компоненты сборочной среды

Настоящий Регламент распространяется на следующие компоненты:

| Компонент | Описание | Примеры |
|-----------|----------|---------|
| **CI/CD сервер** | Центральный сервер оркестрации сборочных процессов | [ЗАПОЛНИТЬ: GitLab CI / GitHub Actions / Jenkins] |
| **Build agents / Runners** | Вычислительные узлы, выполняющие задачи сборки | [ЗАПОЛНИТЬ: GitLab Runner / GitHub-hosted / self-hosted runners] |
| **Container registry** | Хранилище контейнерных образов | [ЗАПОЛНИТЬ: GitLab Registry / Harbor / Docker Hub] |
| **Artifact storage** | Хранилище бинарных артефактов (пакетов, архивов) | [ЗАПОЛНИТЬ: GitLab Packages / Nexus / Artifactory / S3] |
| **Package registry** | Хранилище пакетов (npm, PyPI, Maven) | [ЗАПОЛНИТЬ: GitLab NPM Registry / Verdaccio / внутренний PyPI] |
| **Secret management** | Система управления секретами для CI/CD | [ЗАПОЛНИТЬ: Vault / GitLab CI Variables / GitHub Secrets] |
| **Source code management** | Система управления исходным кодом | [ЗАПОЛНИТЬ: GitLab / GitHub / Gitea] |
| **Monitoring** | Системы мониторинга и алертинга сборочной среды | [ЗАПОЛНИТЬ: Prometheus + Grafana / ELK / Datadog] |

### 2.2. Сетевая топология сборочной среды

```
┌────────────────────────────────────────────────────────────┐
│                   Защищённый периметр                       │
│                                                             │
│  ┌──────────────┐    ┌──────────────┐    ┌──────────────┐  │
│  │  CI/CD        │    │  Container    │    │  Artifact     │  │
│  │  Server       │◄──►│  Registry     │    │  Storage      │  │
│  └──────┬───────┘    └──────────────┘    └──────────────┘  │
│         │                                                    │
│  ┌──────▼───────┐                         ┌──────────────┐  │
│  │  Build        │                         │  Vault /      │  │
│  │  Agents       │◄───────────────────────►│  Secrets      │  │
│  │  (ephemeral)  │                         │  Manager      │  │
│  └──────────────┘                         └──────────────┘  │
│                                                             │
└──────────────────────────┬─────────────────────────────────┘
                           │ TLS/SSH
                    ┌──────▼──────┐
                    │  Source Code │
                    │  Repository  │
                    └─────────────┘
```

[ЗАПОЛНИТЬ: адаптировать схему под реальную топологию сборочной среды]

---

## 3. Управление доступом к сборочной среде

### 3.1. Модель доступа (RBAC)

| Роль | CI/CD сервер | Build agents | Container registry | Artifact storage | Secrets | Описание |
|------|-------------|-------------|-------------------|-----------------|---------|----------|
| **CI/CD Administrator** | Full access | Full access | Full access | Full access | Manage | Администрирование CI/CD инфраструктуры |
| **DevOps Engineer** | Configure pipelines | Configure runners | Push/Pull | Push/Pull | Read (limited) | Настройка и сопровождение пайплайнов |
| **Developer** | Trigger pipelines | — | Pull | Pull | — | Запуск сборок, просмотр результатов |
| **Security Engineer** | View logs, audit | View logs | View, Scan | View, Scan | Audit | Аудит, мониторинг, security scanning |
| **Service Account (CI)** | Execute pipelines | Execute jobs | Push/Pull | Push/Pull | Read (scoped) | Автоматизированные процессы CI/CD |
| **Release Manager** | Trigger release | — | Promote images | Promote artifacts | — | Управление релизными сборками |
| [ЗАПОЛНИТЬ: дополнительные] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

### 3.2. Аутентификация

| Компонент | Метод аутентификации | MFA | Срок действия сессии |
|-----------|---------------------|-----|---------------------|
| CI/CD сервер (пользователи) | [ЗАПОЛНИТЬ: SSO / LDAP / SAML] | [ЗАПОЛНИТЬ: обязательно] | [ЗАПОЛНИТЬ: 8 часов] |
| CI/CD сервер (API) | [ЗАПОЛНИТЬ: Personal Access Token / OAuth2] | N/A | [ЗАПОЛНИТЬ: ≤ 90 дней TTL] |
| Build agents → CI/CD | [ЗАПОЛНИТЬ: Registration token + TLS client cert] | N/A | [ЗАПОЛНИТЬ: без срока / ротация ежемесячно] |
| CI → Container registry | [ЗАПОЛНИТЬ: short-lived token / OIDC] | N/A | [ЗАПОЛНИТЬ: ≤ 1 час] |
| CI → Artifact storage | [ЗАПОЛНИТЬ: short-lived token / OIDC] | N/A | [ЗАПОЛНИТЬ: ≤ 1 час] |
| CI → Vault / Secrets | [ЗАПОЛНИТЬ: AppRole / JWT / OIDC] | N/A | [ЗАПОЛНИТЬ: per-pipeline TTL] |

### 3.3. Принцип минимальных привилегий

| Правило | Описание |
|---------|----------|
| Scoped tokens | CI/CD токены имеют минимально необходимые права (scope) для конкретного пайплайна / задачи |
| Short-lived credentials | Токены для CI/CD имеют минимальный срок действия (preferably per-pipeline) |
| No shared accounts | Запрещено использование общих учётных записей; каждый сервис и пользователь — отдельный аккаунт |
| Registry access control | Push в production registry разрешён только для release-пайплайнов с утверждённых веток |
| Runner isolation | Runners для production-сборок изолированы от runners для dev/test-сборок |

---

## 4. Защита CI/CD пайплайна

### 4.1. Защита определения пайплайна

| Мера защиты | Описание | Статус |
|-------------|----------|--------|
| Pipeline-as-code | Конфигурация CI/CD хранится в репозитории (не в UI CI/CD сервера) и подлежит code review | [ЗАПОЛНИТЬ: реализовано] |
| Branch protection | Изменения CI/CD конфигурации в защищённых ветках требуют code review и approval | [ЗАПОЛНИТЬ: реализовано] |
| CODEOWNERS | Файлы CI/CD конфигурации имеют обязательных рецензентов (DevOps / Security) | [ЗАПОЛНИТЬ: реализовано / не реализовано] |
| Запрет override | Запрещено переопределение CI/CD переменных и этапов через UI или API без аудита | [ЗАПОЛНИТЬ] |
| Immutable pipeline | После запуска пайплайн использует зафиксированную на момент запуска конфигурацию (не подтягивает изменения) | [ЗАПОЛНИТЬ] |

### 4.2. Инъекция секретов в пайплайн

| Правило | Описание |
|---------|----------|
| No secrets in code | Секреты не хранятся в файлах CI/CD конфигурации и не передаются через аргументы командной строки |
| Masked variables | Все секретные CI/CD переменные помечены как masked (не отображаются в логах) |
| Protected variables | Секретные переменные доступны только для пайплайнов из защищённых веток (protected branches) |
| Vault integration | Секреты извлекаются из Vault / Secret Manager непосредственно перед использованием и не сохраняются на диске runner |
| No secret in artifacts | Артефакты сборки не содержат секретов; CI проверяет это через secret scanning |
| Ephemeral secrets | Секреты, сгенерированные в рамках пайплайна, удаляются после завершения |

> Подробнее об управлении секретами — документ 14 (Политика управления секретами, процесс 5.15).

### 4.3. Approval gates

| Gate | Условие | Кто утверждает |
|------|---------|---------------|
| **Merge gate** | PR/MR в защищённые ветки требует code review approval | [ЗАПОЛНИТЬ: минимум 1–2 рецензента] |
| **Deploy gate** | Развёртывание на staging/production требует ручного подтверждения | [ЗАПОЛНИТЬ: Release Manager / DevOps] |
| **Release gate** | Создание release-тега и публикация артефактов требует утверждения | [ЗАПОЛНИТЬ: Release Manager + Security] |
| **Promotion gate** | Продвижение образа из dev-registry в production-registry | [ЗАПОЛНИТЬ: DevOps + QA] |

### 4.4. Branch protection rules

| Правило | Значение | Ветки |
|---------|----------|-------|
| Require pull request reviews | [ЗАПОЛНИТЬ: минимум 1–2 approvals] | main, development |
| Dismiss stale reviews | [ЗАПОЛНИТЬ: Да] | main, development |
| Require status checks | [ЗАПОЛНИТЬ: build, lint, test, SAST, SCA] | main, development |
| Require signed commits | [ЗАПОЛНИТЬ: Да / Нет] | main |
| Restrict push access | [ЗАПОЛНИТЬ: только через PR, запрет force push] | main, development |
| Require linear history | [ЗАПОЛНИТЬ: Да / Нет] | main |
| Include administrators | [ЗАПОЛНИТЬ: Да — правила распространяются и на администраторов] | main |

### 4.5. Защита от атак на CI/CD

| Вектор атаки (OWASP CI/CD Top 10) | Описание | Мера защиты |
|-------------------------------------|----------|-------------|
| **Insufficient Flow Control** | Возможность пропустить security checks | Обязательные status checks перед merge; immutable pipeline |
| **Inadequate Identity and Access Management** | Избыточные привилегии | RBAC с минимальными привилегиями; scoped tokens |
| **Dependency Chain Abuse** | Вредоносные зависимости | Lock-файлы, SCA в pipeline, pinned versions |
| **Poisoned Pipeline Execution** | Вредоносный код в CI конфигурации из PR | Выполнение CI из базовой ветки (не из PR), ограничение прав fork-пайплайнов |
| **Insufficient PBAC** | Pipeline может обращаться к ресурсам, к которым не должен | Environment-scoped credentials, network segmentation |
| **Insecure System Configuration** | Небезопасная конфигурация CI/CD сервера | CIS Benchmarks, регулярный аудит конфигурации |
| **Insecure Secrets Management** | Утечка секретов из пайплайна | Masked + protected variables, Vault, ephemeral secrets |
| **Improper Artifact Integrity Validation** | Отсутствие проверки целостности артефактов | Подписание и верификация артефактов (документ 11) |

---

## 5. Защита каналов связи

### 5.1. Шифрование каналов

> Требование ГОСТ Р 56939-2024, п. 5.13.2 — защитить каналы связи.

| Канал связи | Протокол | Минимальная версия | Сертификат |
|------------|----------|-------------------|-----------|
| Developer → CI/CD сервер | HTTPS | TLS 1.2+ (рекомендуется TLS 1.3) | [ЗАПОЛНИТЬ: Let's Encrypt / внутренний CA] |
| CI/CD сервер → Build agents | [ЗАПОЛНИТЬ: gRPC over TLS / HTTPS] | TLS 1.2+ | [ЗАПОЛНИТЬ: внутренний CA / mTLS] |
| Build agents → Source code | SSH / HTTPS | SSH с ED25519 ключами / TLS 1.2+ | [ЗАПОЛНИТЬ] |
| Build agents → Container registry | HTTPS | TLS 1.2+ | [ЗАПОЛНИТЬ] |
| Build agents → Artifact storage | HTTPS | TLS 1.2+ | [ЗАПОЛНИТЬ] |
| Build agents → Vault | HTTPS | TLS 1.2+ | [ЗАПОЛНИТЬ] |
| Container registry → Production | HTTPS | TLS 1.2+ | [ЗАПОЛНИТЬ] |

### 5.2. Сетевая сегментация

| Правило | Описание |
|---------|----------|
| Build agents в отдельной сети | Build agents размещены в изолированном сетевом сегменте с контролируемым доступом |
| Whitelist исходящих соединений | Build agents имеют доступ только к разрешённым ресурсам (registry, VCS, Vault, package mirrors) |
| Запрет прямого доступа к production | Build agents не имеют прямого сетевого доступа к production-среде |
| Firewall rules | [ЗАПОЛНИТЬ: правила firewall для сборочной сети] |
| VPN / Private network | [ЗАПОЛНИТЬ: сборочная среда доступна только через VPN / private network / не применимо] |

---

## 6. Контроль целостности инструментов

### 6.1. Верификация инструментов

> Требование ГОСТ Р 56939-2024, п. 5.13.2 — обеспечить целостность инструментов разработки.

| Мера | Описание | Реализация |
|------|----------|-----------|
| **Checksums** | Все устанавливаемые инструменты верифицируются по хеш-суммам (SHA-256) из официальных источников | [ЗАПОЛНИТЬ: реализовано в Dockerfile / provisioning scripts] |
| **Signed packages** | Установка пакетов только из подписанных репозиториев с проверкой GPG-подписи | [ЗАПОЛНИТЬ: apt с GPG-верификацией / dnf с GPG] |
| **Pinned versions** | Все инструменты зафиксированы по конкретной версии (не latest, не stable) | [ЗАПОЛНИТЬ: реализовано] |
| **Immutable base images** | Базовые образы build agents фиксируются по дайджесту (sha256), не по мутабельному тегу | [ЗАПОЛНИТЬ] |
| **Periodic verification** | Периодическая повторная проверка целостности установленных инструментов | [ЗАПОЛНИТЬ: еженедельно / при каждом запуске runner] |

### 6.2. Управление базовыми образами

| Параметр | Значение |
|----------|----------|
| Источник базовых образов | [ЗАПОЛНИТЬ: официальные образы Docker Hub / внутренний registry / custom images] |
| Процедура обновления | Обновление через PR с code review; тестирование на staging (документ 11, раздел 8) |
| Сканирование уязвимостей | [ЗАПОЛНИТЬ: Trivy / Grype — автоматическое сканирование при сборке и по расписанию] |
| Максимальный возраст образа без пересборки | [ЗАПОЛНИТЬ: 30 дней / 90 дней] |
| Хранение | [ЗАПОЛНИТЬ: внутренний registry с контролем доступа] |

### 6.3. Зеркалирование внешних источников

| Внешний источник | Зеркало / Прокси | Контроль целостности |
|-----------------|------------------|---------------------|
| npmjs.com | [ЗАПОЛНИТЬ: Verdaccio / Nexus npm proxy / прямой доступ] | Lock-файл + SCA |
| pypi.org | [ЗАПОЛНИТЬ: Nexus PyPI proxy / devpi / прямой доступ] | Lock-файл + SCA |
| Docker Hub | [ЗАПОЛНИТЬ: Harbor / registry proxy / прямой доступ] | Фиксация по дайджесту |
| [ЗАПОЛНИТЬ: дополнительные] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

---

## 7. Изоляция сборочных сред

### 7.1. Ephemeral runners

| Параметр | Значение |
|----------|----------|
| Тип runners | [ЗАПОЛНИТЬ: ephemeral (одноразовые) / persistent / mixed] |
| Изоляция | [ЗАПОЛНИТЬ: Docker containers / VMs / Kubernetes pods] |
| Очистка после сборки | Полное уничтожение контейнера / VM после завершения задачи; никакие данные не сохраняются между сборками |
| Shared state | Запрещено: runners не имеют общего состояния между сборками (кроме кеша зависимостей) |

### 7.2. Разделение сред

| Среда | Назначение | Runners | Уровень доступа |
|-------|-----------|---------|----------------|
| **Development** | CI-сборки из feature/fix веток | [ЗАПОЛНИТЬ: shared runners] | Доступ ко всем разработчикам |
| **Staging** | Integration-сборки, deployment на staging | [ЗАПОЛНИТЬ: dedicated runners] | Ограниченный доступ |
| **Production / Release** | Release-сборки, deployment на production | [ЗАПОЛНИТЬ: dedicated protected runners] | Доступ только для Release Manager / DevOps |

### 7.3. Кеширование

| Правило | Описание |
|---------|----------|
| Cache scope | Кеш ограничен текущей веткой или общим для проекта (не общий между проектами) |
| Cache content | Кешируются только зависимости (node_modules, .venv, .cache), не исходный код и не артефакты |
| Cache integrity | [ЗАПОЛНИТЬ: верификация хеш-суммы кеша / доверие к CI/CD системе] |
| Cache invalidation | При изменении lock-файлов кеш автоматически пересоздаётся |
| No secrets in cache | Кеш не содержит секретов, токенов, ключей |

---

## 8. Аудит и мониторинг

### 8.1. Аудит-журналы

> Требование ГОСТ Р 56939-2024, п. 5.13.2 — вести аудит-журналы.

**События, регистрируемые в аудит-журнале:**

| Категория | События | Источник |
|-----------|---------|----------|
| **Аутентификация** | Вход/выход пользователя, неудачные попытки входа, создание/отзыв токенов | CI/CD сервер |
| **Авторизация** | Изменение прав доступа, назначение ролей, изменение RBAC | CI/CD сервер |
| **Pipeline** | Запуск/остановка/завершение пайплайна, manual approval, trigger события | CI/CD сервер |
| **Конфигурация** | Изменение CI/CD переменных, runner конфигурации, branch protection rules | CI/CD сервер |
| **Registry** | Push/pull/delete образов и артефактов | Container registry, artifact storage |
| **Секреты** | Доступ к секретам из пайплайна, создание/ротация/удаление секретов | Vault / Secret Manager |
| **Runners** | Регистрация/удаление runners, ошибки выполнения, timeout | CI/CD сервер |
| **Security** | Результаты security scanning (SAST, SCA, secret scanning), blocked pipelines | CI/CD сервер |

### 8.2. Формат и хранение аудит-журналов

| Параметр | Значение |
|----------|----------|
| Формат | [ЗАПОЛНИТЬ: JSON structured logging / syslog / CEF] |
| Обязательные поля | timestamp, event_type, actor (user/service), action, resource, result (success/failure), source_ip |
| Хранение | [ЗАПОЛНИТЬ: ELK / Loki / Splunk / S3] |
| Срок хранения | [ЗАПОЛНИТЬ: не менее 1 года / не менее 3 лет] |
| Защита от модификации | [ЗАПОЛНИТЬ: append-only storage / WORM / подписание журналов] |
| Доступ к журналам | [ЗАПОЛНИТЬ: Security Engineer, CI/CD Administrator, аудиторы — read-only] |

### 8.3. Мониторинг и алертинг

| Метрика / Событие | Тип алерта | Канал уведомления | Ответственный |
|-------------------|-----------|-------------------|---------------|
| Неудачные попытки аутентификации (> [ЗАПОЛНИТЬ: 5] за [ЗАПОЛНИТЬ: 10 мин]) | Critical | [ЗАПОЛНИТЬ: Slack / Email / PagerDuty] | [ЗАПОЛНИТЬ: CI/CD Admin, Security] |
| Изменение CI/CD конфигурации без code review | High | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: Security] |
| Push в protected registry из незащищённой ветки | Critical | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: Security, DevOps] |
| Runner offline / unresponsive | Medium | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: DevOps] |
| Secret scanning alert в пайплайне | Critical | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: Security, автор коммита] |
| Аномальное потребление ресурсов runner | Medium | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: DevOps] |
| Неизвестный IP-адрес обращается к CI/CD серверу | High | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: Security] |
| [ЗАПОЛНИТЬ: дополнительные] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

### 8.4. Периодический аудит

| Проверка | Периодичность | Ответственный |
|----------|---------------|---------------|
| Аудит прав доступа к CI/CD инфраструктуре | [ЗАПОЛНИТЬ: ежеквартально] | [ЗАПОЛНИТЬ: Security + CI/CD Admin] |
| Проверка актуальности branch protection rules | [ЗАПОЛНИТЬ: ежемесячно] | [ЗАПОЛНИТЬ: DevOps] |
| Проверка конфигурации runners (CIS Benchmarks) | [ЗАПОЛНИТЬ: ежеквартально] | [ЗАПОЛНИТЬ: DevOps + Security] |
| Ревизия CI/CD переменных и секретов | [ЗАПОЛНИТЬ: ежемесячно] | [ЗАПОЛНИТЬ: DevOps + Security] |
| Анализ аудит-журналов на аномалии | [ЗАПОЛНИТЬ: еженедельно] | [ЗАПОЛНИТЬ: Security] |
| Сканирование уязвимостей сборочной инфраструктуры | [ЗАПОЛНИТЬ: ежемесячно] | [ЗАПОЛНИТЬ: Security] |

---

## 9. Реагирование на инциденты в сборочной среде

### 9.1. Классификация инцидентов

| Severity | Описание | Примеры | Время реакции |
|----------|----------|---------|---------------|
| **Critical** | Компрометация сборочной среды, утечка секретов, несанкционированный доступ к production | Взлом CI/CD сервера, утечка signing key, вредоносный код в pipeline | [ЗАПОЛНИТЬ: ≤ 1 час] |
| **High** | Нарушение целостности инструментов, несанкционированное изменение конфигурации | Изменение base image без review, обход branch protection | [ЗАПОЛНИТЬ: ≤ 4 часа] |
| **Medium** | Нарушение политики доступа, аномальная активность | Использование отозванного токена, доступ из неизвестной сети | [ЗАПОЛНИТЬ: ≤ 1 рабочий день] |
| **Low** | Нарушение процедуры, предупреждение без подтверждённого воздействия | Устаревший runner, просроченный сертификат | [ЗАПОЛНИТЬ: ≤ 3 рабочих дня] |

### 9.2. Процедура реагирования

| Шаг | Действие | Ответственный |
|-----|----------|---------------|
| 1 | **Обнаружение** — алерт от мониторинга или сообщение от сотрудника | [ЗАПОЛНИТЬ: Security / DevOps / любой сотрудник] |
| 2 | **Изоляция** — приостановка затронутых пайплайнов, отключение скомпрометированных runners, отзыв токенов | [ЗАПОЛНИТЬ: CI/CD Admin + Security] |
| 3 | **Оценка масштаба** — определение затронутых компонентов, проверка артефактов, собранных в период инцидента | [ЗАПОЛНИТЬ: Security + DevOps] |
| 4 | **Устранение** — восстановление из чистой конфигурации, ротация всех потенциально скомпрометированных секретов | [ЗАПОЛНИТЬ: DevOps + Security] |
| 5 | **Верификация** — проверка целостности восстановленной среды, повторная сборка и сравнение артефактов | [ЗАПОЛНИТЬ: DevOps + Security] |
| 6 | **Уведомление** — информирование заинтересованных сторон | [ЗАПОЛНИТЬ: руководитель РБПО, руководство] |
| 7 | **Документирование** — регистрация инцидента, root cause analysis, lessons learned | [ЗАПОЛНИТЬ: Security] |
| 8 | **Корректирующие меры** — обновление конфигурации, усиление защиты, обновление регламента | [ЗАПОЛНИТЬ: DevOps + Security] |

### 9.3. Действия при компрометации signing key

При подозрении на компрометацию ключа подписания артефактов:

1. **Немедленно:** отозвать скомпрометированный ключ.
2. Сгенерировать новый ключ и распространить открытую часть.
3. Определить все артефакты, подписанные скомпрометированным ключом.
4. Пересобрать и переподписать все затронутые release-артефакты.
5. Уведомить потребителей артефактов о необходимости обновления.
6. Провести расследование (как ключ был скомпрометирован).
7. Зарегистрировать инцидент в трекере (документ 04, процесс 5.5).

---

## 10. История изменений

| Версия | Дата | Описание изменений | Автор |
|--------|------|--------------------|-------|
| 1.0 | [ЗАПОЛНИТЬ: дата] | Первая версия документа | [ЗАПОЛНИТЬ: ФИО] |
