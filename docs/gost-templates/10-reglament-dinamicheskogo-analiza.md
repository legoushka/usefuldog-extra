# Регламент динамического анализа кода программы

| | |
|---|---|
| **Продукт** | [ЗАПОЛНИТЬ: наименование СЗИ] |
| **Версия документа** | 1.0 |
| **Дата** | [ЗАПОЛНИТЬ: дата утверждения] |
| **Статус** | Проект |
| **Утверждено** | [ЗАПОЛНИТЬ: должность, ФИО руководителя] |
| **Процесс ГОСТ Р 56939-2024** | 5.11 — Динамический анализ кода программы |

---

## Содержание

1. [Общие сведения](#1-общие-сведения)
2. [Область применения](#2-область-применения)
3. [Виды динамического анализа](#3-виды-динамического-анализа)
4. [Инструменты динамического анализа](#4-инструменты-динамического-анализа)
5. [Конфигурация и среда тестирования](#5-конфигурация-и-среда-тестирования)
6. [Порядок проведения динамического анализа](#6-порядок-проведения-динамического-анализа)
7. [Классификация результатов](#7-классификация-результатов)
8. [Интеграция в CI/CD](#8-интеграция-в-cicd)
9. [Метрики и отчётность](#9-метрики-и-отчётность)
10. [Реестр результатов анализа](#10-реестр-результатов-анализа)
11. [История изменений](#11-история-изменений)

---

## 1. Общие сведения

### 1.1. Назначение документа

Настоящий Регламент определяет порядок:

- Проведения динамического анализа безопасности (DAST) приложения [ЗАПОЛНИТЬ: наименование СЗИ] в работающем состоянии.
- Проведения фаззинг-тестирования для выявления ошибок обработки входных данных и повреждения памяти.
- Анализа поведения программы при выполнении с использованием санитайзеров и профилировщиков.
- Устранения выявленных уязвимостей и дефектов безопасности.

Регламент разработан в соответствии с требованиями ГОСТ Р 56939-2024, п. 5.11 (динамический анализ кода программы) и п. 5.11.2, которые устанавливают необходимость:

- Выбрать и настроить инструменты динамического анализа.
- Проводить фаззинг-тестирование.
- Проводить анализ программы при выполнении.
- Устранять выявленные уязвимости.

Динамический анализ дополняет статический анализ (процесс 5.10) и обеспечивает проверку безопасности в условиях реального выполнения, выявляя классы уязвимостей, недоступных статическим методам.

### 1.2. Нормативные ссылки

| Документ | Описание |
|----------|----------|
| ГОСТ Р 56939-2024, п. 5.11 | Динамический анализ кода программы |
| ГОСТ Р 56939-2024, п. 5.10 | Статический анализ кода программы (дополнение — SAST + DAST) |
| ГОСТ Р 56939-2024, п. 5.19 | Нефункциональное тестирование (пентест, нагрузочное тестирование) |
| ГОСТ Р 56939-2024, п. 5.5 | Управление недостатками и запросами на изменение ПО |
| ГОСТ Р 56939-2024, п. 5.3 | Формирование и поддержание требований безопасности |
| ГОСТ Р 56939-2024, п. 5.7 | Моделирование угроз безопасности |
| OWASP Testing Guide v4 | Руководство по тестированию безопасности веб-приложений |
| OWASP Top 10 (2021) | Перечень наиболее критичных уязвимостей веб-приложений |
| OWASP ZAP | Инструмент динамического анализа безопасности (открытый) |
| CWE (Common Weakness Enumeration) | Классификация программных недостатков |
| CVSS v3.1/v4.0 | Система оценки критичности уязвимостей |

### 1.3. Связь с другими документами комплекта РБПО

| Документ РБПО | Связь |
|----------------|-------|
| 04 — Регламент управления недостатками | Результаты DAST и фаззинга регистрируются как недостатки по процессу 5.5 |
| 05 — Требования безопасности | DAST верифицирует выполнение требований безопасности |
| 07 — Модель угроз | Сценарии DAST формируются на основе актуальной модели угроз |
| 08 — Регламент экспертизы кода | Результаты DAST могут инициировать целевой code review уязвимых участков |
| 09 — Регламент статического анализа | DAST + SAST обеспечивают комплексное покрытие: SAST — по исходному коду, DAST — по работающему приложению |

---

## 2. Область применения

### 2.1. Компоненты, подвергаемые динамическому анализу

Настоящий Регламент распространяется на:

- **Веб-приложения и API** — DAST-сканирование HTTP/HTTPS-интерфейсов, REST/GraphQL API, WebSocket-соединений.
- **Нативные и серверные компоненты** — фаззинг бинарных парсеров, сетевых протоколов, библиотек обработки данных.
- **Криптографические модули** — проверка корректности реализации криптографических операций при выполнении.
- **Компоненты обработки входных данных** — фаззинг форматов (JSON, XML, протобуф, бинарные форматы).
- **Сторонние компоненты (open source)** — при наличии исходного кода или интерфейсов для тестирования.

### 2.2. Среды проведения

| Среда | Допустимость | Ограничения |
|-------|-------------|-------------|
| **Тестовая среда (test)** | Допускается без ограничений | Основная среда для DAST и фаззинга |
| **Staging-среда** | Допускается с согласованием | Максимально приближена к production; DAST-сканирование по расписанию |
| **Продуктивная среда (production)** | **Запрещено** | DAST и фаззинг не проводятся в production из-за риска нарушения работы |
| **Изолированная среда фаззинга** | Допускается без ограничений | Выделенные ресурсы для длительных фаззинг-кампаний |

### 2.3. Этапы жизненного цикла

Динамический анализ проводится на следующих этапах:

- **Разработка** — фаззинг новых парсеров и модулей обработки данных.
- **Тестирование** — полное DAST-сканирование перед передачей на приёмку.
- **Предрелизная проверка** — обязательное DAST-сканирование как условие выпуска.
- **Сопровождение** — регрессионное сканирование при обновлениях.

---

## 3. Виды динамического анализа

### 3.1. DAST (Dynamic Application Security Testing)

DAST — тестирование безопасности работающего приложения методом «чёрного ящика» (black-box). Инструмент взаимодействует с приложением через его внешние интерфейсы (HTTP, API), не имея доступа к исходному коду.

**Возможности:**

- Обнаружение уязвимостей инъекций (SQL, XSS, Command Injection, LDAP Injection).
- Проверка конфигурации безопасности (заголовки, CORS, cookie-атрибуты, TLS).
- Обнаружение проблем аутентификации и авторизации.
- Выявление утечек информации в ответах сервера.

### 3.2. IAST (Interactive Application Security Testing)

IAST — агентный анализ времени выполнения. Инструмент-агент встраивается в среду исполнения (JVM, CLR, runtime) и отслеживает потоки данных во время работы приложения.

**Возможности:**

- Отслеживание taint-потоков от ввода до опасных операций.
- Обнаружение уязвимостей с точным указанием строки исходного кода.
- Минимизация ложных срабатываний за счёт анализа реального поведения.

### 3.3. Фаззинг-тестирование

Фаззинг — автоматизированная подача некорректных, неожиданных или случайных данных на входы программы с целью выявления ошибок обработки.

| Подвид | Описание |
|--------|----------|
| **Мутационный (mutation-based)** | Модификация существующих образцов входных данных (bit flipping, byte insertion/deletion) |
| **Генеративный (generation-based)** | Генерация входных данных на основе грамматики или спецификации формата |
| **С обратной связью по покрытию (coverage-guided)** | Инструментация программы для отслеживания покрытия кода; приоритизация мутаций, увеличивающих покрытие |

### 3.4. Анализ поведения при выполнении

Анализ корректности работы программы с использованием санитайзеров — специальных средств инструментации, встраиваемых при компиляции.

| Санитайзер | Назначение |
|------------|-----------|
| **AddressSanitizer (ASan)** | Обнаружение переполнений буфера, use-after-free, утечек памяти |
| **MemorySanitizer (MSan)** | Обнаружение использования неинициализированной памяти |
| **ThreadSanitizer (TSan)** | Обнаружение гонок данных (data races) в многопоточном коде |
| **UndefinedBehaviorSanitizer (UBSan)** | Обнаружение неопределённого поведения (целочисленные переполнения, разыменование null) |

### 3.5. Сводная таблица видов анализа

| Вид анализа | Описание | Инструменты | Что выявляет | Когда проводится |
|-------------|----------|-------------|-------------|------------------|
| DAST | Black-box сканирование работающего приложения | OWASP ZAP, Burp Suite, Nuclei | Инъекции, XSS, misconfig, auth bypass | Каждый спринт, перед релизом |
| IAST | Агентный анализ runtime | [ЗАПОЛНИТЬ: Contrast, Hdiv] | Taint-потоки, инъекции с точной локализацией | При функциональном тестировании |
| Фаззинг (мутационный) | Мутация входных данных | AFL++, libFuzzer, Honggfuzz | Crash, hang, memory corruption | Непрерывно (CI) и кампании |
| Фаззинг (генеративный) | Генерация по грамматике | Peach, Boofuzz | Ошибки парсинга протоколов | При разработке парсеров |
| Санитайзеры | Инструментация при компиляции | ASan, MSan, TSan, UBSan | Memory bugs, races, UB | При каждом запуске тестов |

---

## 4. Инструменты динамического анализа

### 4.1. Реестр инструментов

| Инструмент | Версия | Назначение | Тип анализа | Лицензия |
|------------|--------|-----------|-------------|----------|
| OWASP ZAP | [ЗАПОЛНИТЬ: ≥ 2.14] | DAST-сканирование веб-приложений и API | DAST | Apache 2.0 |
| Burp Suite Professional | [ЗАПОЛНИТЬ: ≥ 2024.x] | DAST-сканирование, ручное тестирование | DAST | Коммерческая |
| Nuclei | [ЗАПОЛНИТЬ: ≥ 3.x] | Сканирование по шаблонам уязвимостей | DAST | MIT |
| AFL++ | [ЗАПОЛНИТЬ: ≥ 4.x] | Coverage-guided фаззинг бинарных программ | Фаззинг | Apache 2.0 |
| libFuzzer | встроен в LLVM | Coverage-guided фаззинг C/C++ функций | Фаззинг | Apache 2.0 (LLVM) |
| Honggfuzz | [ЗАПОЛНИТЬ: ≥ 2.x] | Coverage-guided фаззинг с поддержкой санитайзеров | Фаззинг | Apache 2.0 |
| Boofuzz | [ЗАПОЛНИТЬ: ≥ 0.4] | Генеративный фаззинг сетевых протоколов | Фаззинг | GPL-2.0 |
| GCC/Clang Sanitizers | GCC ≥ 12 / Clang ≥ 15 | ASan, MSan, TSan, UBSan | Runtime-анализ | GPL / Apache 2.0 |
| [ЗАПОЛНИТЬ: дополнительные] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

### 4.2. Критерии выбора инструментов

При выборе инструментов DAST и фаззинга учитываются следующие критерии:

| Критерий | Описание |
|----------|----------|
| **Покрытие категорий OWASP** | Инструмент должен обнаруживать уязвимости из OWASP Top 10 |
| **Поддержка технологического стека** | Совместимость с языками, фреймворками и протоколами продукта |
| **Интеграция с CI/CD** | Возможность запуска из командной строки, API для автоматизации |
| **Формат отчётов** | Поддержка машиночитаемых форматов (JSON, SARIF, XML) |
| **Настраиваемость** | Возможность конфигурации правил, исключений, политик сканирования |
| **Производительность** | Скорость сканирования/фаззинга, потребление ресурсов |
| **Поддержка аутентификации** | Возможность сканирования аутентифицированных областей приложения |
| **Лицензионная совместимость** | Соответствие политике использования ПО организации |

### 4.3. Совместное использование инструментов

Для достижения максимального покрытия рекомендуется комбинировать:

1. **DAST + SAST** — DAST проверяет приложение «снаружи», SAST — «изнутри» по исходному коду. Совместное использование устраняет слепые зоны каждого подхода.
2. **DAST + фаззинг** — DAST сканирует типовые уязвимости веб-интерфейсов, фаззинг исследует нестандартные входные данные и граничные случаи.
3. **Фаззинг + санитайзеры** — санитайзеры (ASan, MSan, UBSan) превращают скрытые ошибки в детерминированные crash, значительно повышая эффективность фаззинга.

---

## 5. Конфигурация и среда тестирования

### 5.1. Требования к тестовой среде

| Требование | Описание |
|-----------|----------|
| **Изоляция** | Тестовая среда изолирована от production; отсутствует доступ к продуктивным данным и сервисам |
| **Репрезентативность** | Конфигурация среды максимально приближена к production (ОС, runtime, middleware, сетевая топология) |
| **Воспроизводимость** | Среда разворачивается автоматически (IaC, Docker, Kubernetes) для обеспечения повторяемости результатов |
| **Тестовые данные** | Используются синтетические или анонимизированные данные; продуктивные данные запрещены |
| **Мониторинг** | Доступны логи приложения, метрики, трассировки для анализа поведения при сканировании |
| **Ресурсы для фаззинга** | Выделенные CPU-ядра для длительных фаззинг-кампаний; [ЗАПОЛНИТЬ: минимум N ядер, M ГБ RAM] |

### 5.2. Конфигурация DAST-сканера

> Пример конфигурации для OWASP ZAP. Адаптировать под используемый инструмент.

| Параметр | Значение | Обоснование |
|----------|----------|-------------|
| **Режим сканирования** | Standard / Attack | Standard для регулярного сканирования, Attack для предрелизного |
| **Целевой URL** | [ЗАПОЛНИТЬ: https://test.example.com] | Базовый URL тестовой среды |
| **Глубина краулинга (Spider Depth)** | [ЗАПОЛНИТЬ: 5] | Максимальная глубина обхода ссылок |
| **Максимальное число потоков** | [ЗАПОЛНИТЬ: 5] | Ограничение нагрузки на тестовую среду |
| **Таймаут запроса** | [ЗАПОЛНИТЬ: 30 сек] | Предотвращение зависания на медленных эндпоинтах |
| **Аутентификация** | [ЗАПОЛНИТЬ: Form-based / Token / OAuth2] | Тип аутентификации для сканирования защищённых разделов |
| **Контекст аутентификации** | [ЗАПОЛНИТЬ: URL логина, параметры] | Параметры для автоматической аутентификации |
| **Политика сканирования (Scan Policy)** | [ЗАПОЛНИТЬ: Default / Custom] | Набор активных правил сканирования |
| **Исключения из сканирования** | [ЗАПОЛНИТЬ: /logout, /api/health] | URL, исключённые из активного сканирования |
| **Формат отчёта** | JSON, HTML | JSON для CI/CD, HTML для ручного анализа |
| **Пороги алертов** | High: Fail, Medium: Warn, Low: Info | Пороги для принятия решений в CI/CD |

### 5.3. Конфигурация фаззера

> Пример конфигурации для AFL++/libFuzzer. Адаптировать под используемый инструмент.

| Параметр | Значение | Обоснование |
|----------|----------|-------------|
| **Фаззер** | [ЗАПОЛНИТЬ: AFL++ / libFuzzer / Honggfuzz] | Выбранный инструмент фаззинга |
| **Целевая функция (harness)** | [ЗАПОЛНИТЬ: описание или путь к harness] | Точка входа для фаззинга |
| **Начальный корпус (seed corpus)** | [ЗАПОЛНИТЬ: путь к директории с seed-файлами] | Начальные образцы входных данных |
| **Словари (dictionaries)** | [ЗАПОЛНИТЬ: путь к словарям ключевых слов формата] | Ускорение фаззинга за счёт знания структуры формата |
| **Таймаут на один вход (timeout)** | [ЗАПОЛНИТЬ: 1000 мс] | Максимальное время обработки одного входа |
| **Лимит памяти (memory limit)** | [ЗАПОЛНИТЬ: 2048 МБ] | Максимальный объём памяти для обнаружения OOM |
| **Длительность кампании** | [ЗАПОЛНИТЬ: 24 часа / 72 часа / непрерывно] | Продолжительность фаззинг-сессии |
| **Целевое покрытие** | [ЗАПОЛНИТЬ: ≥ 70% edge coverage] | Критерий достаточности фаззинга |
| **Параллельные экземпляры** | [ЗАПОЛНИТЬ: N экземпляров] | Количество параллельных процессов фаззинга |
| **Санитайзеры** | ASan + UBSan (обязательно), MSan (отдельная сборка) | Максимальное обнаружение ошибок |
| **Стратегия мутации** | [ЗАПОЛНИТЬ: default / MOpt / custom] | Стратегия генерации мутаций |

### 5.4. Конфигурация санитайзеров

Флаги компиляции для включения санитайзеров:

**AddressSanitizer (ASan) + UndefinedBehaviorSanitizer (UBSan):**

```
CFLAGS="-fsanitize=address,undefined -fno-sanitize-recover=all -fno-omit-frame-pointer -g -O1"
LDFLAGS="-fsanitize=address,undefined"
```

**MemorySanitizer (MSan):**

```
CFLAGS="-fsanitize=memory -fno-omit-frame-pointer -g -O1"
LDFLAGS="-fsanitize=memory"
```

> MSan несовместим с ASan — требуется отдельная сборка.

**ThreadSanitizer (TSan):**

```
CFLAGS="-fsanitize=thread -fno-omit-frame-pointer -g -O1"
LDFLAGS="-fsanitize=thread"
```

> TSan несовместим с ASan и MSan — требуется отдельная сборка.

**Переменные окружения:**

| Переменная | Значение | Назначение |
|-----------|----------|-----------|
| `ASAN_OPTIONS` | `detect_leaks=1:abort_on_error=1:symbolize=1` | Обнаружение утечек, аварийное завершение при ошибке, символизация стека |
| `UBSAN_OPTIONS` | `print_stacktrace=1:halt_on_error=1` | Вывод стека вызовов, остановка при UB |
| `MSAN_OPTIONS` | `abort_on_error=1:symbolize=1` | Аварийное завершение, символизация |
| `TSAN_OPTIONS` | `second_deadlock_stack=1:abort_on_error=1` | Второй стек при дедлоке, остановка при гонке |

### 5.5. Управление тестовыми данными

| Правило | Описание |
|---------|----------|
| Запрет продуктивных данных | В тестовой среде запрещено использовать реальные персональные данные, ключи, пароли |
| Синтетические данные | Генерируются скриптами или инструментами (Faker, custom generators) |
| Анонимизация | Если необходимы данные, приближённые к реальным — применяется анонимизация/маскирование |
| Seed-корпус для фаззинга | Составляется из валидных образцов формата; хранится в репозитории проекта |
| Crash-файлы | Сохраняются в отдельном каталоге; не содержат продуктивных данных |

---

## 6. Порядок проведения динамического анализа

### 6.1. Планирование

Перед проведением динамического анализа формируется план, включающий:

1. **Область сканирования (scope):**
   - Перечень целевых URL / API-эндпоинтов (для DAST).
   - Перечень целевых модулей / функций (для фаззинга).
   - Перечень исключений с обоснованием.

2. **Сценарии тестирования:**
   - Основаны на модели угроз (документ 07 — Модель угроз).
   - Покрывают требования безопасности (документ 05 — Требования безопасности).
   - Включают проверки из OWASP Top 10.

3. **Ресурсы и сроки:**
   - Назначение ответственных исполнителей.
   - Выделение вычислительных ресурсов для фаззинга.
   - Согласование окон для DAST-сканирования тестовой/staging-среды.

4. **Критерии завершения:**
   - Достигнуто целевое покрытие (DAST: все эндпоинты из scope; фаззинг: целевое edge coverage).
   - Все находки Critical и High — триажированы и зарегистрированы.
   - Отсутствуют crash без проведённого триажа.

### 6.2. DAST-сканирование

Процедура проведения DAST-сканирования:

**Шаг 1. Подготовка**
- Развернуть тестовую среду с актуальной версией приложения.
- Настроить аутентификацию в DAST-сканере (контекст, сессии).
- Загрузить OpenAPI/Swagger-спецификацию (при наличии) для полного покрытия API.

**Шаг 2. Обход (Crawl / Spider)**
- Запустить автоматический обход приложения для обнаружения всех доступных страниц и эндпоинтов.
- Проверить полноту обхода — сравнить обнаруженные URL с картой приложения.
- При необходимости — добавить URL вручную или использовать AJAX Spider.

**Шаг 3. Активное сканирование (Active Scan)**
- Запустить активное сканирование с применением настроенной политики.
- Контролировать ход сканирования: отсутствие ошибок аутентификации, стабильность тестовой среды.

**Шаг 4. Формирование отчёта**
- Экспортировать результаты в JSON (для автоматической обработки) и HTML (для ручного анализа).
- Зафиксировать версию приложения, конфигурацию сканера и дату сканирования.

### 6.3. Фаззинг

Процедура проведения фаззинг-тестирования:

**Шаг 1. Подготовка harness**
- Реализовать или актуализировать фаззинг-обёртку (harness) для целевой функции.
- Harness должен принимать произвольный буфер данных и передавать его в тестируемую функцию.
- Скомпилировать harness с инструментацией фаззера и санитайзерами (ASan + UBSan).

**Шаг 2. Подготовка seed-корпуса**
- Собрать начальные образцы входных данных (валидные файлы, запросы, пакеты).
- Минимизировать корпус: `afl-cmin` / `afl-tmin` (AFL++) или встроенная минимизация (libFuzzer: `-merge=1`).

**Шаг 3. Запуск фаззинг-кампании**
- Запустить фаззер с настроенными параметрами (таймаут, лимит памяти, параллельные экземпляры).
- Контролировать прогресс: рост покрытия, количество crash, скорость выполнения (execs/sec).

**Шаг 4. Триаж crash-файлов**
- Собрать уникальные crash-файлы из директории фаззера.
- Дедуплицировать crash (по стеку вызовов, по типу ошибки).
- Минимизировать crash-файлы: `afl-tmin` или `libFuzzer -minimize_crash=1`.
- Воспроизвести каждый crash вручную для подтверждения.

**Шаг 5. Фиксация результатов**
- Сохранить crash-файлы, стеки вызовов и информацию о покрытии.
- Зарегистрировать подтверждённые уязвимости в трекере (см. раздел 6.6).

### 6.4. Runtime-анализ с санитайзерами

Процедура проведения анализа с санитайзерами:

**Шаг 1. Сборка с санитайзерами**
- Скомпилировать проект с флагами ASan + UBSan (основная сборка).
- При необходимости — подготовить отдельные сборки для MSan и TSan.

**Шаг 2. Прогон тестов**
- Запустить полный набор unit- и integration-тестов на инструментированной сборке.
- Запустить функциональные тест-сценарии.

**Шаг 3. Анализ отчётов**
- Проверить вывод санитайзеров — наличие ошибок (ERROR: AddressSanitizer, runtime error и т.д.).
- Каждая найденная ошибка — потенциальная уязвимость; зарегистрировать в трекере.

### 6.5. Триаж результатов

Все результаты динамического анализа проходят триаж:

| Шаг | Действие | Ответственный |
|-----|----------|---------------|
| 1 | Получить отчёт DAST / crash-файлы / отчёт санитайзера | Инструмент (автоматически) |
| 2 | Исключить ложные срабатывания (false positives) | [ЗАПОЛНИТЬ: инженер по безопасности] |
| 3 | Подтвердить воспроизводимость (для DAST — повторить запрос; для crash — повторить с тем же входом) | [ЗАПОЛНИТЬ: инженер по безопасности] |
| 4 | Классифицировать по severity (см. раздел 7) | [ЗАПОЛНИТЬ: инженер по безопасности] |
| 5 | Назначить CWE-идентификатор | [ЗАПОЛНИТЬ: инженер по безопасности] |
| 6 | Зарегистрировать в трекере как недостаток | [ЗАПОЛНИТЬ: инженер по безопасности] |

### 6.6. Устранение уязвимостей

Выявленные уязвимости устраняются в соответствии с Регламентом управления недостатками (документ 04, процесс 5.5):

1. Зарегистрировать недостаток в трекере с указанием источника «DAST» или «Фаззинг».
2. Назначить severity и priority согласно SLA (документ 04, раздел 7).
3. Разработать исправление в feature-ветке.
4. Провести code review исправления (документ 08).
5. Провести регрессионное DAST-сканирование / повторный фаззинг для подтверждения устранения.
6. Закрыть недостаток после включения исправления в релиз.

### 6.7. Общая схема процесса

```
┌─────────────────────────────────┐
│       1. Планирование           │
│  (scope, сценарии, ресурсы)     │
└────────────┬────────────────────┘
             │
    ┌────────┼────────┬───────────────┐
    │        │        │               │
    ▼        ▼        ▼               ▼
┌───────┐ ┌───────┐ ┌──────────┐ ┌──────────┐
│ DAST  │ │ IAST  │ │ Фаззинг  │ │Санитайз. │
│скан.  │ │агент  │ │кампания  │ │+ тесты   │
└───┬───┘ └───┬───┘ └────┬─────┘ └────┬─────┘
    │         │          │             │
    └─────────┴──────────┴─────────────┘
                    │
                    ▼
          ┌─────────────────┐
          │  3. Триаж        │
          │  (FP, classify)  │
          └────────┬────────┘
                   │
          ┌────────▼────────┐
          │  4. Регистрация  │
          │  недостатков     │
          │  (трекер, 04)    │
          └────────┬────────┘
                   │
          ┌────────▼────────┐
          │  5. Устранение   │
          │  (fix → review   │
          │   → retest)      │
          └────────┬────────┘
                   │
          ┌────────▼────────┐
          │  6. Регрессия    │
          │  (повторный      │
          │   DAST/фаззинг)  │
          └─────────────────┘
```

---

## 7. Классификация результатов

### 7.1. По критичности (Severity)

Результаты классифицируются по критичности с использованием CVSS v3.1/v4.0:

| Severity | CVSS Score | Описание | Пример |
|----------|-----------|----------|--------|
| **Critical** | 9.0–10.0 | Уязвимость позволяет удалённое выполнение кода, полную компрометацию, утечку данных без аутентификации | SQL Injection с полным доступом к БД, RCE через десериализацию |
| **High** | 7.0–8.9 | Серьёзная уязвимость с значительным воздействием на безопасность | Stored XSS с кражей сессий, SSRF с доступом к внутренним сервисам |
| **Medium** | 4.0–6.9 | Умеренная уязвимость с ограниченным воздействием или требующая дополнительных условий | Reflected XSS, CSRF на некритичных операциях |
| **Low** | 0.1–3.9 | Незначительная уязвимость с минимальным воздействием | Раскрытие версии сервера, отсутствие второстепенных заголовков |
| **Info** | 0.0 | Информационное замечание, рекомендация | Информационные cookie без Secure-флага на HTTP |

### 7.2. По типу уязвимости

| Тип | Описание | Источник обнаружения | Примеры CWE |
|-----|----------|---------------------|-------------|
| **Injection** | Внедрение вредоносных данных в интерпретатор | DAST, Фаззинг | CWE-89 (SQLi), CWE-79 (XSS), CWE-78 (OS Command) |
| **Authentication Bypass** | Обход механизмов аутентификации | DAST | CWE-287, CWE-306 |
| **Authorization Bypass** | Несанкционированный доступ к ресурсам | DAST | CWE-862, CWE-863 |
| **Memory Corruption** | Повреждение памяти (переполнение, use-after-free) | Фаззинг, Санитайзеры | CWE-120, CWE-416, CWE-787 |
| **Denial of Service (DoS)** | Отказ в обслуживании (crash, hang, resource exhaustion) | Фаззинг, DAST | CWE-400, CWE-770 |
| **Information Disclosure** | Утечка конфиденциальной информации | DAST | CWE-200, CWE-209 |
| **Configuration** | Ошибки конфигурации безопасности | DAST | CWE-16, CWE-1004 |
| **Cryptographic** | Ошибки криптографии | DAST, Runtime-анализ | CWE-327, CWE-328 |
| **Race Condition** | Гонки данных, TOCTOU | Санитайзеры (TSan) | CWE-362, CWE-367 |
| **Undefined Behavior** | Неопределённое поведение (целочисленные переполнения, null deref) | Санитайзеры (UBSan) | CWE-190, CWE-476 |

### 7.3. Маппинг на OWASP Top 10 (2021)

| OWASP Top 10 | Категория | Обнаруживается через |
|--------------|-----------|---------------------|
| A01:2021 — Broken Access Control | Нарушение контроля доступа | DAST (auth scan) |
| A02:2021 — Cryptographic Failures | Криптографические ошибки | DAST (TLS scan), Runtime |
| A03:2021 — Injection | Инъекции | DAST (active scan), Фаззинг |
| A04:2021 — Insecure Design | Небезопасное проектирование | Модель угроз + DAST |
| A05:2021 — Security Misconfiguration | Ошибки конфигурации | DAST (passive scan) |
| A06:2021 — Vulnerable Components | Уязвимые компоненты | SCA (отдельный процесс 5.16) |
| A07:2021 — Identification and Authentication Failures | Ошибки аутентификации | DAST (auth scan) |
| A08:2021 — Software and Data Integrity Failures | Нарушение целостности | DAST, Runtime |
| A09:2021 — Security Logging and Monitoring Failures | Недостатки логирования | DAST (manual verification) |
| A10:2021 — Server-Side Request Forgery (SSRF) | SSRF | DAST (active scan), Фаззинг |

---

## 8. Интеграция в CI/CD

### 8.1. DAST в CI/CD-пайплайне

| Этап пайплайна | Действие | Условие запуска | Результат |
|----------------|----------|-----------------|-----------|
| **PR / Merge Request** | Быстрое DAST-сканирование (baseline scan) | Каждый PR, затрагивающий API или веб-интерфейс | Warning в PR при наличии находок |
| **Merge в development** | Полное DAST-сканирование (full scan) | Автоматически после merge | Отчёт в артефактах сборки |
| **Staging deploy** | DAST-сканирование staging-среды | Автоматически после деплоя на staging | Блокировка релиза при Critical/High |
| **Релизная ветка** | Предрелизное DAST-сканирование (attack mode) | Перед созданием релизного тега | Обязательное условие выпуска |

**Политика break-build:**

| Severity | Действие в CI/CD |
|----------|-----------------|
| Critical | Pipeline fails — блокировка merge/deploy |
| High | Pipeline fails — блокировка merge/deploy |
| Medium | Pipeline warning — требуется подтверждение ответственного |
| Low | Pipeline passes — информационное уведомление |
| Info | Pipeline passes — только в отчёте |

### 8.2. Фаззинг в CI/CD

| Режим | Описание | Когда запускается | Длительность |
|-------|----------|-------------------|-------------|
| **Регрессионный фаззинг** | Запуск фаззера на существующем корпусе для проверки регрессий | Каждый PR / commit в development | [ЗАПОЛНИТЬ: 5–15 минут] |
| **Непрерывный фаззинг (continuous fuzzing)** | Длительная фаззинг-кампания на выделенных ресурсах | По расписанию (ежедневно / еженедельно) | [ЗАПОЛНИТЬ: 4–24 часа] |
| **Целевой фаззинг** | Фаззинг конкретного модуля после значительных изменений | По запросу / при изменении парсеров | [ЗАПОЛНИТЬ: 24–72 часа] |

**Интеграция с корпусом:**
- Корпус фаззинга хранится в [ЗАПОЛНИТЬ: Git LFS / S3 / выделенное хранилище].
- Новые интересные входные данные, обнаруженные непрерывным фаззингом, добавляются в корпус автоматически.
- Crash-файлы автоматически сохраняются и создаётся тикет в трекере.

### 8.3. Quality gates для динамического анализа

| Gate | Критерий | Где применяется |
|------|----------|----------------|
| **DAST Gate** | Отсутствие находок Critical и High | Перед merge в main, перед релизом |
| **Фаззинг Gate** | Отсутствие crash на регрессионном корпусе | Каждый PR |
| **Санитайзер Gate** | Все тесты проходят без ошибок ASan/UBSan | Каждый PR |
| **Покрытие фаззингом** | Edge coverage ≥ [ЗАПОЛНИТЬ: целевое значение] | Перед релизом |

---

## 9. Метрики и отчётность

### 9.1. Метрики динамического анализа

| Метрика | Описание | Целевое значение |
|---------|----------|------------------|
| **DAST Scan Coverage** | Процент эндпоинтов из scope, покрытых сканированием | ≥ [ЗАПОЛНИТЬ: 95%] |
| **Unique Findings (DAST)** | Количество уникальных находок (после дедупликации) за период | Trend: снижение от релиза к релизу |
| **False Positive Rate** | Доля ложных срабатываний DAST | ≤ [ЗАПОЛНИТЬ: 15%] |
| **Fuzzing Edge Coverage** | Покрытие рёбер графа потока управления при фаззинге | ≥ [ЗАПОЛНИТЬ: 70%] |
| **Fuzzing Exec Speed** | Скорость выполнения фаззера (executions/sec) | [ЗАПОЛНИТЬ: информационно] |
| **Unique Crashes** | Количество уникальных crash (после дедупликации) за кампанию | Trend: снижение |
| **DAST Fix Rate** | Доля устранённых DAST-находок в срок (SLA) | ≥ [ЗАПОЛНИТЬ: 90%] |
| **Sanitizer Pass Rate** | Доля тестов, проходящих без ошибок санитайзеров | 100% |
| **Mean Time to Fix (DAST)** | Среднее время устранения DAST-находки | [ЗАПОЛНИТЬ: дней] |
| **Regression Crash Count** | Количество crash при регрессионном фаззинге | 0 |

### 9.2. Отчёты

| Тип отчёта | Содержание | Периодичность | Получатели |
|------------|-----------|---------------|-----------|
| **Отчёт по DAST-сканированию** | Результаты конкретного сканирования: находки, severity, покрытие, рекомендации | После каждого полного сканирования | [ЗАПОЛНИТЬ: команда разработки, ИБ] |
| **Отчёт по фаззинг-кампании** | Покрытие, crash, длительность, корпус, рекомендации | После каждой кампании | [ЗАПОЛНИТЬ: команда разработки, ИБ] |
| **Сводный отчёт по динамическому анализу** | Агрегированные метрики, тренды, сравнение с предыдущим периодом | [ЗАПОЛНИТЬ: ежемесячно] | [ЗАПОЛНИТЬ: руководитель РБПО, руководство] |
| **Предрелизный отчёт** | Полная картина перед выпуском: открытые находки, покрытие, принятые риски | Перед каждым релизом | [ЗАПОЛНИТЬ: руководитель РБПО, менеджер релиза] |

---

## 10. Реестр результатов анализа

### 10.1. Формат реестра

Все результаты динамического анализа фиксируются в реестре:

| ID | Дата обнаружения | Вид анализа | Инструмент | Компонент | Описание | CWE | Severity | CVSS | Статус | ID тикета | Версия обнаружения | Версия исправления |
|----|-----------------|-------------|-----------|-----------|----------|-----|----------|------|--------|-----------|--------------------|--------------------|
| DAST-001 | [ЗАПОЛНИТЬ] | DAST | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |
| FUZZ-001 | [ЗАПОЛНИТЬ] | Фаззинг | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |
| SAN-001 | [ЗАПОЛНИТЬ] | Санитайзер | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

### 10.2. Хранение отчётов и артефактов

| Артефакт | Место хранения | Срок хранения | Доступ |
|----------|---------------|---------------|--------|
| Отчёты DAST-сканирования (JSON, HTML) | [ЗАПОЛНИТЬ: CI/CD артефакты / файловое хранилище] | [ЗАПОЛНИТЬ: не менее 3 лет] | [ЗАПОЛНИТЬ: ограниченный] |
| Crash-файлы фаззинга | [ЗАПОЛНИТЬ: Git LFS / S3 / файловое хранилище] | [ЗАПОЛНИТЬ: не менее 3 лет] | [ЗАПОЛНИТЬ: ограниченный] |
| Корпус фаззинга (seed corpus) | [ЗАПОЛНИТЬ: репозиторий / S3] | На протяжении жизненного цикла продукта | [ЗАПОЛНИТЬ: команда разработки] |
| Логи санитайзеров | [ЗАПОЛНИТЬ: CI/CD артефакты] | [ЗАПОЛНИТЬ: не менее 1 года] | [ЗАПОЛНИТЬ: команда разработки] |
| Конфигурации инструментов | Репозиторий проекта (IaC) | На протяжении жизненного цикла продукта | Команда разработки |

### 10.3. Требования к архивированию

- Отчёты DAST и crash-файлы сохраняются для каждой релизной версии.
- При сертификации по требованиям ФСТЭК — отчёты предоставляются как свидетельства проведения динамического анализа.
- Срок хранения — [ЗАПОЛНИТЬ: не менее срока действия сертификата + 1 год].

---

## 11. История изменений

| Версия | Дата | Описание изменений | Автор |
|--------|------|--------------------|-------|
| 1.0 | [ЗАПОЛНИТЬ: дата] | Первая версия документа | [ЗАПОЛНИТЬ: ФИО] |
