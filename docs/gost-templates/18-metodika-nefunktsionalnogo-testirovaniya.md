# Методика нефункционального тестирования ПО

| | |
|---|---|
| **Продукт** | [ЗАПОЛНИТЬ: наименование СЗИ] |
| **Версия документа** | 1.0 |
| **Дата** | [ЗАПОЛНИТЬ: дата утверждения] |
| **Статус** | Проект |
| **Утверждено** | [ЗАПОЛНИТЬ: должность, ФИО руководителя] |
| **Процесс ГОСТ Р 56939-2024** | 5.19 — Нефункциональное тестирование ПО |

---

## Содержание

1. [Общие сведения](#1-общие-сведения)
2. [Область применения](#2-область-применения)
3. [Инструменты нефункционального тестирования](#3-инструменты-нефункционального-тестирования)
4. [Тестирование на проникновение](#4-тестирование-на-проникновение)
5. [Фаззинг-тестирование](#5-фаззинг-тестирование)
6. [Нагрузочное тестирование с учётом безопасности](#6-нагрузочное-тестирование-с-учётом-безопасности)
7. [Порядок проведения](#7-порядок-проведения)
8. [Классификация и триаж результатов](#8-классификация-и-триаж-результатов)
9. [Интеграция в CI/CD](#9-интеграция-в-cicd)
10. [Метрики и отчётность](#10-метрики-и-отчётность)
11. [Реестр результатов тестирования](#11-реестр-результатов-тестирования)
12. [История изменений](#12-история-изменений)

---

## 1. Общие сведения

### 1.1. Назначение документа

Настоящая Методика определяет порядок:

- Проведения тестирования на проникновение (penetration testing) по методологии OWASP/PTES с покрытием OWASP Top 10.
- Проведения фаззинг-тестирования (coverage-guided и generation-based) для обнаружения ошибок обработки входных данных, memory corruption, crash-условий.
- Проведения нагрузочного тестирования с акцентом на безопасность: устойчивость к DDoS, деградация под нагрузкой, rate limiting, resource exhaustion.
- Классификации и триажа обнаруженных уязвимостей с использованием CVSS-скоринга.
- Фиксации результатов нефункционального тестирования и управления дефектами.
- Интеграции нефункциональных проверок в CI/CD pipeline.

Методика разработана в соответствии с требованиями ГОСТ Р 56939-2024, п. 5.19 (нефункциональное тестирование ПО) и п. 5.19.2, которые устанавливают необходимость:

- Разработать и утвердить план нефункционального тестирования.
- Провести тестирование на проникновение (OWASP Top 10).
- Провести фаззинг-тестирование.
- Проверить устойчивость к XSS, CSRF, SQL injection, Path traversal и другим типам атак.
- Фиксировать результаты нефункционального тестирования.

### 1.2. Разграничение с документом 10 (DAST, процесс 5.11)

**Важно:** Настоящий документ (процесс 5.19) и документ 10 — Регламент динамического анализа (процесс 5.11) — покрывают разные аспекты безопасности:

| Аспект | Документ 10 — DAST (процесс 5.11) | Документ 18 — Нефункциональное тестирование (процесс 5.19) |
|--------|-----------------------------------|----------------------------------------------------------|
| **Фокус** | Автоматизированный динамический анализ уязвимостей в CI/CD | Структурированная методика пентеста, расширенного фаззинга и нагрузочного тестирования |
| **Тип проверки** | Автоматическое сканирование (OWASP ZAP, Nuclei, DAST scanners) | Ручное + полуавтоматическое тестирование экспертами (пентест); coverage-guided фаззинг; нагрузочное тестирование |
| **Периодичность** | Каждый push / PR (непрерывно в CI/CD) | Плановое (ежеквартально / перед релизом) и внеплановое (при значительных изменениях) |
| **Глубина** | Широкий охват, стандартные сканеры | Глубокий анализ бизнес-логики, ручная эксплуатация, chained vulnerabilities |
| **Дополнение** | DAST обнаруживает типовые уязвимости автоматически | Пентест находит уязвимости бизнес-логики и цепочки атак, которые DAST не обнаруживает |

Оба процесса являются взаимодополняющими: DAST (документ 10) обеспечивает непрерывный автоматический контроль, настоящая методика — глубокий экспертный анализ.

### 1.3. Нормативные ссылки

| Документ | Описание |
|----------|----------|
| ГОСТ Р 56939-2024, п. 5.19 | Нефункциональное тестирование ПО — основной процесс |
| ГОСТ Р 56939-2024, п. 5.19.2 | Требования к процессу нефункционального тестирования |
| ГОСТ Р 56939-2024, п. 5.11 | Динамический анализ кода — автоматизированный DAST (документ 10) |
| ГОСТ Р 56939-2024, п. 5.7 | Моделирование угроз — модель угроз определяет scope пентеста |
| ГОСТ Р 56939-2024, п. 5.5 | Управление недостатками — регистрация обнаруженных уязвимостей |
| OWASP Testing Guide v4.2 | Руководство по тестированию безопасности веб-приложений; методология и чеклисты |
| PTES (Penetration Testing Execution Standard) | Стандарт выполнения тестирования на проникновение: pre-engagement, intelligence gathering, threat modeling, vulnerability analysis, exploitation, post-exploitation, reporting |
| CVSS v3.1 / v4.0 | Common Vulnerability Scoring System — метрика оценки критичности уязвимостей |
| OWASP Top 10 (2021) | Наиболее критические риски безопасности веб-приложений |
| CWE Top 25 | Наиболее опасные уязвимости ПО |
| NIST SP 800-115 | Technical Guide to Information Security Testing and Assessment |

### 1.4. Связь с другими документами комплекта РБПО

| Документ РБПО | Связь |
|----------------|-------|
| 04 — Регламент управления недостатками | Уязвимости, обнаруженные при пентесте, фаззинге и нагрузочном тестировании, регистрируются как недостатки безопасности (процесс 5.5). Severity определяется по CVSS |
| 05 — Требования безопасности | Нефункциональное тестирование верифицирует нефункциональные требования безопасности (устойчивость к атакам, производительность под нагрузкой) |
| 07 — Модель угроз | Модель угроз (процесс 5.7) определяет scope пентеста: актуальные threat actors, attack vectors, assets. Пентест верифицирует эффективность контрмер |
| 10 — Регламент динамического анализа | DAST (процесс 5.11) дополняет пентест: DAST выполняется автоматически в CI/CD, пентест — экспертно и периодически. Результаты DAST учитываются при планировании пентеста (раздел 1.2) |
| 17 — План функционального тестирования | Функциональное (процесс 5.18) и нефункциональное (процесс 5.19) тестирование составляют полный цикл тестирования ПО. Функциональные тесты должны быть пройдены перед началом нефункционального тестирования |
| 19 — Руководство по выпуску релизов | Успешное завершение пентеста и фаззинга (отсутствие Critical/High findings) — обязательный критерий выпуска релиза |

---

## 2. Область применения

### 2.1. Типы нефункционального тестирования

| Тип тестирования | Описание | Процесс ГОСТ | Ответственный |
|------------------|----------|-------------|---------------|
| **Тестирование на проникновение (пентест)** | Имитация действий злоумышленника для обнаружения уязвимостей, недоступных автоматическим сканерам: бизнес-логика, chained vulnerabilities, privilege escalation | 5.19 | Security Engineer / внешний пентестер |
| **Фаззинг-тестирование** | Подача случайных / мутированных входных данных для обнаружения crash-условий, memory corruption, unhandled exceptions | 5.19 (+ 5.11 для автоматического фаззинга) | Security Engineer / разработчик |
| **Нагрузочное тестирование безопасности** | Проверка устойчивости к DDoS-атакам, деградации под нагрузкой, эффективности rate limiting, resource exhaustion | 5.19 | QA / DevOps / Security |

### 2.2. Объекты тестирования

| Объект | Описание | Типы тестирования |
|--------|----------|-------------------|
| [ЗАПОЛНИТЬ: Web-приложение (frontend + API)] | [ЗАПОЛНИТЬ: описание] | Пентест, нагрузочное |
| [ЗАПОЛНИТЬ: REST/GraphQL API] | [ЗАПОЛНИТЬ] | Пентест, фаззинг |
| [ЗАПОЛНИТЬ: Парсеры данных (JSON, XML, SBOM, VEX)] | [ЗАПОЛНИТЬ] | Фаззинг |
| [ЗАПОЛНИТЬ: Модуль аутентификации/авторизации] | [ЗАПОЛНИТЬ] | Пентест |
| [ЗАПОЛНИТЬ: Файловый ввод (upload, import)] | [ЗАПОЛНИТЬ] | Фаззинг, пентест |
| [ЗАПОЛНИТЬ: Инфраструктура (Docker, сеть)] | [ЗАПОЛНИТЬ] | Пентест, нагрузочное |

### 2.3. Тестовые среды

| Среда | Назначение | Ограничения |
|-------|-----------|-------------|
| **Staging (dedicated security)** | Пентест и нагрузочное тестирование в окружении, идентичном production | Изолированная сеть; отдельные тестовые данные; не влияет на production |
| **CI/CD (автоматический фаззинг)** | Автоматический фаззинг в pipeline | Ограничение по времени выполнения (quality gate timeout) |
| **Локальная среда** | Предварительный фаззинг и ручной анализ | Docker-compose; доступ разработчика/security |
| **[ЗАПОЛНИТЬ: Cloud sandbox]** | [ЗАПОЛНИТЬ: нагрузочное тестирование с масштабированием] | [ЗАПОЛНИТЬ] |

### 2.4. Периодичность

| Тип тестирования | Плановое | Внеплановое |
|------------------|----------|-------------|
| **Пентест** | [ЗАПОЛНИТЬ: ежеквартально / перед каждым мажорным релизом] | При значительных изменениях в архитектуре, модулях auth/access control, после инцидента безопасности |
| **Фаззинг** | Непрерывно в CI/CD (OSS-Fuzz / ClusterFuzzLite); глубокий фаззинг — [ЗАПОЛНИТЬ: ежемесячно] | При добавлении новых парсеров, изменении обработки ввода |
| **Нагрузочное** | [ЗАПОЛНИТЬ: перед каждым релизом / ежеквартально] | При изменении инфраструктуры, добавлении новых API endpoints |

---

## 3. Инструменты нефункционального тестирования

### 3.1. Реестр инструментов

> Требование ГОСТ Р 56939-2024, п. 5.19.2 — обеспечить инструментальную поддержку процесса нефункционального тестирования.

| ID | Инструмент | Назначение | Тип тестирования | Версия | Лицензия | Статус |
|----|-----------|-----------|------------------|--------|----------|--------|
| NFT-001 | [ЗАПОЛНИТЬ: Burp Suite Professional] | Ручной и полуавтоматический пентест веб-приложений: proxy, scanner, repeater, intruder | Пентест | [ЗАПОЛНИТЬ] | Commercial | [ЗАПОЛНИТЬ: используется / планируется] |
| NFT-002 | [ЗАПОЛНИТЬ: OWASP ZAP] | Автоматический и ручной DAST, fuzzing HTTP-запросов, API scanning | Пентест, Фаззинг (HTTP) | [ЗАПОЛНИТЬ] | Apache-2.0 | [ЗАПОЛНИТЬ] |
| NFT-003 | [ЗАПОЛНИТЬ: AFL++] | Coverage-guided фаззинг нативного кода (C/C++, Rust) | Фаззинг | [ЗАПОЛНИТЬ] | Apache-2.0 | [ЗАПОЛНИТЬ] |
| NFT-004 | [ЗАПОЛНИТЬ: libFuzzer] | In-process coverage-guided фаззинг (LLVM) | Фаззинг | [ЗАПОЛНИТЬ] | Apache-2.0 (LLVM) | [ЗАПОЛНИТЬ] |
| NFT-005 | [ЗАПОЛНИТЬ: Atheris / Hypothesis] | Фаззинг Python-кода (Atheris — coverage-guided; Hypothesis — property-based) | Фаззинг | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |
| NFT-006 | [ЗАПОЛНИТЬ: k6] | Нагрузочное тестирование HTTP/WebSocket/gRPC с написанием сценариев на JavaScript | Нагрузочное | [ЗАПОЛНИТЬ] | AGPL-3.0 | [ЗАПОЛНИТЬ] |
| NFT-007 | [ЗАПОЛНИТЬ: Locust] | Распределённое нагрузочное тестирование с написанием сценариев на Python | Нагрузочное | [ЗАПОЛНИТЬ] | MIT | [ЗАПОЛНИТЬ] |
| NFT-008 | [ЗАПОЛНИТЬ: Nuclei] | Шаблонный сканер уязвимостей (CVE, misconfigurations, exposures) | Пентест (автоматизация) | [ЗАПОЛНИТЬ] | MIT | [ЗАПОЛНИТЬ] |
| NFT-009 | [ЗАПОЛНИТЬ: sqlmap] | Автоматическое обнаружение и эксплуатация SQL injection | Пентест | [ЗАПОЛНИТЬ] | GPL-2.0 | [ЗАПОЛНИТЬ] |
| NFT-010 | [ЗАПОЛНИТЬ: дополнительные] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

### 3.2. Критерии выбора инструментов

| Критерий | Описание |
|----------|----------|
| **Покрытие типов уязвимостей** | Инструмент должен покрывать уязвимости, релевантные для продукта (OWASP Top 10, CWE Top 25) |
| **Качество результатов** | Минимальный уровень false positives; возможность верификации findings |
| **Интеграция в CI/CD** | Возможность запуска в headless-режиме, машиночитаемый вывод (JSON/SARIF) |
| **Лицензионная совместимость** | Совместимость лицензии с процессами организации |
| **Безопасность инструмента** | Инструмент прошёл оценку по регламенту проверки цепочки поставок (документ 16) |
| **Квалификация команды** | Наличие экспертизы в команде для эффективного использования инструмента |

---

## 4. Тестирование на проникновение

### 4.1. Методология

> Требование ГОСТ Р 56939-2024, п. 5.19.2 — провести тестирование на проникновение (OWASP Top 10); проверить устойчивость к XSS, CSRF, SQL injection, Path traversal и другим типам атак.

Тестирование на проникновение проводится по методологии OWASP Testing Guide и PTES (Penetration Testing Execution Standard):

| Этап PTES | Описание | Результат |
|-----------|----------|-----------|
| **1. Pre-engagement** | Определение scope, Rules of Engagement, ограничения, контакты, сроки | Подписанный документ Rules of Engagement |
| **2. Intelligence Gathering** | Пассивная и активная разведка: технологический стек, API endpoints, доступные интерфейсы, версии ПО | Карта attack surface |
| **3. Threat Modeling** | Определение актуальных threat vectors на основе модели угроз (документ 07) и результатов разведки | Приоритизированный список attack vectors |
| **4. Vulnerability Analysis** | Обнаружение уязвимостей: автоматическое (Burp Scanner, Nuclei) + ручное (анализ бизнес-логики) | Список обнаруженных уязвимостей |
| **5. Exploitation** | Подтверждение уязвимостей: proof-of-concept эксплуатация без деструктивного воздействия | PoC для каждой подтверждённой уязвимости |
| **6. Post-Exploitation** | Оценка воздействия: какие данные / системы доступны после эксплуатации; lateral movement | Карта достижимых ресурсов и данных |
| **7. Reporting** | Детальный отчёт: executive summary, findings по severity, PoC, рекомендации по устранению | Отчёт о пентесте |

### 4.2. Scope и Rules of Engagement

| Параметр | Описание |
|----------|----------|
| **Scope (in-scope)** | [ЗАПОЛНИТЬ: перечень систем, URLs, API endpoints, IP-адресов, входящих в scope пентеста] |
| **Out of scope** | [ЗАПОЛНИТЬ: перечень исключений — production-среда, сторонние сервисы, физическая безопасность] |
| **Подход** | [ЗАПОЛНИТЬ: Black-box / Gray-box / White-box] — рекомендуется Gray-box (доступ к документации, учётным записям разных ролей, но не к исходному коду) |
| **Разрешённые действия** | Сканирование, ручное тестирование, эксплуатация уязвимостей с PoC |
| **Запрещённые действия** | Деструктивные атаки (data deletion, DoS production), social engineering, физический доступ |
| **Контактные лица** | [ЗАПОЛНИТЬ: Security Engineer / техлид — для эскалации и согласования] |
| **Сроки** | [ЗАПОЛНИТЬ: даты начала и окончания пентеста] |
| **Тестовые учётные записи** | [ЗАПОЛНИТЬ: предоставляемые роли — admin, user, viewer] |

### 4.3. Чеклист OWASP Top 10 (2021)

| # | OWASP Top 10 Category | Описание проверки | Инструменты | Статус |
|---|----------------------|-------------------|-------------|--------|
| A01 | **Broken Access Control** | IDOR, privilege escalation (horizontal/vertical), missing function-level access control, CORS misconfiguration, forced browsing | Burp Suite, ручное тестирование | [ЗАПОЛНИТЬ: протестировано / не протестировано] |
| A02 | **Cryptographic Failures** | Передача данных по HTTP, слабые алгоритмы, hardcoded keys, отсутствие encryption at rest | Burp Suite, testssl.sh, ручной анализ | [ЗАПОЛНИТЬ] |
| A03 | **Injection** | SQL injection, NoSQL injection, OS command injection, LDAP injection, XPath injection | sqlmap, Burp Suite, ручное тестирование | [ЗАПОЛНИТЬ] |
| A04 | **Insecure Design** | Недостатки бизнес-логики: обход последовательности действий, race conditions, rate limiting bypass | Ручное тестирование, Burp Intruder | [ЗАПОЛНИТЬ] |
| A05 | **Security Misconfiguration** | Default credentials, unnecessary features enabled, verbose error messages, missing security headers | Nuclei, Burp Suite, ручная проверка | [ЗАПОЛНИТЬ] |
| A06 | **Vulnerable and Outdated Components** | Использование компонентов с известными CVE (покрывается также SCA — документ 15) | Trivy, npm audit, pip-audit | [ЗАПОЛНИТЬ] |
| A07 | **Identification and Authentication Failures** | Brute force, credential stuffing, weak passwords, session fixation, MFA bypass | Burp Intruder, Hydra, ручное тестирование | [ЗАПОЛНИТЬ] |
| A08 | **Software and Data Integrity Failures** | Deserialization attacks, CI/CD pipeline integrity (покрывается также документами 11, 12, 16) | Burp Suite, ручной анализ | [ЗАПОЛНИТЬ] |
| A09 | **Security Logging and Monitoring Failures** | Отсутствие логирования критических событий, утечка данных в логи | Ручная проверка журналов | [ЗАПОЛНИТЬ] |
| A10 | **Server-Side Request Forgery (SSRF)** | SSRF через пользовательский ввод URL, metadata endpoint access (cloud) | Burp Collaborator, ручное тестирование | [ЗАПОЛНИТЬ] |

### 4.4. Дополнительные проверки

| Категория | Проверка | Описание |
|-----------|---------|----------|
| **XSS** | Reflected, Stored, DOM-based XSS | Внедрение JavaScript через все точки ввода; проверка CSP |
| **CSRF** | Cross-Site Request Forgery | Проверка наличия и корректности anti-CSRF tokens; SameSite cookies |
| **Path Traversal** | Directory traversal, LFI, RFI | Попытки чтения файлов за пределами разрешённых директорий |
| **XXE** | XML External Entity injection | Обработка XML с external entities; parameter entities |
| **SSTI** | Server-Side Template Injection | Внедрение шаблонных выражений через пользовательский ввод |
| **WebSocket** | WebSocket-specific attacks | Отсутствие аутентификации, CSWSH, injection через WebSocket messages |
| **API-specific** | Broken Object Level Authorization, mass assignment, rate limiting | Специфичные для REST/GraphQL API уязвимости |
| **[ЗАПОЛНИТЬ: дополнительные]** | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

---

## 5. Фаззинг-тестирование

### 5.1. Связь с процессом 5.11 (DAST)

> Требование ГОСТ Р 56939-2024, п. 5.19.2 — провести фаззинг-тестирование.

Фаззинг-тестирование в рамках настоящей методики (процесс 5.19) дополняет автоматический фаззинг из документа 10 (процесс 5.11):

| Аспект | Документ 10 — DAST фаззинг (5.11) | Документ 18 — глубокий фаззинг (5.19) |
|--------|----------------------------------|--------------------------------------|
| **Scope** | HTTP-запросы к API endpoints | Парсеры, обработчики файлов, библиотечные функции, протоколы |
| **Глубина** | Стандартные мутации HTTP-параметров | Coverage-guided фаззинг с инструментацией кода, custom harnesses |
| **Длительность** | Минуты (CI/CD time box) | Часы — дни (глубокий фаззинг) |
| **Автоматизация** | Полностью автоматический в CI/CD | Полуавтоматический: создание harness вручную, запуск автоматически |

### 5.2. Подходы к фаззингу

| Подход | Описание | Применимость | Инструменты |
|--------|----------|-------------|-------------|
| **Coverage-guided (mutation-based)** | Мутация входных данных с обратной связью по code coverage; инструментация кода определяет новые пути выполнения | Нативный код (C/C++/Rust), Python (Atheris), Go (go-fuzz) | AFL++, libFuzzer, Atheris, go-fuzz |
| **Generation-based (grammar-based)** | Генерация входных данных на основе грамматики или спецификации формата | Структурированные форматы: JSON, XML, Protocol Buffers, CycloneDX SBOM/VEX | Hypothesis (Python), custom generators |
| **Protocol fuzzing** | Фаззинг сетевых протоколов: HTTP, WebSocket, gRPC | Сетевые сервисы, API endpoints | Boofuzz, OWASP ZAP fuzzer |
| **API fuzzing** | Фаззинг REST/GraphQL API на основе OpenAPI/GraphQL schema | API endpoints с описанной schema | RESTler, Schemathesis, OWASP ZAP |

### 5.3. Цели фаззинга

| ID | Цель (target) | Описание | Подход | Harness | Статус |
|----|--------------|----------|--------|---------|--------|
| FUZZ-TGT-001 | [ЗАПОЛНИТЬ: JSON-парсер API] | Обработка произвольного JSON-ввода API endpoints | Generation-based | [ЗАПОЛНИТЬ: Schemathesis + OpenAPI schema] | [ЗАПОЛНИТЬ] |
| FUZZ-TGT-002 | [ЗАПОЛНИТЬ: CycloneDX SBOM парсер] | Обработка произвольных SBOM-документов (JSON) | Generation-based | [ЗАПОЛНИТЬ: Hypothesis + Pydantic model] | [ЗАПОЛНИТЬ] |
| FUZZ-TGT-003 | [ЗАПОЛНИТЬ: VEX парсер] | Обработка произвольных VEX-документов (JSON) | Generation-based | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |
| FUZZ-TGT-004 | [ЗАПОЛНИТЬ: File upload handler] | Обработка произвольных файлов через upload endpoint | Mutation-based | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |
| FUZZ-TGT-005 | [ЗАПОЛНИТЬ: дополнительные цели] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

### 5.4. Создание fuzz harness

| Шаг | Описание | Ответственный |
|-----|----------|---------------|
| 1 | Определить target-функцию (parser, handler, validator) | Security / разработчик |
| 2 | Написать harness: обёртку, принимающую произвольный byte-массив и вызывающую target | Разработчик |
| 3 | Подготовить seed corpus — набор валидных входных данных для начального обучения | Разработчик / QA |
| 4 | Настроить словарь (dictionary) — специфичные для формата токены | Разработчик |
| 5 | Запустить фаззинг локально, убедиться в стабильности harness | Security / разработчик |
| 6 | Интегрировать harness в CI/CD (OSS-Fuzz / ClusterFuzzLite / custom) | DevOps / Security |

### 5.5. Критерии достаточности фаззинга

| Критерий | Описание | Целевое значение |
|----------|----------|-----------------|
| **Edge coverage** | Процент рёбер (edges) графа потока управления, покрытых фаззером | [ЗАПОЛНИТЬ: ≥ 70%] |
| **Время выполнения** | Суммарное время фаззинга для каждого target | [ЗАПОЛНИТЬ: ≥ 24 часа для глубокого фаззинга; ≥ 10 мин в CI/CD] |
| **Число итераций** | Количество выполненных тестовых случаев | [ЗАПОЛНИТЬ: ≥ 1M итераций для CI/CD; ≥ 100M для глубокого фаззинга] |
| **Plateau detection** | Фаззер не обнаруживает новые пути выполнения в течение заданного времени | [ЗАПОЛНИТЬ: plateau > 2 часов → достаточно] |
| **Crash count** | Количество уникальных crashes, обнаруженных и зафиксированных | Все crashes протриажены и зарегистрированы |

---

## 6. Нагрузочное тестирование с учётом безопасности

### 6.1. Цели нагрузочного тестирования

> Требование ГОСТ Р 56939-2024, п. 5.19.2 — проверить устойчивость ПО к типовым атакам, включая denial-of-service.

| Цель | Описание |
|------|----------|
| **DDoS-устойчивость** | Проверка способности системы противостоять распределённым атакам на отказ в обслуживании или корректно деградировать |
| **Деградация под нагрузкой** | Анализ поведения механизмов безопасности (auth, access control, logging) при высокой нагрузке — не должны отключаться или обходиться |
| **Rate limiting** | Проверка эффективности ограничения частоты запросов для защиты от brute force, credential stuffing, API abuse |
| **Resource exhaustion** | Проверка устойчивости к атакам на исчерпание ресурсов: memory, CPU, disk, connections, file descriptors |
| **Slowloris / slow HTTP** | Проверка устойчивости к атакам с медленными HTTP-соединениями |

### 6.2. Сценарии нагрузочного тестирования

| ID | Сценарий | Описание | Параметры нагрузки | Ожидаемый результат |
|----|---------|----------|-------------------|-------------------|
| LOAD-001 | Нормальная нагрузка | Типичный рабочий день: [ЗАПОЛНИТЬ: N] одновременных пользователей | [ЗАПОЛНИТЬ: VU, RPS, ramp-up] | Все функции работают, latency в пределах SLA |
| LOAD-002 | Пиковая нагрузка | Пиковые часы: [ЗАПОЛНИТЬ: 3×N] одновременных пользователей | [ЗАПОЛНИТЬ] | Система стабильна, degradation graceful |
| LOAD-003 | Стресс-тест | Нагрузка сверх пиковой: [ЗАПОЛНИТЬ: 10×N] | [ЗАПОЛНИТЬ] | Механизмы безопасности не отключаются; система восстанавливается |
| LOAD-004 | Rate limiting test | Последовательные запросы к аутентификации сверх лимита | [ЗАПОЛНИТЬ: RPS > rate limit] | Rate limiter активируется; HTTP 429; лимит не обходится |
| LOAD-005 | Brute force resistance | Массовые попытки аутентификации с разных IP | [ЗАПОЛНИТЬ] | Account lockout работает; IP rate limiting работает |
| LOAD-006 | Slow HTTP attack | Slowloris — множество медленных HTTP-соединений | [ЗАПОЛНИТЬ: N медленных соединений] | Сервер продолжает обслуживать легитимных пользователей; timeout для медленных соединений |
| LOAD-007 | Large payload | Загрузка файлов / запросы с аномально большим body | [ЗАПОЛНИТЬ: file size > limit] | Запрос отклонён; сервер стабилен; OOM не возникает |
| LOAD-008 | [ЗАПОЛНИТЬ: дополнительные сценарии] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

### 6.3. Проверка механизмов безопасности под нагрузкой

| Механизм безопасности | Проверка | Критерий успеха |
|----------------------|---------|-----------------|
| **Аутентификация** | Механизм аутентификации работает корректно при пиковой нагрузке; нет race conditions | Нет обхода аутентификации; нет false positive/negative |
| **Авторизация** | Проверки доступа не обходятся при высокой нагрузке | Нет privilege escalation при concurrent requests |
| **Rate limiting** | Rate limiter не обходится при burst-нагрузке; не блокирует легитимных пользователей при нормальной нагрузке | Корректное ограничение при превышении лимита |
| **Журналирование** | Логи записываются полностью при высокой нагрузке; нет потери событий безопасности | 100% событий безопасности зафиксированы в журнале |
| **Сессии** | Управление сессиями корректно при множестве одновременных пользователей; нет session confusion | Нет cross-session data leakage |
| **Криптография** | Криптографические операции не degradeируют до небезопасных при нагрузке | Используются только утверждённые алгоритмы |

---

## 7. Порядок проведения

### 7.1. Общий порядок

> Требование ГОСТ Р 56939-2024, п. 5.19.2 — фиксировать результаты нефункционального тестирования.

| Этап | Описание | Входные данные | Выходные данные | Ответственный |
|------|----------|---------------|----------------|---------------|
| **1. Планирование** | Определение scope, выбор типов тестирования, подготовка среды, согласование Rules of Engagement (для пентеста) | Модель угроз (doc 07), требования (doc 05), результаты DAST (doc 10), результаты функциональных тестов (doc 17) | План тестирования, Rules of Engagement, подготовленные среды | Security / техлид |
| **2. Проведение** | Выполнение тестирования по методикам разделов 4, 5, 6 | Подготовленные среды, инструменты, тестовые данные | Сырые результаты: findings, crashes, метрики нагрузки | Security / QA |
| **3. Фиксация** | Документирование каждого finding: описание, PoC, severity (CVSS), скриншоты, логи | Сырые результаты | Заполненный реестр (раздел 11) |  Security |
| **4. Триаж** | Классификация по severity (раздел 8), определение приоритета устранения, связь с doc 04 | Заполненный реестр | Приоритизированный backlog дефектов безопасности | Security / техлид |
| **5. Устранение** | Исправление обнаруженных уязвимостей разработчиками | Приоритизированные дефекты | Исправленный код, закрытые дефекты | Разработчик |
| **6. Ретест** | Повторная проверка исправленных уязвимостей | Исправленный код, PoC из findings | Подтверждение устранения или повторное открытие | Security |
| **7. Отчётность** | Формирование итогового отчёта о нефункциональном тестировании | Реестр результатов, метрики | Отчёт о нефункциональном тестировании | Security / QA |

### 7.2. Prerequisite: функциональные тесты

Перед началом нефункционального тестирования должны быть выполнены следующие условия:

| Условие | Описание | Документ |
|---------|----------|----------|
| Функциональные тесты пройдены | Все P0/P1 функциональные тесты пройдены успешно | Документ 17 (раздел 9) |
| Критические дефекты исправлены | Нет открытых Critical/High функциональных дефектов | Документ 04 |
| Тестовая среда подготовлена | Staging-среда развёрнута и соответствует production | Документ 11, 12 |
| Rules of Engagement согласованы (для пентеста) | Scope, ограничения и контактные лица определены | Раздел 4.2 настоящего документа |

---

## 8. Классификация и триаж результатов

### 8.1. Severity mapping (CVSS)

> Требование ГОСТ Р 56939-2024, п. 5.19.2 — классифицировать результаты нефункционального тестирования.

| Severity | CVSS v3.1 Score | Описание | Примеры |
|----------|----------------|----------|---------|
| **Critical** | 9.0–10.0 | Уязвимость позволяет полную компрометацию системы без аутентификации или с минимальным взаимодействием | RCE, SQL injection с доступом к БД, auth bypass, unauthenticated privilege escalation |
| **High** | 7.0–8.9 | Уязвимость позволяет значительное воздействие на конфиденциальность, целостность или доступность | Stored XSS, IDOR с доступом к чужим данным, SSRF с доступом к внутренним сервисам |
| **Medium** | 4.0–6.9 | Уязвимость с ограниченным воздействием или требующая специфических условий для эксплуатации | Reflected XSS, CSRF, information disclosure (stack traces), missing security headers |
| **Low** | 0.1–3.9 | Уязвимость с минимальным воздействием | Verbose error messages, minor information disclosure, cookie без HttpOnly |
| **Informational** | 0.0 | Наблюдение, не являющееся уязвимостью, но рекомендуемое к улучшению | Best practice recommendations, defense in depth suggestions |

### 8.2. SLA на устранение

| Severity | SLA на исправление | Блокирует релиз | Ответственный за контроль |
|----------|-------------------|----------------|--------------------------|
| **Critical** | [ЗАПОЛНИТЬ: ≤ 24 часа] | Да (безусловно) | Security + техлид |
| **High** | [ЗАПОЛНИТЬ: ≤ 3 рабочих дня] | Да | Security + техлид |
| **Medium** | [ЗАПОЛНИТЬ: ≤ 14 рабочих дней] | По решению Security + техлида (risk acceptance) | Security |
| **Low** | [ЗАПОЛНИТЬ: ≤ 30 рабочих дней / следующий релиз] | Нет | Security |
| **Informational** | Без SLA; включается в backlog улучшений | Нет | техлид |

### 8.3. Связь с управлением недостатками (документ 04)

Все findings нефункционального тестирования регистрируются в системе управления недостатками (документ 04, процесс 5.5):

| Поле дефекта | Описание | Пример |
|-------------|----------|--------|
| **ID** | Уникальный идентификатор | VULN-2024-015 |
| **Источник** | Тип нефункционального тестирования | PEN (пентест) / FUZZ (фаззинг) / LOAD (нагрузочное) |
| **ID в реестре** | ID записи в реестре настоящего документа (раздел 11) | PEN-003 |
| **Severity** | CVSS score и severity level | Critical (9.8) |
| **CVSS Vector** | Полный CVSS vector string | AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |
| **CWE** | Классификация уязвимости | CWE-89 (SQL Injection) |
| **Описание** | Детальное описание уязвимости | — |
| **PoC** | Proof of concept: запрос, payload, шаги воспроизведения | — |
| **Рекомендации** | Рекомендации по устранению | — |
| **Связанное требование** | ID требования безопасности (документ 05), если применимо | REQ-INPUT-001 |

### 8.4. Risk acceptance

| Параметр | Описание |
|----------|----------|
| **Когда применяется** | Только для Medium и Low severity; никогда для Critical и High |
| **Процедура** | Security Engineer обосновывает risk acceptance; техлид и руководитель утверждают |
| **Документирование** | Запись в реестре: причина acceptance, компенсирующие контроли, дата пересмотра |
| **Срок действия** | [ЗАПОЛНИТЬ: 6 месяцев / до следующего пентеста]; по истечении — переоценка |

---

## 9. Интеграция в CI/CD

### 9.1. Автоматические нефункциональные проверки в CI/CD

| Проверка | Этап CI/CD | Инструмент | Trigger | Quality Gate |
|----------|-----------|-----------|---------|-------------|
| **Автоматический фаззинг (short)** | PR check | [ЗАПОЛНИТЬ: OSS-Fuzz / ClusterFuzzLite / Atheris + Hypothesis] | Push в PR branch | 0 crashes; coverage не снижается |
| **API fuzzing** | PR check / merge | [ЗАПОЛНИТЬ: Schemathesis / RESTler] | PR merge to development | 0 Critical/High findings |
| **Scheduled deep fuzzing** | Nightly / weekly | [ЗАПОЛНИТЬ: OSS-Fuzz / custom CI job] | Cron schedule | Все crashes протриажены |
| **Scheduled pentest scans** | Weekly / monthly | [ЗАПОЛНИТЬ: Nuclei + custom templates] | Cron schedule | Новые findings протриажены |
| **Load test (smoke)** | Pre-deploy | [ЗАПОЛНИТЬ: k6 / Locust] | Перед deploy в staging/production | Latency и error rate в пределах SLA |

### 9.2. Quality gates для нефункционального тестирования

| Gate | Условие блокировки | Действие при блокировке |
|------|-------------------|----------------------|
| **Fuzz crash gate** | Фаззер обнаружил crash / unhandled exception | PR не может быть смержен; crash требует исправления |
| **Pentest scan gate** | Автоматический scan обнаружил Critical/High finding | Уведомление Security; блокировка deploy; экстренный триаж |
| **Load test gate** | Latency p95 > [ЗАПОЛНИТЬ: SLA]; error rate > [ЗАПОЛНИТЬ: 1%] | Блокировка deploy; анализ bottleneck |
| **Rate limiting gate** | Rate limiter не активируется при превышении порога | Блокировка deploy; исправление rate limiting |

### 9.3. Конфигурация

| Параметр | Значение |
|----------|----------|
| Fuzz timeout в CI/CD | [ЗАПОЛНИТЬ: 10 мин / 30 мин на target] |
| Load test duration в CI/CD | [ЗАПОЛНИТЬ: 5 мин smoke / 30 мин full] |
| Pentest scan schedule | [ЗАПОЛНИТЬ: weekly / при merge в main] |
| Артефакты | Crash inputs (для фаззинга), scan reports (SARIF/JSON), load test results (HTML/JSON) |
| Уведомления | [ЗАПОЛНИТЬ: Slack / email / GitHub Security tab] |

---

## 10. Метрики и отчётность

### 10.1. Метрики нефункционального тестирования

| Метрика | Описание | Формула / Источник | Целевое значение | Периодичность |
|---------|----------|-------------------|-----------------|---------------|
| **Pentest findings by severity** | Количество findings пентеста по уровням severity | Отчёт о пентесте | [ЗАПОЛНИТЬ: 0 Critical, 0 High (после remediation)] | Каждый пентест |
| **Pentest findings trend** | Динамика количества findings по сравнению с предыдущим пентестом | Сравнение отчётов | Снижение или стабильно 0 | Ежеквартально |
| **Fuzz coverage (edge)** | Процент edges, покрытых фаззером для каждого target | Coverage tool фаззера | [ЗАПОЛНИТЬ: ≥ 70%] | Каждый запуск |
| **Fuzz crash count** | Количество уникальных crashes, обнаруженных фаззером | Фаззер (deduplicated) | Все crashes протриажены и исправлены | Каждый запуск |
| **Fuzz iterations** | Количество тестовых случаев, выполненных фаззером | Фаззер | [ЗАПОЛНИТЬ: ≥ 1M в CI/CD] | Каждый запуск |
| **Retest pass rate** | Процент findings, подтверждённых как исправленные при ретесте | Fixed & verified / Total fixed × 100% | [ЗАПОЛНИТЬ: ≥ 95%] | Каждый ретест |
| **Mean time to remediate (MTTR)** | Среднее время от обнаружения finding до подтверждённого исправления | (Дата ретеста − Дата обнаружения) среднее | [ЗАПОЛНИТЬ: ≤ 7 дней для High, ≤ 1 день для Critical] | Ежемесячно |
| **Load test: p95 latency** | 95-й перцентиль времени ответа под нагрузкой | k6 / Locust | [ЗАПОЛНИТЬ: ≤ 500ms при нормальной нагрузке] | Каждый запуск |
| **Load test: error rate** | Процент ошибочных ответов (4xx/5xx) под нагрузкой | k6 / Locust | [ЗАПОЛНИТЬ: ≤ 1% при нормальной нагрузке] | Каждый запуск |
| **Security mechanisms under load** | Процент проверок безопасности, прошедших при пиковой нагрузке | Ручная проверка (раздел 6.3) | 100% механизмов работают корректно | Каждое нагрузочное тестирование |

### 10.2. Формат отчёта о нефункциональном тестировании

| Раздел отчёта | Содержание |
|---------------|-----------|
| **Executive summary** | Краткое резюме: scope, ключевые findings, общая оценка безопасности, рекомендация |
| **Scope и методология** | Перечень объектов, типы тестирования, инструменты, подход (black/gray/white-box) |
| **Findings (пентест)** | Каждый finding: severity, CVSS, CWE, описание, PoC, скриншоты, рекомендации |
| **Findings (фаззинг)** | Каждый crash: severity, тип ошибки, input, stack trace, рекомендации |
| **Результаты нагрузочного тестирования** | Сценарии, метрики (latency, throughput, error rate), графики, поведение под нагрузкой |
| **Безопасность под нагрузкой** | Результаты проверки механизмов безопасности (раздел 6.3) |
| **Метрики** | Значения метрик из раздела 10.1, тренды |
| **Риски и ограничения** | Области, не покрытые тестированием; ограничения инструментов; risk acceptance |
| **Заключение** | Рекомендация: готовность / неготовность к релизу; перечень обязательных исправлений |

### 10.3. Периодичность отчётов

| Тип отчёта | Периодичность | Аудитория |
|-----------|---------------|-----------|
| **CI/CD fuzz report** | Автоматически при каждом запуске | Разработчики, Security |
| **Pentest report** | После каждого пентеста | Security, техлид, руководство |
| **Load test report** | После каждого нагрузочного тестирования | DevOps, техлид, Security |
| **Сводный отчёт** | [ЗАПОЛНИТЬ: ежеквартально] | Руководство, Security, ФСТЭК (при необходимости) |

---

## 11. Реестр результатов тестирования

### 11.1. Формат реестра

> Требование ГОСТ Р 56939-2024, п. 5.19.2 — фиксировать результаты нефункционального тестирования.

#### Реестр findings пентеста

| ID | Уязвимость | OWASP Top 10 | CWE | CVSS Score | Severity | Описание | PoC | Статус | ID дефекта (doc 04) | Дата обнаружения | Дата исправления | Тестировщик |
|----|-----------|-------------|-----|-----------|----------|---------|-----|--------|-------------------|-----------------|-----------------|------------|
| PEN-001 | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: A01–A10] | [ЗАПОЛНИТЬ: CWE-XXX] | [ЗАПОЛНИТЬ: 0.0–10.0] | [ЗАПОЛНИТЬ: Critical / High / Medium / Low / Info] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: ссылка на PoC] | [ЗАПОЛНИТЬ: Open / Fixed / Verified / Risk Accepted] | [ЗАПОЛНИТЬ: VULN-2024-XXX] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |
| PEN-002 | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |
| PEN-003 | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

#### Реестр findings фаззинга

| ID | Target | Тип ошибки | Severity | Описание | Crash input | Stack trace | Статус | ID дефекта (doc 04) | Дата обнаружения | Дата исправления | Тестировщик |
|----|--------|-----------|----------|---------|-------------|------------|--------|-------------------|-----------------|-----------------|------------|
| FUZZ-001 | [ЗАПОЛНИТЬ: target] | [ЗАПОЛНИТЬ: crash / hang / memory leak / assertion failure] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: ссылка на input] | [ЗАПОЛНИТЬ: ссылка на stack trace] | [ЗАПОЛНИТЬ: Open / Fixed / Verified] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |
| FUZZ-002 | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |
| FUZZ-003 | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

#### Реестр findings нагрузочного тестирования

| ID | Сценарий | Проблема | Severity | Описание | Метрики | Статус | ID дефекта (doc 04) | Дата обнаружения | Дата исправления | Тестировщик |
|----|---------|---------|----------|---------|---------|--------|-------------------|-----------------|-----------------|------------|
| LOAD-001 | [ЗАПОЛНИТЬ: сценарий из раздела 6.2] | [ЗАПОЛНИТЬ: degradation / timeout / crash / security bypass] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ: p95 latency, error rate, throughput] | [ЗАПОЛНИТЬ: Open / Fixed / Verified] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |
| LOAD-002 | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |
| LOAD-003 | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

### 11.2. Статусы findings

| Статус | Описание | Действие |
|--------|----------|----------|
| **Open** | Уязвимость обнаружена, ожидает исправления | Назначить ответственного, определить SLA |
| **Fixed** | Исправление выполнено разработчиком, ожидает ретеста | Security выполняет ретест |
| **Verified** | Исправление подтверждено ретестом | Закрыть finding |
| **Risk Accepted** | Решение не исправлять; риск принят (только для Medium/Low) | Задокументировать обоснование, компенсирующие контроли, дату пересмотра |
| **Reopened** | Ретест показал, что уязвимость не устранена | Вернуть разработчику с комментарием |
| **False Positive** | При верификации подтверждено отсутствие уязвимости | Задокументировать обоснование |

### 11.3. Хранение и доступ к реестру

| Параметр | Значение |
|----------|----------|
| Место хранения реестра | [ЗАПОЛНИТЬ: Confluence (restricted) / JIRA Security project / внутренняя wiki] |
| Доступ к реестру | [ЗАПОЛНИТЬ: Security — read/write; техлид — read/write; разработчики — read (только свои findings); руководство — read (summary)] |
| Срок хранения записей | [ЗАПОЛНИТЬ: не менее 3 лет / срок действия сертификата + 1 год] |
| Конфиденциальность | Отчёты пентеста содержат PoC эксплуатации — доступ ограничен; не публиковать до полного устранения findings |

---

## 12. История изменений

| Версия | Дата | Описание изменений | Автор |
|--------|------|--------------------|-------|
| 1.0 | [ЗАПОЛНИТЬ: дата] | Первая версия документа | [ЗАПОЛНИТЬ: ФИО] |