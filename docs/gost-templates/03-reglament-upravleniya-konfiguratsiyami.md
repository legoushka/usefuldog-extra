# Регламент управления конфигурациями

| | |
|---|---|
| **Продукт** | [ЗАПОЛНИТЬ: наименование СЗИ] |
| **Версия документа** | 1.0 |
| **Дата** | [ЗАПОЛНИТЬ: дата утверждения] |
| **Статус** | Проект |
| **Утверждено** | [ЗАПОЛНИТЬ: должность, ФИО руководителя] |
| **Процесс ГОСТ Р 56939-2024** | 5.4 — Управление конфигурацией ПО |

---

## Содержание

1. [Общие сведения](#1-общие-сведения)
2. [Область применения](#2-область-применения)
3. [Элементы конфигурации](#3-элементы-конфигурации)
4. [Система управления версиями](#4-система-управления-версиями)
5. [Правила именования и маркировки версий](#5-правила-именования-и-маркировки-версий)
6. [Процедура контроля изменений](#6-процедура-контроля-изменений)
7. [Управление средой сборки](#7-управление-средой-сборки)
8. [Обеспечение целостности](#8-обеспечение-целостности)
9. [Аудит конфигураций](#9-аудит-конфигураций)
10. [Журнал изменений конфигурации](#10-журнал-изменений-конфигурации)
11. [История изменений](#11-история-изменений)

---

## 1. Общие сведения

### 1.1. Назначение документа

Настоящий Регламент определяет порядок управления конфигурацией программного обеспечения [ЗАПОЛНИТЬ: наименование СЗИ], включая:

- Идентификацию и классификацию элементов конфигурации.
- Контроль изменений элементов конфигурации.
- Учёт состояния конфигурации и ведение журнала.
- Обеспечение целостности элементов конфигурации.

Регламент разработан в соответствии с требованиями ГОСТ Р 56939-2024, п. 5.4.

### 1.2. Нормативные ссылки

| Документ | Описание |
|----------|----------|
| ГОСТ Р 56939-2024, п. 5.4 | Управление конфигурацией ПО |
| ГОСТ Р 56939-2024, п. 5.5 | Управление недостатками и запросами на изменение ПО |
| ГОСТ Р 56939-2024, п. 5.12 | Использование безопасной системы сборки ПО |
| ГОСТ Р 56939-2024, п. 5.14 | Управление доступом и контроль целостности кода |

---

## 2. Область применения

Настоящий Регламент распространяется на все элементы конфигурации продукта [ЗАПОЛНИТЬ: наименование СЗИ], включая, но не ограничиваясь:

- Исходный код.
- Документация (техническая, пользовательская, процессная).
- Зависимости и сторонние компоненты.
- Конфигурационные файлы.
- Артефакты сборки.
- Среда разработки и тестирования.
- Инструменты разработки и анализа.

---

## 3. Элементы конфигурации

### 3.1. Реестр элементов конфигурации

> Требование ГОСТ Р 56939-2024, п. 5.4.2 — определить элементы конфигурации и их атрибуты.

| № | Элемент | Тип | Место хранения | Ответственный |
|---|---------|-----|----------------|---------------|
| 1 | Исходный код продукта | Код | [ЗАПОЛНИТЬ: Git-репозиторий, URL] | [ЗАПОЛНИТЬ] |
| 2 | Конфигурации сборки (Dockerfile, CI/CD) | Конфигурация | [ЗАПОЛНИТЬ: тот же или отдельный репозиторий] | [ЗАПОЛНИТЬ] |
| 3 | Зависимости (lock-файлы) | Конфигурация | [ЗАПОЛНИТЬ: репозиторий] | [ЗАПОЛНИТЬ] |
| 4 | Техническая документация | Документ | [ЗАПОЛНИТЬ: Confluence / Git / файловое хранилище] | [ЗАПОЛНИТЬ] |
| 5 | Документация РБПО (регламенты, методики) | Документ | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |
| 6 | Конфигурации инструментов SAST/DAST/SCA | Конфигурация | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |
| 7 | Артефакты сборки (бинарные файлы, образы) | Артефакт | [ЗАПОЛНИТЬ: Docker Registry / Nexus / хранилище] | [ЗАПОЛНИТЬ] |
| 8 | Тестовые данные и фикстуры | Тест | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |
| 9 | Секреты и ключи | Секрет | [ЗАПОЛНИТЬ: Vault / GitHub Secrets] | [ЗАПОЛНИТЬ] |

### 3.2. Атрибуты элементов конфигурации

Каждый элемент конфигурации имеет следующие атрибуты:

| Атрибут | Описание |
|---------|----------|
| **Идентификатор** | Уникальный идентификатор элемента (путь в репозитории, артефакт ID) |
| **Версия** | Текущая версия элемента (тег Git, номер версии артефакта) |
| **Статус** | Актуальный / Архивный / Устаревший |
| **Ответственный** | Лицо, ответственное за элемент |
| **Уровень критичности** | Высокий / Средний / Низкий |
| **Дата последнего изменения** | Дата последней модификации |

### 3.3. Классификация по критичности

| Уровень | Описание | Примеры | Требования к контролю |
|---------|----------|---------|----------------------|
| **Высокий** | Элементы, напрямую влияющие на безопасность продукта | Исходный код, криптографические модули, конфигурации безопасности, секреты | Обязательный code review, SAST, подпись коммитов, restricted merge |
| **Средний** | Элементы, косвенно влияющие на безопасность | Зависимости, конфигурации сборки, тестовые сценарии | Code review, контроль целостности |
| **Низкий** | Вспомогательные элементы | Документация, скрипты разработчика, README | Версионирование в Git |

---

## 4. Система управления версиями

### 4.1. Платформа

| Параметр | Значение |
|----------|----------|
| Система контроля версий | Git |
| Платформа | [ЗАПОЛНИТЬ: GitHub / GitLab / Gitea] |
| URL репозитория | [ЗАПОЛНИТЬ: URL] |
| Тип размещения | [ЗАПОЛНИТЬ: облачный / on-premise] |

### 4.2. Модель ветвления

| Ветка | Назначение | Правила |
|-------|------------|---------|
| `main` | Стабильная версия, готовая к выпуску | Merge только из `development`. Прямые коммиты запрещены. Protected branch |
| `development` | Основная ветка разработки | Merge через PR/MR с обязательным code review |
| `feature/*` | Разработка новой функциональности | Создаётся от `development`. Формат: `feature/<issue-number>-<description>` |
| `fix/*` | Исправление дефектов | Создаётся от `development`. Формат: `fix/<issue-number>-<description>` |
| `hotfix/*` | Срочное исправление в production | Создаётся от `main`. Мержится в `main` и `development` |
| `release/*` | Подготовка релиза | Создаётся от `development`. Формат: `release/v<version>` |

### 4.3. Правила работы с ветками

1. **Ветка = тикет.** Каждая ветка привязана к задаче в трекере.
2. **Имя ветки содержит номер issue:** `feature/42-vex-export`.
3. **Merge через Pull Request** с обязательным code review.
4. **Squash или merge commit** — [ЗАПОЛНИТЬ: политика мержа].
5. **Удаление ветки после мержа** — feature/fix ветки удаляются после слияния.
6. **Запрет force-push** в `main` и `development`.

### 4.4. Правила коммитов

Формат сообщения коммита:

```
<type>: <description>

[optional body]

[optional footer]
```

| Тип | Описание |
|-----|----------|
| `feat` | Новая функциональность |
| `fix` | Исправление ошибки |
| `security` | Исправление, связанное с безопасностью |
| `refactor` | Рефакторинг кода |
| `test` | Добавление или изменение тестов |
| `docs` | Изменение документации |
| `chore` | Обслуживание (зависимости, конфиги, CI) |

**Правила:**
- Тема коммита — не более 72 символов.
- На английском языке.
- Ссылка на тикет в теле или footer (например, `Closes #42`).
- [ЗАПОЛНИТЬ: подпись коммитов GPG — обязательна / рекомендуется].

---

## 5. Правила именования и маркировки версий

### 5.1. Семантическое версионирование

Продукт использует [Semantic Versioning 2.0.0](https://semver.org/):

```
MAJOR.MINOR.PATCH[-pre-release][+build]
```

| Компонент | Когда инкрементируется |
|-----------|----------------------|
| **MAJOR** | Обратно несовместимые изменения API |
| **MINOR** | Новая функциональность с сохранением обратной совместимости |
| **PATCH** | Исправления ошибок и уязвимостей с сохранением обратной совместимости |

Примеры: `1.0.0`, `1.2.3`, `2.0.0-rc.1`, `1.0.0+build.20240115`.

### 5.2. Теги и релизы

| Элемент | Формат | Пример |
|---------|--------|--------|
| Git-тег | `v<MAJOR>.<MINOR>.<PATCH>` | `v1.2.3` |
| Release candidate | `v<MAJOR>.<MINOR>.<PATCH>-rc.<N>` | `v1.2.3-rc.1` |
| Docker-образ | `<registry>/<name>:v<MAJOR>.<MINOR>.<PATCH>` | `registry.example.com/product:v1.2.3` |
| Артефакт сборки | `<name>-v<version>-<os>-<arch>` | `product-v1.2.3-linux-amd64` |

### 5.3. Маркировка сборок

Каждая сборка идентифицируется:

- **Git-тег** или **хеш коммита** (для промежуточных сборок).
- **Номер сборки CI** (при наличии).
- **Дата и время сборки**.
- **Хеш артефакта** (SHA-256).

---

## 6. Процедура контроля изменений

### 6.1. Общий порядок

> Требование ГОСТ Р 56939-2024, п. 5.4.2 — проводить контроль изменений с ведением журнала.

```
1. Создание задачи в трекере
   │
2. Создание ветки от development
   │
3. Разработка изменений
   │
4. Локальная проверка (линтинг, тесты)
   │
5. Push и создание Pull Request
   │
6. Автоматические проверки CI (lint, test, SAST)
   │
7. Code review (≥ 1 reviewer)
   │
8. Merge в development
   │
9. Обновление задачи в трекере
```

### 6.2. Требования к Pull Request

| Требование | Описание |
|-----------|----------|
| **Название** | Содержит номер тикета и краткое описание |
| **Описание** | Что изменено, зачем, ссылка на тикет |
| **Проверки CI** | Все проверки пройдены (lint, test, SAST) |
| **Code review** | Минимум [ЗАПОЛНИТЬ: 1 / 2] одобрения |
| **Конфликты** | Разрешены перед мержем |
| **Scope** | Один PR — одна задача. Крупные задачи — серия PR |

### 6.3. Изменения высокой критичности

Для элементов с высоким уровнем критичности (раздел 3.3) дополнительно требуется:

- Обязательный review инженером по безопасности.
- Проверка результатов SAST на отсутствие новых уязвимостей.
- [ЗАПОЛНИТЬ: дополнительные требования при необходимости].

---

## 7. Управление средой сборки

### 7.1. Фиксация конфигурации среды

В репозитории зафиксированы:

| Элемент | Файл | Описание |
|---------|------|----------|
| Зависимости runtime | [ЗАПОЛНИТЬ: requirements.txt / package-lock.json] | Фиксированные версии |
| Зависимости dev | [ЗАПОЛНИТЬ: requirements-dev.txt / package.json devDeps] | Инструменты разработки |
| Конфигурация сборки | [ЗАПОЛНИТЬ: Dockerfile / docker-compose.yml] | Контейнеризация |
| CI/CD pipeline | [ЗАПОЛНИТЬ: .github/workflows / .gitlab-ci.yml] | Автоматизация |
| Конфигурации линтеров | [ЗАПОЛНИТЬ: .eslintrc / ruff.toml / .pre-commit-config.yaml] | Контроль качества |
| Конфигурации SAST | [ЗАПОЛНИТЬ: sonar-project.properties / .semgrep.yml] | Анализ безопасности |

### 7.2. Управление зависимостями

1. **Lock-файлы** (`package-lock.json`, `poetry.lock`, `uv.lock` и т.д.) зафиксированы в Git.
2. **Обновление зависимостей** — отдельная задача в трекере с проверкой SBOM и SCA.
3. **Запрет wildcard-версий** — все зависимости фиксированы до конкретной версии.
4. **Проверка при добавлении** — новая зависимость проходит SCA-анализ до включения.

---

## 8. Обеспечение целостности

> Требование ГОСТ Р 56939-2024, п. 5.4.2 — обеспечить целостность элементов конфигурации.

### 8.1. Целостность исходного кода

| Мера | Описание |
|------|----------|
| Protected branches | Ветки `main` и `development` защищены от force-push и прямых коммитов |
| Обязательный code review | Merge только через одобренный PR/MR |
| [ЗАПОЛНИТЬ: подпись коммитов] | GPG-подпись коммитов [ЗАПОЛНИТЬ: обязательна / рекомендуется] |
| Аудит-журнал | Git log как журнал всех изменений с авторством и датой |

### 8.2. Целостность артефактов сборки

| Мера | Описание |
|------|----------|
| Хеширование | SHA-256 хеш для каждого артефакта сборки |
| [ЗАПОЛНИТЬ: подпись артефактов] | [ЗАПОЛНИТЬ: Sigstore/Cosign / GPG-подпись] |
| Хранение | Артефакты хранятся в [ЗАПОЛНИТЬ: Docker Registry / Nexus / S3] |
| Immutable tags | Запрет перезаписи тегов в реестре артефактов |

### 8.3. Целостность зависимостей

| Мера | Описание |
|------|----------|
| Lock-файлы | Хеши зависимостей зафиксированы |
| SCA-проверка | Автоматическая проверка на известные уязвимости в CI |
| SBOM | Актуальный перечень компонентов |

---

## 9. Аудит конфигураций

### 9.1. Периодический аудит

| Тип аудита | Периодичность | Ответственный | Что проверяется |
|-----------|---------------|---------------|-----------------|
| Аудит репозитория | [ЗАПОЛНИТЬ: ежеквартально] | [ЗАПОЛНИТЬ] | Состояние веток, наличие защитных правил, просроченные PR |
| Аудит зависимостей | [ЗАПОЛНИТЬ: ежемесячно] | [ЗАПОЛНИТЬ] | Актуальность lock-файлов, результаты SCA |
| Аудит доступа | [ЗАПОЛНИТЬ: ежеквартально] | [ЗАПОЛНИТЬ] | Права доступа к репозиторию, ротация ключей |
| Аудит артефактов | [ЗАПОЛНИТЬ: при каждом релизе] | [ЗАПОЛНИТЬ] | Целостность артефактов, наличие хешей |

### 9.2. Критерии аудита

| № | Критерий | Ожидаемый результат |
|---|---------|---------------------|
| 1 | Protected branches настроены | `main` и `development` защищены |
| 2 | Все мержи через PR с review | Нет прямых коммитов в защищённые ветки |
| 3 | CI/CD проверки обязательны | Merge заблокирован при ошибках CI |
| 4 | Lock-файлы актуальны | Зависимости соответствуют lock-файлам |
| 5 | Артефакты имеют хеши | Каждый релизный артефакт подписан / захеширован |
| 6 | Нет секретов в коде | SAST/grep не обнаруживает хардкод секретов |

---

## 10. Журнал изменений конфигурации

### 10.1. Формат журнала

Журнал изменений ведётся в формате [Keep a Changelog](https://keepachangelog.com/) в файле `CHANGELOG.md` в корне репозитория.

Категории изменений: **Added**, **Changed**, **Fixed**, **Removed**, **Security**.

### 10.2. Записи журнала

| Дата | Версия | Элемент конфигурации | Описание изменения | Автор | Тикет |
|------|--------|---------------------|-------------------|-------|-------|
| [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] | [ЗАПОЛНИТЬ] |

---

## 11. История изменений

| Версия | Дата | Описание изменений | Автор |
|--------|------|--------------------|-------|
| 1.0 | [ЗАПОЛНИТЬ: дата] | Первая версия документа | [ЗАПОЛНИТЬ: ФИО] |
